import{i as $l,A as Vl,D as zr,E as Ul,F as Hl,J as zl,a as Wl,q as Zn,r as X,C as ei,j as P,K as ql,B as Pe,O as Kl,P as Xl,Q as Jl,e as Yl,c as Ql,w as Wr,g as vr,S as jn,T as Zl,t as eu}from"../index-D251OfBP.js";import{c as wt}from"./lite-DaUVFjkg.js";import{C as tu,e as ru}from"./success-twYJnu5Z.js";import{A as nu,a as iu,p as Gn}from"./papers-DLCVcawS.js";import{A as ti}from"./arrow-left-CD6QIu67.js";import{C as ri}from"./CardFactory-B5Mnixjl.js";import{u as ni}from"./useTranslation-kV3eop3M.js";import{A as au,c as ii,B as su,U as ou,r as lu}from"./readContract-DgNpwLKo.js";import{s as uu,w as cu}from"./writeContract-5ojPgQ6p.js";import{w as fu}from"./waitForTransactionReceipt-DZ_XEHSW.js";import{g as On}from"./index-BbP3371Q.js";import{p as qr}from"./index-BAMY2Nnw.js";import"./getTransactionReceipt-CfgnV1NF.js";const du=/^(.*)\[([0-9]*)\]$/,mu=/^bytes([1-9]|1[0-9]|2[0-9]|3[0-2])?$/,hu=/^(u?int)(8|16|24|32|40|48|56|64|72|80|88|96|104|112|120|128|136|144|152|160|168|176|184|192|200|208|216|224|232|240|248|256)?$/;function pu(a,s){if(a.length!==s.length)throw new au({expectedLength:a.length,givenLength:s.length});const n=[];for(let d=0;d<a.length;d++){const m=a[d],p=s[d];n.push(ai(m,p))}return ii(n)}function ai(a,s,n=!1){if(a==="address"){const v=s;if(!$l(v))throw new Vl({address:v});return zr(v.toLowerCase(),{size:n?32:null})}if(a==="string")return Ul(s);if(a==="bytes")return s;if(a==="bool")return zr(Hl(s),{size:n?32:1});const d=a.match(hu);if(d){const[v,b,A="256"]=d,D=Number.parseInt(A)/8;return zl(s,{size:n?32:D,signed:b==="int"})}const m=a.match(mu);if(m){const[v,b]=m;if(Number.parseInt(b)!==(s.length-2)/2)throw new su({expectedSize:Number.parseInt(b),givenSize:(s.length-2)/2});return zr(s,{dir:"right",size:n?32:null})}const p=a.match(du);if(p&&Array.isArray(s)){const[v,b]=p,A=[];for(let D=0;D<s.length;D++)A.push(ai(b,s[D],!0));return A.length===0?"0x":ii(A)}throw new ou(a)}const Xr="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3ccircle%20cx='12'%20cy='12'%20r='9'%20fill='white'%20stroke='white'%20stroke-width='2'/%3e%3cpath%20d='M8%2011.7273L10.6667%2015L16%209'%20stroke='url(%23paint0_linear_409_1733)'%20stroke-width='2'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cdefs%3e%3clinearGradient%20id='paint0_linear_409_1733'%20x1='8'%20y1='12'%20x2='16'%20y2='12'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20stop-color='%23141AAD'/%3e%3cstop%20offset='1'%20stop-color='%239737A6'/%3e%3c/linearGradient%3e%3c/defs%3e%3c/svg%3e",si="data:image/svg+xml,%3csvg%20width='20'%20height='20'%20viewBox='0%200%2020%2020'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3ccircle%20cx='10'%20cy='10'%20r='9'%20stroke='white'%20stroke-width='2'/%3e%3c/svg%3e",vu=[{id:"1",content:"Unlock USDT and get 1 PR",type:"CASH"},{id:"2",content:"Get 10 PR",type:"TOKEN"}],gu=({nftId:a,signature:s})=>{const n=Wl(),d=Zn(),{t:m}=ni(),{updateNftData:p,removeLocalNft:v}=X.useContext(ei),[b,A]=X.useState(String),[D,O]=X.useState(!1),K=re=>{A(re),Number(re)===1?We():fe(!1)},[$,Me]=X.useState(null),[V,fe]=X.useState(!1),[pe,De]=X.useState(!1),We=async()=>{fe(!0);const de=(JSON.parse(String(localStorage.getItem("recordTime")))||[]).filter(ve=>ve.nftId===a);Me(de[0].recordTime)},me=()=>{$!=null&&De(!0)},ct=async()=>{try{const re=Kl(pu(["bytes"],[`0x${s}`])),{request:de}=await uu(n,{...ri,functionName:"overPaper",args:[BigInt(a),Number(b),re]});O(!0);const ve=await cu(n,de);await fu(n,{hash:ve}),p(),v(a),d("/nft")}catch(re){O(!1),console.log(re)}};return P.jsxs("div",{children:[P.jsxs("div",{className:"text-center",children:[P.jsx("img",{src:tu,alt:"CongratulationsImg",className:"m-auto w-20"}),P.jsx("div",{className:"mt-6 mb-2 font-semibold text-[24px]",children:m("Congratulations!")}),P.jsx("div",{children:m("You've passed the test")})]}),P.jsx("div",{className:"mt-8 mb-3 text-[#8E8E8E]",children:m("Choose one")}),vu.map(re=>P.jsxs("div",{onClick:()=>K(re.id),className:wt("flex justify-between items-center mb-4 p-[32px] border rounded-2xl w-full h-[72px] transition-all duration-200 cursor-pointer",b===re.id?"border-white bg-gradient-to-r from-[#141AAD]/40 to-[#9737A6]/40":"border-white/20"),children:[P.jsx("div",{children:m(re.content)}),P.jsx("img",{src:`${b===re.id?Xr:si}`,alt:""})]},re.id)),V&&P.jsxs("div",{className:"flex justify-center items-center",children:[m("Lockcountdown"),"ï¼š"," ",$!=null&&P.jsx(ql,{endTime:$,onComplete:me})]}),P.jsx(Pe,{isLoading:D,disabled:b===""||V===!0&&!pe,type:b===""?"tertiary":"secondary",text:"Continue",className:"mt-8 w-full",onClick:ct}),P.jsxs("div",{className:"flex justify-center mt-[10px] cursor-pointer",onClick:()=>d("/nft"),children:[P.jsx("img",{src:ti,alt:""}),P.jsx("div",{className:"ml-[10px]",children:m("Back")})]})]})},_u=gu,yu=()=>{if(typeof globalThis<"u")return globalThis;if(typeof window<"u")return window;if(typeof On<"u")return On;if(typeof self<"u")return self;throw new Error("unable to locate global object")},Kr=yu();typeof Kr.globalThis>"u"&&Object.defineProperty(Kr,"globalThis",{get(){return Kr}});let I;const wu=a=>{I=a};function ke(a){const s=["length","name","prototype","wasmAsyncMethods"];let n=Object.getOwnPropertyNames(a).filter(p=>s.indexOf(p)===-1);a.wasmAsyncMethods&&a.wasmAsyncMethods.length>0&&(n=n.filter(p=>a.wasmAsyncMethods.indexOf(p)===-1));let d=Object.getOwnPropertyNames(a.prototype).filter(p=>p!=="constructor"&&typeof a.prototype[p]=="function");a.prototype.wasmAsyncMethods&&a.prototype.wasmAsyncMethods.length>0&&(d=d.filter(p=>a.prototype.wasmAsyncMethods.indexOf(p)===-1));const m=(p,v)=>{const b=p[v];p[v]=function(...A){if(I.Asyncify.currData!==null){const D=I.Asyncify.currData;I.Asyncify.currData=null;const O=b.call(this,...A);return I.Asyncify.currData=D,O}else return b.call(this,...A)}};n.forEach(p=>m(a,p)),d.forEach(p=>m(a.prototype,p))}function Ht(a,s,n){a.wasmAsyncMethods||(a.wasmAsyncMethods=[]),a.wasmAsyncMethods.push(s)}function Ie(a){let s=Object.getOwnPropertyNames(a.prototype).filter(d=>d!=="constructor"&&typeof a.prototype[d]=="function");const n=(d,m)=>{const p=d[m];d[m]=function(...v){if(this.isDestroyed){console.error(`Don't call ${m} of the ${a.name} that is destroyed.`);return}return p.call(this,...v)}};s.forEach(d=>n(a.prototype,d))}var Ue=(a=>(a[a.Unknown=0]="Unknown",a[a.Null=1]="Null",a[a.Solid=2]="Solid",a[a.Text=3]="Text",a[a.Shape=4]="Shape",a[a.Image=5]="Image",a[a.PreCompose=6]="PreCompose",a))(Ue||{}),we=(a=>(a[a.a=0]="a",a[a.c=1]="c",a[a.tx=2]="tx",a[a.b=3]="b",a[a.d=4]="d",a[a.ty=5]="ty",a))(we||{}),wr=(a=>(a[a.Unknown=0]="Unknown",a[a.ALPHA_8=1]="ALPHA_8",a[a.RGBA_8888=2]="RGBA_8888",a[a.BGRA_8888=3]="BGRA_8888",a))(wr||{}),bu=Object.defineProperty,xu=Object.getOwnPropertyDescriptor,Eu=(a,s,n,d)=>{for(var m=d>1?void 0:d?xu(s,n):s,p=a.length-1,v;p>=0;p--)(v=a[p])&&(m=(d?v(s,n,m):v(m))||m);return d&&m&&bu(s,n,m),m};let Se=class{constructor(a){this.isDestroyed=!1,this.wasmIns=a}static makeAll(a,s,n,d,m,p,v=0,b=0,A=1){const D=I._Matrix._MakeAll(a,s,n,d,m,p,v,b,A);if(!D)throw new Error("Matrix.makeAll fail, please check parameters valid!");return new Se(D)}static makeScale(a,s){let n;if(s!==void 0?n=I._Matrix._MakeScale(a,s):n=I._Matrix._MakeScale(a),!n)throw new Error("Matrix.makeScale fail, please check parameters valid!");return new Se(n)}static makeTrans(a,s){const n=I._Matrix._MakeTrans(a,s);if(!n)throw new Error("Matrix.makeTrans fail, please check parameters valid!");return new Se(n)}get a(){return this.wasmIns?this.wasmIns._get(we.a):0}set a(a){var s;(s=this.wasmIns)==null||s._set(we.a,a)}get b(){return this.wasmIns?this.wasmIns._get(we.b):0}set b(a){var s;(s=this.wasmIns)==null||s._set(we.b,a)}get c(){return this.wasmIns?this.wasmIns._get(we.c):0}set c(a){var s;(s=this.wasmIns)==null||s._set(we.c,a)}get d(){return this.wasmIns?this.wasmIns._get(we.d):0}set d(a){var s;(s=this.wasmIns)==null||s._set(we.d,a)}get tx(){return this.wasmIns?this.wasmIns._get(we.tx):0}set tx(a){var s;(s=this.wasmIns)==null||s._set(we.tx,a)}get ty(){return this.wasmIns?this.wasmIns._get(we.ty):0}set ty(a){var s;(s=this.wasmIns)==null||s._set(we.ty,a)}get(a){return this.wasmIns?this.wasmIns._get(a):0}set(a,s){var n;(n=this.wasmIns)==null||n._set(a,s)}setAll(a,s,n,d,m,p){var v;(v=this.wasmIns)==null||v._setAll(a,s,n,d,m,p,0,0,1)}setAffine(a,s,n,d,m,p){var v;(v=this.wasmIns)==null||v._setAffine(a,s,n,d,m,p)}reset(){var a;(a=this.wasmIns)==null||a._reset()}setTranslate(a,s){var n;(n=this.wasmIns)==null||n._setTranslate(a,s)}setScale(a,s,n=0,d=0){var m;(m=this.wasmIns)==null||m._setScale(a,s,n,d)}setRotate(a,s=0,n=0){var d;(d=this.wasmIns)==null||d._setRotate(a,s,n)}setSinCos(a,s,n=0,d=0){var m;(m=this.wasmIns)==null||m._setSinCos(a,s,n,d)}setSkew(a,s,n=0,d=0){var m;(m=this.wasmIns)==null||m._setSkew(a,s,n,d)}setConcat(a,s){var n;(n=this.wasmIns)==null||n._setConcat(a.wasmIns,s.wasmIns)}preTranslate(a,s){var n;(n=this.wasmIns)==null||n._preTranslate(a,s)}preScale(a,s,n=0,d=0){var m;(m=this.wasmIns)==null||m._preScale(a,s,n,d)}preRotate(a,s=0,n=0){var d;(d=this.wasmIns)==null||d._preRotate(a,s,n)}preSkew(a,s,n=0,d=0){var m;(m=this.wasmIns)==null||m._preSkew(a,s,n,d)}preConcat(a){var s;(s=this.wasmIns)==null||s._preConcat(a.wasmIns)}postTranslate(a,s){var n;(n=this.wasmIns)==null||n._postTranslate(a,s)}postScale(a,s,n=0,d=0){var m;(m=this.wasmIns)==null||m._postScale(a,s,n,d)}postRotate(a,s=0,n=0){var d;(d=this.wasmIns)==null||d._postRotate(a,s,n)}postSkew(a,s,n=0,d=0){var m;(m=this.wasmIns)==null||m._postSkew(a,s,n,d)}postConcat(a){var s;(s=this.wasmIns)==null||s._postConcat(a.wasmIns)}destroy(){this.wasmIns.delete()}};Se=Eu([Ie,ke],Se);const yr=(a,s,...n)=>{if(I.Asyncify.currData!==null){const d=I.Asyncify.currData;I.Asyncify.currData=null;const m=a.call(s,...n);return I.Asyncify.currData=d,m}else return a.call(s,...n)},xt=(a,s)=>new Proxy(a,{get(d,m,p){switch(m){case"get":return v=>{const b=yr(d.get,d,v);return b&&s(b)};case"push_back":return v=>{yr(d.push_back,d,v.wasmIns||v)};case"size":return()=>yr(d.size,d);default:return Reflect.get(d,m,p)}}}),He=a=>{switch(yr(a._layerType,a)){case Ue.Solid:return new I.PAGSolidLayer(a);case Ue.Text:return new I.PAGTextLayer(a);case Ue.Image:return new I.PAGImageLayer(a);default:return new I.PAGLayer(a)}},Cu=a=>{switch(a){case Ue.Solid:return"Solid";case Ue.Text:return"Text";case Ue.Shape:return"Shape";case Ue.Image:return"Image";case Ue.PreCompose:return"PreCompose";default:return"Unknown"}},Mn=a=>a!=null&&a.wasmIns?a.wasmIns:a,Oe=(a,s)=>typeof s<"u"&&a instanceof s;var Pu=Object.defineProperty,Su=Object.getOwnPropertyDescriptor,Iu=(a,s,n,d)=>{for(var m=d>1?void 0:d?Su(s,n):s,p=a.length-1,v;p>=0;p--)(v=a[p])&&(m=(d?v(s,n,m):v(m))||m);return d&&m&&Pu(s,n,m),m};let lt=class{constructor(a){this.isDestroyed=!1,this.wasmIns=a}uniqueID(){return this.wasmIns._uniqueID()}layerType(){return this.wasmIns._layerType()}layerName(){return this.wasmIns._layerName()}matrix(){const a=this.wasmIns._matrix();if(!a)throw new Error("Get matrix fail!");return new Se(a)}setMatrix(a){this.wasmIns._setMatrix(a.wasmIns)}resetMatrix(){this.wasmIns._resetMatrix()}getTotalMatrix(){if(!this.wasmIns._getTotalMatrix())throw new Error("Get total matrix fail!");return new Se(this.wasmIns._getTotalMatrix())}alpha(){return this.wasmIns._alpha()}setAlpha(a){this.wasmIns._setAlpha(a)}visible(){return this.wasmIns._visible()}setVisible(a){this.wasmIns._setVisible(a)}editableIndex(){return this.wasmIns._editableIndex()}parent(){const a=this.wasmIns._parent();if(!a)throw new Error("Get total matrix fail!");return new ut(a)}markers(){const a=this.wasmIns._markers();if(!a)throw new Error("Get markers fail!");return xt(a,s=>s)}localTimeToGlobal(a){return this.wasmIns._localTimeToGlobal(a)}globalToLocalTime(a){return this.wasmIns._globalToLocalTime(a)}duration(){return this.wasmIns._duration()}frameRate(){return this.wasmIns._frameRate()}startTime(){return this.wasmIns._startTime()}setStartTime(a){this.wasmIns._setStartTime(a)}currentTime(){return this.wasmIns._currentTime()}setCurrentTime(a){this.wasmIns._setCurrentTime(a)}getProgress(){return this.wasmIns._getProgress()}setProgress(a){this.wasmIns._setProgress(a)}preFrame(){this.wasmIns._preFrame()}nextFrame(){this.wasmIns._nextFrame()}getBounds(){return this.wasmIns._getBounds()}trackMatteLayer(){const a=this.wasmIns._trackMatteLayer();if(!a)throw new Error("Get track matte layer fail!");return He(a)}excludedFromTimeline(){return this.wasmIns._excludedFromTimeline()}setExcludedFromTimeline(a){this.wasmIns._setExcludedFromTimeline(a)}isPAGFile(){return this.wasmIns._isPAGFile()}asTypeLayer(){return He(this)}isDelete(){return this.wasmIns.isDelete()}destroy(){this.wasmIns.delete(),this.isDestroyed=!0}};lt=Iu([Ie,ke],lt);var Au=Object.defineProperty,Tu=Object.getOwnPropertyDescriptor,ku=(a,s,n,d)=>{for(var m=d>1?void 0:d?Tu(s,n):s,p=a.length-1,v;p>=0;p--)(v=a[p])&&(m=(d?v(s,n,m):v(m))||m);return d&&m&&Au(s,n,m),m};let ut=class extends lt{static make(a,s){const n=I._PAGComposition._Make(a,s);if(!n)throw new Error("Make PAGComposition fail!");return new ut(n)}width(){return this.wasmIns._width()}height(){return this.wasmIns._height()}setContentSize(a,s){this.wasmIns._setContentSize(a,s)}numChildren(){return this.wasmIns._numChildren()}getLayerAt(a){const s=this.wasmIns._getLayerAt(a);if(!s)throw new Error(`Get layer at ${a} fail!`);return He(s)}getLayerIndex(a){return this.wasmIns._getLayerIndex(a.wasmIns)}setLayerIndex(a,s){return this.wasmIns._setLayerIndex(a.wasmIns,s)}addLayer(a){return this.wasmIns._addLayer(a.wasmIns)}addLayerAt(a,s){return this.wasmIns._addLayerAt(a.wasmIns,s)}contains(a){return this.wasmIns._contains(a.wasmIns)}removeLayer(a){const s=this.wasmIns._removeLayer(a.wasmIns);if(!s)throw new Error("Remove layer fail!");return He(s)}removeLayerAt(a){const s=this.wasmIns._removeLayerAt(a);if(!s)throw new Error(`Remove layer at ${a} fail!`);return He(s)}removeAllLayers(){this.wasmIns._removeAllLayers()}swapLayer(a,s){this.wasmIns._swapLayer(a.wasmIns,s.wasmIns)}swapLayerAt(a,s){this.wasmIns._swapLayerAt(a,s)}audioBytes(){return this.wasmIns._audioBytes()}audioMarkers(){const a=this.wasmIns._audioMarkers();if(!a)throw new Error("Get audioMarkers fail!");return xt(a,s=>s)}audioStartTime(){return this.wasmIns._audioStartTime()}getLayersByName(a){const s=this.wasmIns._getLayersByName(a);if(!s)throw new Error(`Get layers by ${a} fail!`);return xt(s,He)}getLayersUnderPoint(a,s){const n=this.wasmIns._getLayersUnderPoint(a,s);if(!n)throw new Error(`Get layers under point ${a},${s} fail!`);return xt(n,He)}};ut=ku([Ie,ke],ut);const Jr=a=>new Promise(s=>{const n=new FileReader;n.onload=()=>{s(n.result)},n.onerror=()=>{console.error(n.error.message)},n.readAsArrayBuffer(a)}),Du=a=>Oe(a,globalThis.File)?Jr(a):Oe(a,globalThis.Blob)?Jr(new File([a],"")):Oe(a,globalThis.ArrayBuffer)?Promise.resolve(a):Promise.resolve(null),Pr=(a,s)=>{const n=new Uint8Array(s),d=n.byteLength,m=a._malloc(d);return new Uint8Array(a.HEAPU8.buffer,m,d).set(n),{byteOffset:m,length:d,free:()=>a._free(m)}},Fu=(a,s,n)=>{const d=new Uint8Array(s),m=a._malloc(d.byteLength);if(!n(m,d.byteLength))return{data:null,free:()=>a._free(m)};const p=new Uint8Array(a.HEAPU8.buffer,m,d.byteLength);return d.set(p),{data:d,free:()=>a._free(m)}};var Ru=Object.defineProperty,Lu=Object.getOwnPropertyDescriptor,oi=(a,s,n,d)=>{for(var m=d>1?void 0:d?Lu(s,n):s,p=a.length-1,v;p>=0;p--)(v=a[p])&&(m=(d?v(s,n,m):v(m))||m);return d&&m&&Ru(s,n,m),m};let Ye=class extends ut{static async load(a){const s=await Du(a);if(!s)throw new Error("Initialize PAGFile data type error, please put check data type must to be File ï½œ Blob | ArrayBuffer!");return Ye.loadFromBuffer(s)}static loadFromBuffer(a){if(!a||!(a.byteLength>0))throw new Error("Initialize PAGFile data not be empty!");const{byteOffset:s,length:n,free:d}=Pr(I,a),m=I._PAGFile._Load(s,n);if(d(),!m)throw new Error("Load PAGFile fail!");return new Ye(m)}static maxSupportedTagLevel(){return I._PAGFile._MaxSupportedTagLevel()}tagLevel(){return this.wasmIns._tagLevel()}numTexts(){return this.wasmIns._numTexts()}numImages(){return this.wasmIns._numImages()}numVideos(){return this.wasmIns._numVideos()}getTextData(a){return this.wasmIns._getTextData(a)}replaceText(a,s){this.wasmIns._replaceText(a,s)}replaceImage(a,s){this.wasmIns._replaceImage(a,s.wasmIns)}getLayersByEditableIndex(a,s){const n=this.wasmIns._getLayersByEditableIndex(a,s);if(!n)throw new Error(`Get ${Cu(s)} layers by ${a} fail!`);return xt(n,He)}getEditableIndices(a){return this.wasmIns._getEditableIndices(a)}timeStretchMode(){return this.wasmIns._timeStretchMode()}setTimeStretchMode(a){this.wasmIns._setTimeStretchMode(a)}setDuration(a){this.wasmIns._setDuration(a)}copyOriginal(){const a=this.wasmIns._copyOriginal();if(!a)throw new Error("Copy original fail!");return new Ye(a)}};oi([Ht],Ye,"load",1);Ye=oi([Ie,ke],Ye);var ju=Object.defineProperty,Gu=Object.getOwnPropertyDescriptor,Ou=(a,s,n,d)=>{for(var m=d>1?void 0:d?Gu(s,n):s,p=a.length-1,v;p>=0;p--)(v=a[p])&&(m=(d?v(s,n,m):v(m))||m);return d&&m&&ju(s,n,m),m};let Qe=class{constructor(a){this.isDestroyed=!1,this.wasmIns=a}static fromCanvas(a){const s=I._PAGSurface._FromCanvas(a);if(!s)throw new Error(`Make PAGSurface from canvas ${a} fail!`);return new Qe(s)}static fromTexture(a,s,n,d){const m=I._PAGSurface._FromTexture(a,s,n,d);if(!m)throw new Error(`Make PAGSurface from texture ${a} fail!`);return new Qe(m)}static fromRenderTarget(a,s,n,d){const m=I._PAGSurface._FromRenderTarget(a,s,n,d);if(!m)throw new Error(`Make PAGSurface from frameBuffer ${a} fail!`);return new Qe(m)}width(){return this.wasmIns._width()}height(){return this.wasmIns._height()}updateSize(){this.wasmIns._updateSize()}clearAll(){return this.wasmIns._clearAll()}freeCache(){this.wasmIns._freeCache()}readPixels(a,s){if(a===wr.Unknown)return null;const n=this.width()*(a===wr.ALPHA_8?1:4),d=n*this.height(),m=new Uint8Array(d),{data:p,free:v}=Fu(I,m,b=>this.wasmIns._readPixels(a,s,b,n));return v(),p}destroy(){this.wasmIns.delete(),this.isDestroyed=!0}};Qe=Ou([Ie,ke],Qe);var Mu=Object.defineProperty,Bu=Object.getOwnPropertyDescriptor,Zr=(a,s,n,d)=>{for(var m=d>1?void 0:d?Bu(s,n):s,p=a.length-1,v;p>=0;p--)(v=a[p])&&(m=(d?v(s,n,m):v(m))||m);return d&&m&&Mu(s,n,m),m};let Et=class{constructor(a){this.isDestroyed=!1,this.videoReaders=[],this.wasmIns=a}static create(){const a=new I._PAGPlayer;if(!a)throw new Error("Create PAGPlayer fail!");return new Et(a)}setProgress(a){this.wasmIns._setProgress(a)}async flush(){return I.webAssemblyQueue.exec(this.wasmIns._flush,this.wasmIns)}async flushInternal(a){const s=await I.webAssemblyQueue.exec(async()=>{I.currentPlayer=this;const n=await this.wasmIns._flush();return I.currentPlayer=null,a(n),n},this.wasmIns);for(const n of this.videoReaders){const d=await n.getError();if(d!==null)throw d}return s}duration(){return this.wasmIns._duration()}getProgress(){return this.wasmIns._getProgress()}currentFrame(){return this.wasmIns._currentFrame()}videoEnabled(){return this.wasmIns._videoEnabled()}setVideoEnabled(a){this.wasmIns._setVideoEnabled(a)}cacheEnabled(){return this.wasmIns._cacheEnabled()}setCacheEnabled(a){this.wasmIns._setCacheEnabled(a)}cacheScale(){return this.wasmIns._cacheScale()}setCacheScale(a){this.wasmIns._setCacheScale(a)}maxFrameRate(){return this.wasmIns._maxFrameRate()}setMaxFrameRate(a){this.wasmIns._setMaxFrameRate(a)}scaleMode(){return this.wasmIns._scaleMode()}setScaleMode(a){this.wasmIns._setScaleMode(a)}setSurface(a){this.wasmIns._setSurface(Mn(a))}getComposition(){const a=this.wasmIns._getComposition();if(!a)throw new Error("Get composition fail!");return a._isPAGFile()?new Ye(a):new ut(a)}setComposition(a){this.wasmIns._setComposition(Mn(a))}getSurface(){const a=this.wasmIns._getSurface();if(!a)throw new Error("Get surface fail!");return new Qe(a)}matrix(){const a=this.wasmIns._matrix();if(!a)throw new Error("Get matrix fail!");return new Se(a)}setMatrix(a){this.wasmIns._setMatrix(a.wasmIns)}nextFrame(){this.wasmIns._nextFrame()}preFrame(){this.wasmIns._preFrame()}autoClear(){return this.wasmIns._autoClear()}setAutoClear(a){this.wasmIns._setAutoClear(a)}getBounds(a){return this.wasmIns._getBounds(a.wasmIns)}getLayersUnderPoint(a,s){const n=this.wasmIns._getLayersUnderPoint(a,s);if(!n)throw new Error(`Get layers under point, x: ${a} y:${s} fail!`);return xt(n,He)}hitTestPoint(a,s,n,d=!1){return this.wasmIns._hitTestPoint(a.wasmIns,s,n,d)}renderingTime(){return this.wasmIns._renderingTime()}imageDecodingTime(){return this.wasmIns._imageDecodingTime()}presentingTime(){return this.wasmIns._presentingTime()}graphicsMemory(){return this.wasmIns._graphicsMemory()}prepare(){return I.webAssemblyQueue.exec(async()=>{I.currentPlayer=this,await this.wasmIns._prepare(),I.currentPlayer=null},this.wasmIns)}destroy(){this.wasmIns.delete(),this.isDestroyed=!0}linkVideoReader(a){this.videoReaders.push(a)}unlinkVideoReader(a){const s=this.videoReaders.indexOf(a);s!==-1&&this.videoReaders.splice(s,1)}};Zr([Ht],Et.prototype,"flush",1);Zr([Ht],Et.prototype,"flushInternal",1);Et=Zr([Ie,ke],Et);var Nu=Object.defineProperty,$u=Object.getOwnPropertyDescriptor,li=(a,s,n,d)=>{for(var m=d>1?void 0:d?$u(s,n):s,p=a.length-1,v;p>=0;p--)(v=a[p])&&(m=(d?v(s,n,m):v(m))||m);return d&&m&&Nu(s,n,m),m};let Je=class{constructor(a){this.isDestroyed=!1,this.wasmIns=a}static async fromFile(a){return new Promise((s,n)=>{const d=new Image;d.onload=async()=>{s(Je.fromSource(d))},d.onerror=m=>{n(m)},d.src=URL.createObjectURL(a)})}static fromSource(a){const s=I._PAGImage._FromNativeImage(a);if(!s)throw new Error("Make PAGImage from source fail!");return new Je(s)}static fromPixels(a,s,n,d,m){const p=s*(d===wr.ALPHA_8?1:4),{byteOffset:v,free:b}=Pr(I,a),A=I._PAGImage._FromPixels(v,s,n,p,d,m);if(b(),!A)throw new Error("Make PAGImage from pixels fail!");return new Je(A)}static fromTexture(a,s,n,d){const m=I._PAGImage._FromTexture(a,s,n,d);if(!m)throw new Error("Make PAGImage from texture fail!");return new Je(m)}width(){return this.wasmIns._width()}height(){return this.wasmIns._height()}scaleMode(){return this.wasmIns._scaleMode()}setScaleMode(a){this.wasmIns._setScaleMode(a)}matrix(){const a=this.wasmIns._matrix();if(!a)throw new Error("Get matrix fail!");return new Se(a)}setMatrix(a){this.wasmIns._setMatrix(a.wasmIns)}destroy(){this.wasmIns.delete(),this.isDestroyed=!0}};li([Ht],Je,"fromFile",1);Je=li([Ie,ke],Je);class Vu{constructor(){this.listenerMap=new Map}on(s,n){let d=[];this.listenerMap.has(s)&&(d=this.listenerMap.get(s)),d.push(n),this.listenerMap.set(s,d)}off(s,n){if(!this.listenerMap.has(s))return!1;const d=this.listenerMap.get(s);if(d.length===0)return!1;if(!n)return this.listenerMap.delete(s),!0;const m=d.indexOf(n);return m===-1?!1:(d.splice(m,1),!0)}emit(s,n){if(!this.listenerMap.has(s))return!1;const d=this.listenerMap.get(s);return d.length===0?!1:(d.forEach(m=>m(n)),!0)}}const Uu=3,Hu=12,gr=2560,en={depth:!1,stencil:!1,antialias:!1},zu=.125,Wu=4,qu=10,tn=(navigator==null?void 0:navigator.userAgent)||"",rn=/(iphone|ipad|ipod)/i.test(tn),Ku=/MicroMessenger/i.test(tn),ui=/^((?!chrome|android).)*safari/i.test(tn)||rn,Mt=typeof globalThis.importScripts=="function",Yr=new Array,Qr=a=>Oe(a,globalThis.OffscreenCanvas),Xu=a=>Qr(a)||Oe(a,globalThis.HTMLCanvasElement),br=(a,s)=>{let n=Yr.pop()||Ju();return n!==null&&(n.width=a,n.height=s),n},ci=a=>{Yr.length<qu&&Yr.push(a)},Ju=()=>{if(ui&&!Mt)return document.createElement("canvas");try{const a=new OffscreenCanvas(0,0);return typeof a.getContext("2d").measureText=="function"?a:document.createElement("canvas")}catch{return document.createElement("canvas")}},Yu=a=>{const s=globalThis.getComputedStyle(a,null),n={width:Number(s.width.replace("px","")),height:Number(s.height.replace("px",""))};if(n.width>0&&n.height>0)return n;{const d={width:Number(a.style.width.replace("px","")),height:Number(a.style.height.replace("px",""))};return d.width>0&&d.height>0?d:{width:a.width,height:a.height}}};var Qu=Object.defineProperty,Bn=Object.getOwnPropertySymbols,Zu=Object.prototype.hasOwnProperty,ec=Object.prototype.propertyIsEnumerable,Nn=(a,s,n)=>s in a?Qu(a,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):a[s]=n,tc=(a,s)=>{for(var n in s||(s={}))Zu.call(s,n)&&Nn(a,n,s[n]);if(Bn)for(var n of Bn(s))ec.call(s,n)&&Nn(a,n,s[n]);return a};class Ge{constructor(s,n=!1){this.isDestroyed=!1,this.oldHandle=0,this.handle=s,this.adopted=n}static from(s){if(s instanceof Ge)return new Ge(s.handle,!0);{const n=Oe(s,globalThis.WebGL2RenderingContext)?2:1,{GL:d}=I;let m=0;return d.contexts.length>0&&(m=d.contexts.findIndex(p=>(p==null?void 0:p.GLctx)===s)),m<1?(m=d.registerContext(s,tc({majorVersion:n,minorVersion:0},en)),new Ge(m)):new Ge(m,!0)}}getContext(){return I.GL.getContext(this.handle).GLctx}makeCurrent(){var s;return this.isDestroyed?!1:(this.oldHandle=((s=I.GL.currentContext)==null?void 0:s.handle)||0,this.oldHandle===this.handle?!0:I.GL.makeContextCurrent(this.handle))}clearCurrent(){this.isDestroyed||this.oldHandle!==this.handle&&(I.GL.makeContextCurrent(0),this.oldHandle&&I.GL.makeContextCurrent(this.oldHandle))}registerTexture(s){return this.register(I.GL.textures,s)}getTexture(s){return I.GL.textures[s]}unregisterTexture(s){I.GL.textures[s]=null}registerRenderTarget(s){return this.register(I.GL.framebuffers,s)}getRenderTarget(s){return I.GL.framebuffers[s]}unregisterRenderTarget(s){I.GL.framebuffers[s]=null}destroy(){this.adopted||I.GL.deleteContext(this.handle)}register(s,n){const d=I.GL.getNewId(s);return s[d]=n,d}}var rc=Object.defineProperty,$n=Object.getOwnPropertySymbols,nc=Object.prototype.hasOwnProperty,ic=Object.prototype.propertyIsEnumerable,Vn=(a,s,n)=>s in a?rc(a,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):a[s]=n,Un=(a,s)=>{for(var n in s||(s={}))nc.call(s,n)&&Vn(a,n,s[n]);if($n)for(var n of $n(s))ic.call(s,n)&&Vn(a,n,s[n]);return a};const Hn=[];class Sr{constructor(s,n){this._canvas=null,this._glContext=null,this.retainCount=0,this._canvas=s;const d=s.getContext("webgl",Un(Un({},en),n));if(!d)throw new Error("Canvas context is not WebGL!");this._glContext=Ge.from(d)}static from(s,n){let d=Hn.find(m=>m.canvas===s);return d||(d=new Sr(s,n),Hn.push(d),d)}retain(){this.retainCount+=1}release(){if(this.retainCount-=1,this.retainCount===0){if(!this._glContext)return;this._glContext.destroy(),this._glContext=null,this._canvas=null}}get canvas(){return this._canvas}get glContext(){return this._glContext}}let bt;try{bt=performance.now.bind(performance)}catch{bt=Date.now.bind(Date)}class ac{constructor(){this.startTime=bt(),this.markers={}}reset(){this.startTime=bt(),this.markers={}}mark(s){if(!s){console.log("Clock.mark(): An empty marker name was specified!");return}if(Object.keys(this.markers).find(n=>n===s)){console.log(`Clock.mark(): The specified marker name '${s}' already exists!`);return}this.markers[s]=bt()}measure(s,n){let d,m;if(!s)d=this.startTime;else{if(!Object.keys(this.markers).find(p=>p===s))return console.log(`Clock.measure(): The specified makerFrom '${s}' does not exist!`),0;d=this.markers[s]}if(!n)m=bt();else{if(!Object.keys(this.markers).find(p=>p===n))return console.log(`Clock.measure(): The specified makerTo '${n}' does not exist!`),0;m=this.markers[n]}return m-d}}var fi=Object.defineProperty,sc=Object.getOwnPropertyDescriptor,zn=Object.getOwnPropertySymbols,oc=Object.prototype.hasOwnProperty,lc=Object.prototype.propertyIsEnumerable,Wn=(a,s,n)=>s in a?fi(a,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):a[s]=n,_r=(a,s)=>{for(var n in s||(s={}))oc.call(s,n)&&Wn(a,n,s[n]);if(zn)for(var n of zn(s))lc.call(s,n)&&Wn(a,n,s[n]);return a},uc=(a,s,n,d)=>{for(var m=d>1?void 0:d?sc(s,n):s,p=a.length-1,v;p>=0;p--)(v=a[p])&&(m=(d?v(s,n,m):v(m))||m);return d&&m&&fi(s,n,m),m};let Bt=class{constructor(a,s){this.repeatCount=0,this.isPlaying=!1,this.isDestroyed=!1,this.pagViewOptions={useScale:!0,useCanvas2D:!1,firstFrame:!0},this.renderCanvas=null,this.pagGlContext=null,this.frameRate=0,this.pagSurface=null,this.playFrame=-1,this.timer=null,this.flushingNextFrame=!1,this.playTime=0,this.startTime=0,this.repeatedTimes=0,this.eventManager=new Vu,this.rawWidth=0,this.rawHeight=0,this.debugData={FPS:0,flushTime:0},this.fpsBuffer=[],this.player=a,this.canvasElement=s}static async init(a,s,n={}){let d=null;if(typeof s=="string"?d=document.getElementById(s.substr(1)):(typeof window<"u"&&Oe(s,globalThis.HTMLCanvasElement)||Qr(s))&&(d=s),!d)throw new Error("Canvas is not found!");const m=I.PAGPlayer.create(),p=new Bt(m,d);return p.pagViewOptions=_r(_r({},p.pagViewOptions),n),p.pagViewOptions.useCanvas2D?(I.globalCanvas.retain(),p.pagGlContext=Ge.from(I.globalCanvas.glContext)):(p.renderCanvas=Sr.from(d),p.renderCanvas.retain(),p.pagGlContext=Ge.from(p.renderCanvas.glContext)),p.resetSize(p.pagViewOptions.useScale),p.frameRate=a.frameRate(),p.pagSurface=this.makePAGSurface(p.pagGlContext,p.rawWidth,p.rawHeight),p.player.setSurface(p.pagSurface),p.player.setComposition(a),p.setProgress(0),p.pagViewOptions.firstFrame&&(await p.flush(),p.playFrame=0),p}static makePAGSurface(a,s,n){if(!a.makeCurrent())throw new Error("Make context current fail!");const d=Qe.fromRenderTarget(0,s,n,!0);return a.clearCurrent(),d}duration(){return this.player.duration()}addListener(a,s){return this.eventManager.on(a,s)}removeListener(a,s){return this.eventManager.off(a,s)}async play(){if(this.isPlaying)return;this.isPlaying=!0,this.startTime=this.getNowTime()*1e3-this.playTime;for(const s of this.player.videoReaders)s.isPlaying=!0;const a=this.playTime;await this.flushLoop(!0),a===0&&this.eventManager.emit("onAnimationStart",this),this.eventManager.emit("onAnimationPlay",this),this.playFrame===0&&this.eventManager.emit("onAnimationUpdate",this)}pause(){if(this.isPlaying){this.clearTimer();for(const a of this.player.videoReaders)a.pause();this.isPlaying=!1,this.eventManager.emit("onAnimationPause",this)}}async stop(a=!0){this.clearTimer(),this.playTime=0,this.player.setProgress(0),this.playFrame=0,await this.flush();for(const s of this.player.videoReaders)s.stop();this.isPlaying=!1,a&&this.eventManager.emit("onAnimationCancel",this)}setRepeatCount(a){this.repeatCount=a<0?0:a-1}getProgress(){return this.player.getProgress()}currentFrame(){return this.player.currentFrame()}setProgress(a){return this.playTime=a*this.duration(),this.startTime=this.getNowTime()*1e3-this.playTime,this.isPlaying||this.player.setProgress(a),a}videoEnabled(){return this.player.videoEnabled()}setVideoEnabled(a){this.player.setVideoEnabled(a)}cacheEnabled(){return this.player.cacheEnabled()}setCacheEnabled(a){this.player.setCacheEnabled(a)}cacheScale(){return this.player.cacheScale()}setCacheScale(a){this.player.setCacheScale(a)}maxFrameRate(){return this.player.maxFrameRate()}setMaxFrameRate(a){this.player.setMaxFrameRate(a)}scaleMode(){return this.player.scaleMode()}setScaleMode(a){this.player.setScaleMode(a)}async flush(){const a=new ac,s=await this.player.flushInternal(n=>{var d,m;if(this.pagViewOptions.useCanvas2D&&n&&I.globalCanvas.canvas){this.canvasContext||(this.canvasContext=(d=this.canvasElement)==null?void 0:d.getContext("2d"));const p=this.canvasContext.globalCompositeOperation;this.canvasContext.globalCompositeOperation="copy",(m=this.canvasContext)==null||m.drawImage(I.globalCanvas.canvas,0,I.globalCanvas.canvas.height-this.rawHeight,this.rawWidth,this.rawHeight,0,0,this.canvasContext.canvas.width,this.canvasContext.canvas.height),this.canvasContext.globalCompositeOperation=p}a.mark("flush"),this.setDebugData({flushTime:a.measure("","flush")}),this.updateFPS()});return this.eventManager.emit("onAnimationUpdate",this),s&&this.eventManager.emit("onAnimationFlushed",this),s}freeCache(){var a;(a=this.pagSurface)==null||a.freeCache()}getComposition(){return this.player.getComposition()}setComposition(a){this.player.setComposition(a)}matrix(){return this.player.matrix()}setMatrix(a){this.player.setMatrix(a)}getLayersUnderPoint(a,s){return this.player.getLayersUnderPoint(a,s)}updateSize(){var a;if(!this.canvasElement)throw new Error("Canvas element is not found!");if(this.rawWidth=this.canvasElement.width,this.rawHeight=this.canvasElement.height,!this.pagGlContext)return;const s=Bt.makePAGSurface(this.pagGlContext,this.rawWidth,this.rawHeight);this.player.setSurface(s),(a=this.pagSurface)==null||a.destroy(),this.pagSurface=s}prepare(){return this.player.prepare()}makeSnapshot(){return createImageBitmap(this.canvasElement)}destroy(){var a,s,n;this.clearTimer(),this.player.destroy(),(a=this.pagSurface)==null||a.destroy(),this.pagViewOptions.useCanvas2D?I.globalCanvas.release():(s=this.renderCanvas)==null||s.release(),(n=this.pagGlContext)==null||n.destroy(),this.pagGlContext=null,this.canvasContext=null,this.canvasElement=null,this.isDestroyed=!0}getDebugData(){return this.debugData}setDebugData(a){this.debugData=_r(_r({},this.debugData),a)}async flushLoop(a=!1){if(this.isPlaying&&(this.setTimer(),!this.flushingNextFrame))try{this.flushingNextFrame=!0,await this.flushNextFrame(a),this.flushingNextFrame=!1}catch(s){throw this.flushingNextFrame=!1,s.message!=="The play() request was interrupted because the document was hidden!"&&this.clearTimer(),s}}async flushNextFrame(a=!1){const s=this.duration();this.playTime=this.getNowTime()*1e3-this.startTime;const n=Math.floor(this.playTime/1e6*this.frameRate),d=Math.floor(this.playTime/s);if(!a&&this.repeatCount>=0&&d>this.repeatCount)return this.clearTimer(),this.player.setProgress(1),await this.flush(),this.playTime=0,this.isPlaying=!1,this.repeatedTimes=0,this.eventManager.emit("onAnimationEnd",this),!0;if(!a&&this.repeatedTimes===d&&this.playFrame===n)return!1;this.repeatedTimes<d&&this.eventManager.emit("onAnimationRepeat",this),this.player.setProgress(this.playTime%s/s);const m=await this.flush();return this.needResetStartTime()&&(this.startTime=this.getNowTime()*1e3-this.playTime),this.playFrame=n,this.repeatedTimes=d,m}getNowTime(){try{return performance.now()}catch{return Date.now()}}setTimer(){Mt?this.timer=self.setTimeout(()=>{this.flushLoop()},1/this.frameRate*1e3):this.timer=globalThis.requestAnimationFrame(()=>{this.flushLoop()})}clearTimer(){this.timer&&(Mt?self.clearTimeout(this.timer):globalThis.cancelAnimationFrame(this.timer),this.timer=null)}resetSize(a=!0){if(!this.canvasElement)throw new Error("Canvas element is not found!");if(!a||Qr(this.canvasElement)){this.rawWidth=this.canvasElement.width,this.rawHeight=this.canvasElement.height;return}const s=this.canvasElement,n=Yu(s);s.style.width=`${n.width}px`,s.style.height=`${n.height}px`,this.rawWidth=n.width*globalThis.devicePixelRatio,this.rawHeight=n.height*globalThis.devicePixelRatio,s.width=this.rawWidth,s.height=this.rawHeight}updateFPS(){let a;try{a=performance.now()}catch{a=Date.now()}this.fpsBuffer=this.fpsBuffer.filter(s=>a-s<=1e3),this.fpsBuffer.push(a),this.setDebugData({FPS:this.fpsBuffer.length})}needResetStartTime(){for(const a of this.player.videoReaders)if(a.isSought)return!0;return!1}};Bt=uc([Ie],Bt);const cc=["Arial",'"Courier New"',"Georgia",'"Times New Roman"','"Trebuchet MS"',"Verdana"],di=["emoji"].concat(...cc),fc=(a,s="")=>{if(!a)return[];const n=a.split(" ");let d=[];n.length===1?d.push(a):(d.push(n.join("")),d.push(n.join(" ")));const m=d.reduce((p,v)=>(s?(p.push(`"${v} ${s}"`),p.push(`"${v}-${s}"`)):p.push(`"${v}"`),p),[]);return s!==""&&m.push(`"${a}"`),m};var dc=Object.defineProperty,mc=Object.getOwnPropertyDescriptor,mi=(a,s,n,d)=>{for(var m=d>1?void 0:d?mc(s,n):s,p=a.length-1,v;p>=0;p--)(v=a[p])&&(m=(d?v(s,n,m):v(m))||m);return d&&m&&dc(s,n,m),m};let Ct=class{constructor(a){this.isDestroyed=!1,this.wasmIns=a,this.fontFamily=this.wasmIns.fontFamily,this.fontStyle=this.wasmIns.fontStyle}static create(a,s){const n=I._PAGFont._create(a,s);if(!n)throw new Error("Create PAGFont fail!");return new Ct(n)}static async registerFont(a,s){const n=await Jr(s);if(!n||!(n.byteLength>0))throw new Error("Initialize PAGFont data not be empty!");const d=new Uint8Array(n),m=new FontFace(a,d);document.fonts.add(m),await m.load()}static registerFallbackFontNames(a=[]){const s=new I.VectorString,n=a.concat(di);for(const d of n)s.push_back(d);I._PAGFont._SetFallbackFontNames(s),s.delete()}destroy(){this.wasmIns.delete(),this.isDestroyed=!0}};mi([Ht],Ct,"registerFont",1);Ct=mi([Ie,ke],Ct);let ze={};const hi=(a,s,n,d=!1)=>{var m;s in ze||(ze[s]=[]),(m=ze[s])==null||m.push({node:a,handler:n,capture:d}),a.addEventListener(s,n,d)},xr=(a,s,n)=>{var d;s in ze&&((d=ze[s])==null||d.filter(({node:m,handler:p})=>m===a&&p===n).forEach(({node:m,handler:p,capture:v})=>m.removeEventListener(s,p,v)))},qn=(a,s)=>{var n,d;s in ze&&((n=ze[s])==null||n.filter(({node:m})=>m===a).forEach(({node:m,handler:p,capture:v})=>m.removeEventListener(s,p,v)),ze[s]=(d=ze[s])==null?void 0:d.filter(({node:m})=>m!==a))};var ce=(a=>(a.PAGInit="PAGInit",a.PAGView_init="PAGView.init",a.PAGView_duration="PAGView.duration",a.PAGView_play="PAGView.play",a.PAGView_pause="PAGView.pause",a.PAGView_stop="PAGView.stop",a.PAGView_setRepeatCount="PAGView.setRepeatCount",a.PAGView_getProgress="PAGView.getProgress",a.PAGView_currentFrame="PAGView.currentFrame",a.PAGView_setProgress="PAGView.setProgress",a.PAGView_scaleMode="PAGView.scaleMode",a.PAGView_setScaleMode="PAGView.setScaleMode",a.PAGView_flush="PAGView.flush",a.PAGView_getDebugData="PAGView.getDebugData",a.PAGView_destroy="PAGView.destroy",a.PAGFile_load="PAGFile.load",a.PAGFile_getTextData="PAGFile.getTextData",a.PAGFile_replaceText="PAGFile.replaceText",a.PAGFile_replaceImage="PAGFile.replaceImage",a.PAGFile_destroy="PAGFile.destroy",a.PAGImage_fromSource="PAGImage.fromSource",a.PAGImage_destroy="PAGImage.destroy",a.VideoReader_constructor="VideoReader.constructor",a.VideoReader_prepare="VideoReader.prepare",a.VideoReader_play="VideoReader.play",a.VideoReader_pause="VideoReader.pause",a.VideoReader_stop="VideoReader.stop",a.VideoReader_getError="VideoReader.getError",a.PAGModule_linkVideoReader="PAGModule.linkVideoReader",a.TextDocument_delete="TextDocument.delete",a))(ce||{});let hc=0;const pc=a=>`${a}_${hc++}`,yt=(a,s,n,d=[])=>new Promise(m=>{const p=pc(s.name),v=b=>{b.data.name===p&&(a.removeEventListener("message",v),m(n(...b.data.args)))};a.addEventListener("message",v),a.postMessage({name:p,args:s.args},d)});class pi{constructor(s){this.bitmap=s}setBitmap(s){this.bitmap&&this.bitmap.close(),this.bitmap=s}}class vc{constructor(s){this.bitmap=null,this.isSought=!1,this.isPlaying=!1,this.bitmapImage=new pi(null),this.proxyId=s}prepare(s,n){return new Promise(d=>{yt(self,{name:ce.VideoReader_prepare,args:[this.proxyId,s,n]},m=>{this.bitmapImage.setBitmap(m),d()})})}getVideo(){return this.bitmapImage}onDestroy(){self.postMessage({name:"VideoReader.onDestroy",args:[this.proxyId]})}play(){return new Promise(s=>{yt(self,{name:ce.VideoReader_play,args:[this.proxyId]},()=>{s()})})}pause(){yt(self,{name:ce.VideoReader_pause,args:[this.proxyId]},()=>{})}stop(){yt(self,{name:ce.VideoReader_stop,args:[this.proxyId]},()=>{})}getError(){return new Promise(s=>{yt(self,{name:ce.VideoReader_getError,args:[this.proxyId]},n=>{s(n)})})}}const Kn=3840,gc=()=>new Promise(a=>{window.WeixinJSBridge.invoke("getNetworkType",{},()=>{a()},()=>{a()})}),Xn=a=>new Promise(s=>{const n=()=>{xr(a,"canplay",n),clearTimeout(d),s(!0)};hi(a,"canplay",n);const d=setTimeout(()=>{xr(a,"canplay",n),s(!1)},1e3)});class nn{constructor(s,n,d,m,p,v=!1){if(this.isSought=!1,this.isPlaying=!1,this.bitmap=null,this.videoEl=null,this.frameRate=0,this.canplay=!1,this.staticTimeRanges=null,this.disablePlaybackRate=!1,this.error=null,this.player=null,this.width=0,this.height=0,this.bitmapCanvas=null,this.bitmapCtx=null,Oe(s,globalThis.HTMLVideoElement))this.videoEl=s,this.canplay=!0;else{this.videoEl=document.createElement("video"),this.videoEl.style.display="none",this.videoEl.muted=!0,this.videoEl.playsInline=!0,this.videoEl.preload="auto",this.videoEl.width=n,this.videoEl.height=d,Xn(this.videoEl).then(()=>{this.canplay=!0});const b=new Blob([s],{type:"video/mp4"});this.videoEl.src=URL.createObjectURL(b),rn&&this.videoEl.load()}this.frameRate=m,this.width=n,this.height=d,this.staticTimeRanges=new _c(p),(Kn<n||Kn<d)&&(this.disablePlaybackRate=!0),v||this.linkPlayer(I.currentPlayer)}static async create(s,n,d,m,p){var v;if(Mt){const b=await new Promise(D=>{const O=s,K=O.buffer.slice(O.byteOffset,O.byteOffset+O.byteLength);yt(self,{name:ce.VideoReader_constructor,args:[K,n,d,m,p,!0]},$=>{D($)},[K])}),A=new vc(b);return(v=I.currentPlayer)==null||v.linkVideoReader(A),A}return new nn(s,n,d,m,p)}async prepare(s,n){var d;this.setError(null),this.isSought=!1;const{currentTime:m}=this.videoEl,p=s/this.frameRate;if(m===0&&p===0)if(!this.canplay&&!ui)await Xn(this.videoEl);else{try{await this.play()}catch(b){this.setError(b)}await new Promise(b=>{requestAnimationFrame(()=>{this.pause(),b()})})}else if(Math.round(p*this.frameRate)!==Math.round(m*this.frameRate)){if((d=this.staticTimeRanges)!=null&&d.contains(s)){await this.seek(p,!1);return}else if(!(Math.abs(m-p)<1/this.frameRate*Uu)){this.isSought=!0,await this.seek(p);return}}const v=Math.min(Math.max(n,zu),Wu);if(!this.disablePlaybackRate&&this.videoEl.playbackRate!==v&&(this.videoEl.playbackRate=v),this.isPlaying&&this.videoEl.paused)try{await this.play()}catch(b){this.setError(b)}}getVideo(){return this.videoEl}async generateBitmap(){var s,n;return this.bitmapCanvas||(this.bitmapCanvas=new OffscreenCanvas(this.width,this.height),this.bitmapCanvas.width=this.width,this.bitmapCanvas.height=this.height,this.bitmapCtx=this.bitmapCanvas.getContext("2d")),(s=this.bitmapCtx)==null||s.fillRect(0,0,this.width,this.height),(n=this.bitmapCtx)==null||n.drawImage(this.videoEl,0,0,this.width,this.height),this.bitmap=await createImageBitmap(this.bitmapCanvas),this.bitmap}async play(){var s;if(this.videoEl.paused){if(Ku&&window.WeixinJSBridge&&await gc(),document.visibilityState!=="visible"){const n=()=>{document.visibilityState==="visible"&&(this.videoEl&&this.videoEl.play(),window.removeEventListener("visibilitychange",n))};throw window.addEventListener("visibilitychange",n),new Error("The play() request was interrupted because the document was hidden!")}await((s=this.videoEl)==null?void 0:s.play())}}pause(){var s;this.isPlaying=!1,!this.videoEl.paused&&((s=this.videoEl)==null||s.pause())}stop(){var s;this.isPlaying=!1,this.videoEl.paused||(s=this.videoEl)==null||s.pause(),this.videoEl.currentTime=0}getError(){return this.error}onDestroy(){this.player&&this.player.unlinkVideoReader(this),qn(this.videoEl,"playing"),qn(this.videoEl,"timeupdate"),this.videoEl=null,this.bitmapCanvas=null,this.bitmapCtx=null}seek(s,n=!0){return new Promise(d=>{let m=!1,p=null;const v=async()=>{var A;if(n&&this.videoEl.paused)try{await this.play()}catch(D){this.setError(D)}else!n&&!this.videoEl.paused&&((A=this.videoEl)==null||A.pause())},b=async()=>{if(!this.videoEl){this.setError(new Error("Video element doesn't exist!")),d();return}xr(this.videoEl,"seeked",b),await v(),m=!0,clearTimeout(p),p=null,d()};if(!this.videoEl){this.setError(new Error("Video element doesn't exist!")),d();return}hi(this.videoEl,"seeked",b),this.videoEl.currentTime=s,p=setTimeout(()=>{if(!m)if(this.videoEl)xr(this.videoEl,"seeked",b),v(),d();else{this.setError(new Error("Video element doesn't exist!")),d();return}},1e3/this.frameRate*Hu)})}setError(s){this.error=s}linkPlayer(s){this.player=s,s&&s.linkVideoReader(this)}}class _c{constructor(s){this.timeRanges=s}contains(s){if(this.timeRanges.length===0)return!1;for(let n of this.timeRanges)if(n.start<=s&&s<n.end)return!0;return!1}}const Jn=a=>{const s=new Int32Array(a.data.buffer);let n=yc(s,a.width,a.height),d=wc(s,a.width,a.height),m=bc(s,a.width,a.height),p=xc(s,a.width,a.height);return{left:n,top:d,right:m,bottom:p}},yc=(a,s,n)=>{const d=a.length/s,m=a.length/n;for(let p=0;p<m;p++)for(let v=0;v<d;v++)if(a[p+v*s]!==0)return p;return m},wc=(a,s,n)=>{const d=a.length/s,m=a.length/n;for(let p=0;p<d;p++)for(let v=0;v<m;v++)if(a[p*s+v]!==0)return p;return d},bc=(a,s,n)=>{const d=a.length/s,m=a.length/n;for(let p=m-1;p>0;p--)for(let v=d-1;v>0;v--)if(a[p+s*v]!==0)return p;return 0},xc=(a,s,n)=>{const d=a.length/s,m=a.length/n;for(let p=d-1;p>0;p--)for(let v=m-1;v>0;v--)if(a[p*s+v]!==0)return p;return 0};class be{constructor(s,n,d,m=!1,p=!1){this.fontBoundingBoxMap=[],this.fontName=s,this.fontStyle=n,this.size=d,this.fauxBold=m,this.fauxItalic=p,this.loadCanvas()}static setCanvas(s){be.canvas=s}static setContext(s){be.context=s}static isUnicodePropertyEscapeSupported(){try{const s=new RegExp("\\p{L}","u");return!0}catch{return!1}}static isEmoji(s){let n;return this.isUnicodePropertyEscapeSupported()?n=new RegExp("\\p{Extended_Pictographic}|[#*0-9]\\uFE0F?\\u20E3|[\\uD83C\\uDDE6-\\uD83C\\uDDFF]","u"):n=/(\u00a9|\u00ae|[\u2000-\u3300]|\ud83c[\ud000-\udfff]|\ud83d[\ud000-\udfff]|\ud83e[\ud000-\udfff])/,n.test(s)}fontString(){const s=[];this.fauxItalic&&s.push("italic"),this.fauxBold&&s.push("bold"),s.push(`${this.size}px`);const n=di.concat();return n.unshift(...fc(this.fontName,this.fontStyle)),s.push(`${n.join(",")}`),s.join(" ")}getTextAdvance(s){const{context:n}=be;return n.font=this.fontString(),n.measureText(s).width}getTextBounds(s){const{context:n}=be;n.font=this.fontString();const d=this.measureText(n,s);return{left:Math.floor(-d.actualBoundingBoxLeft),top:Math.floor(-d.actualBoundingBoxAscent),right:Math.ceil(d.actualBoundingBoxRight),bottom:Math.ceil(d.actualBoundingBoxDescent)}}generateFontMetrics(){const{context:s}=be;s.font=this.fontString();const n=this.measureText(s,"ä¸­"),d=n.actualBoundingBoxAscent,p=this.measureText(s,"x").actualBoundingBoxAscent;return{ascent:-n.fontBoundingBoxAscent,descent:n.fontBoundingBoxDescent,xHeight:p,capHeight:d}}generateImage(s,n){const d=br(n.right-n.left,n.bottom-n.top),m=d.getContext("2d");return m.font=this.fontString(),m.fillText(s,-n.left,-n.top),d}loadCanvas(){be.canvas||(be.setCanvas(br(10,10)),be.setContext(be.canvas.getContext("2d",{willReadFrequently:!0})))}measureText(s,n){const d=s.measureText(n);if(d!=null&&d.actualBoundingBoxAscent)return d;s.canvas.width=this.size*1.5,s.canvas.height=this.size*1.5;const m=[0,this.size];s.clearRect(0,0,s.canvas.width,s.canvas.height),s.font=this.fontString(),s.fillText(n,m[0],m[1]);const p=s.getImageData(0,0,s.canvas.width,s.canvas.height),{left:v,top:b,right:A,bottom:D}=Jn(p);s.clearRect(0,0,s.canvas.width,s.canvas.height);let O;const K=this.fontBoundingBoxMap.find($=>$.key===this.fontName);if(K)O=K.value;else{s.font=this.fontString(),s.fillText("æµ‹",m[0],m[1]);const $=s.getImageData(0,0,s.canvas.width,s.canvas.height);O=Jn($),this.fontBoundingBoxMap.push({key:this.fontName,value:O}),s.clearRect(0,0,s.canvas.width,s.canvas.height)}return{actualBoundingBoxAscent:m[1]-b,actualBoundingBoxRight:A-m[0],actualBoundingBoxDescent:D-m[1],actualBoundingBoxLeft:m[0]-v,fontBoundingBoxAscent:O.bottom-O.top,fontBoundingBoxDescent:0,width:O.right-O.left}}}class Ot{static create(s){return new Ot(s)}static getLineCap(s){switch(s){case I.TGFXLineCap.Round:return"round";case I.TGFXLineCap.Square:return"square";default:return"butt"}}static getLineJoin(s){switch(s){case I.TGFXLineJoin.Round:return"round";case I.TGFXLineJoin.Bevel:return"bevel";default:return"miter"}}constructor(s){this.canvas=s,this.context=this.canvas.getContext("2d")}updateCanvas(s){this.canvas=s}fillPath(s,n){this.context.setTransform(1,0,0,1,0,0),n===I.TGFXPathFillType.InverseWinding||n===I.TGFXPathFillType.InverseEvenOdd?(this.context.clip(s,n===I.TGFXPathFillType.InverseEvenOdd?"evenodd":"nonzero"),this.context.fillRect(0,0,this.canvas.width,this.canvas.height)):this.context.fill(s,n===I.TGFXPathFillType.EvenOdd?"evenodd":"nonzero")}fillText(s,n,d,m){const p=new be(s.name,s.style,s.size,s.bold,s.italic),v=new Se(m);this.context.setTransform(v.a,v.b,v.c,v.d,v.tx,v.ty),this.context.font=p.fontString();for(let b=0;b<n.size();b++){const A=d.get(b);this.context.fillText(n.get(b),A.x,A.y)}}strokeText(s,n,d,m,p){if(n.width<.5)return;const v=new be(s.name,s.style,s.size,s.bold,s.italic),b=new Se(p);this.context.setTransform(b.a,b.b,b.c,b.d,b.tx,b.ty),this.context.font=v.fontString(),this.context.lineJoin=Ot.getLineJoin(n.join),this.context.miterLimit=n.miterLimit,this.context.lineCap=Ot.getLineCap(n.cap),this.context.lineWidth=n.width;for(let A=0;A<d.size();A++){const D=m.get(A);this.context.strokeText(d.get(A),D.x,D.y)}}clear(){this.context.clearRect(0,0,this.canvas.width,this.canvas.height)}}class Ec{constructor(){this._canvas=null,this._glContext=null,this.width=gr,this.height=gr,this.retainCount=0}retain(){if(this.retainCount===0){try{this._canvas=new OffscreenCanvas(0,0)}catch{this._canvas=document.createElement("canvas")}this._canvas.width=this.width,this._canvas.height=this.height;const s=this._canvas.getContext("webgl",en);if(!s)throw new Error("Canvas context is not WebGL!");this._glContext=Ge.from(s)}this.retainCount+=1}release(){if(this.retainCount-=1,this.retainCount===0){if(!this._glContext)return;this._glContext.destroy(),this._glContext=null,this._canvas=null}}get canvas(){return this._canvas}get glContext(){return this._glContext}setCanvasSize(s=gr,n=gr){this.width=s,this.height=n,this._glContext&&this._canvas&&(this._canvas.width=s,this._canvas.height=n)}}var Cc=Object.defineProperty,Pc=Object.getOwnPropertyDescriptor,Sc=(a,s,n,d)=>{for(var m=d>1?void 0:d?Pc(s,n):s,p=a.length-1,v;p>=0;p--)(v=a[p])&&(m=(d?v(s,n,m):v(m))||m);return d&&m&&Cc(s,n,m),m};let Nt=class extends lt{static make(a,s,n=0,d="",m=""){return typeof s=="string"?new Nt(I._PAGTextLayer._Make(a,s,n,d,m)):new Nt(I._PAGTextLayer._Make(a,s))}fillColor(){return this.wasmIns._fillColor()}setFillColor(a){this.wasmIns._setFillColor(a)}font(){return new Ct(this.wasmIns._font())}setFont(a){this.wasmIns._setFont(a.wasmIns)}fontSize(){return this.wasmIns._fontSize()}setFontSize(a){this.wasmIns._setFontSize(a)}strokeColor(){return this.wasmIns._strokeColor()}setStrokeColor(a){this.wasmIns._setStrokeColor(a)}text(){return this.wasmIns._text()}setText(a){this.wasmIns._setText(a)}reset(){this.wasmIns._reset()}};Nt=Sc([Ie,ke],Nt);var Ic=Object.defineProperty,Ac=Object.getOwnPropertyDescriptor,Tc=(a,s,n,d)=>{for(var m=d>1?void 0:d?Ac(s,n):s,p=a.length-1,v;p>=0;p--)(v=a[p])&&(m=(d?v(s,n,m):v(m))||m);return d&&m&&Ic(s,n,m),m};let Er=class extends lt{static make(a,s,n){const d=I._PAGImageLayer._Make(a,s,n);if(!d)throw new Error("Make PAGImageLayer fail!");return new Er(d)}contentDuration(){return this.wasmIns._contentDuration()}getVideoRanges(){return this.wasmIns._getVideoRanges()}replaceImage(a){this.wasmIns._replaceImage(a.wasmIns)}setImage(a){this.wasmIns._setImage(a.wasmIns)}layerTimeToContent(a){return this.wasmIns._layerTimeToContent(a)}contentTimeToLayer(a){return this.wasmIns._contentTimeToLayer(a)}imageBytes(){return this.wasmIns._imageBytes()}};Er=Tc([Ie,ke],Er);var kc=Object.defineProperty,Dc=Object.getOwnPropertyDescriptor,Fc=(a,s,n,d)=>{for(var m=d>1?void 0:d?Dc(s,n):s,p=a.length-1,v;p>=0;p--)(v=a[p])&&(m=(d?v(s,n,m):v(m))||m);return d&&m&&kc(s,n,m),m};let Cr=class extends lt{static make(a,s,n,d,m){const p=I._PAGSolidLayer._Make(a,s,n,d,m);if(!p)throw new Error("Make PAGSolidLayer fail!");return new Cr(p)}solidColor(){return this.wasmIns._solidColor()}setSolidColor(a){this.wasmIns._setSolidColor(a)}};Cr=Fc([Ie,ke],Cr);const vi=a=>new Promise(s=>{const n=new Image;n.onload=function(){s(n)},n.onerror=function(){console.error("image create from bytes error."),s(null)},n.src=a}),Rc=a=>{const s=new Blob([a],{type:"image/*"});return vi(URL.createObjectURL(s))},Lc=(a,s,n,d)=>{if(!s)return null;const m=br(n,d),p=m.getContext("2d");if(!p)return null;p.drawImage(s,0,0,n,d);const{data:v}=p.getImageData(0,0,n,d);return ci(m),v.length===0?null:Pr(a,v)},jc=()=>{try{return document.createElement("canvas").toDataURL("image/webp",.5).indexOf("data:image/webp")===0}catch{return!1}},Gc=a=>Oe(a,globalThis.HTMLVideoElement)?{width:a.videoWidth,height:a.videoHeight}:{width:a.width,height:a.height},Oc=(a,s,n,d)=>{var m;let p=s instanceof pi?s.bitmap:s;if(!p)return;const v=(m=a.currentContext)==null?void 0:m.GLctx;v.bindTexture(v.TEXTURE_2D,a.textures[n]),d?(v.pixelStorei(v.UNPACK_ALIGNMENT,1),v.texSubImage2D(v.TEXTURE_2D,0,0,0,v.ALPHA,v.UNSIGNED_BYTE,p)):(v.pixelStorei(v.UNPACK_ALIGNMENT,4),v.pixelStorei(v.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),v.texSubImage2D(v.TEXTURE_2D,0,0,0,v.RGBA,v.UNSIGNED_BYTE,p),v.pixelStorei(v.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1))},Mc=()=>{if(typeof wx<"u"&&wx.getSystemInfoSync)return wx.getSystemInfoSync().platform==="android"},Bc=a=>{Oe(a,globalThis.ImageBitmap)?a.close():Xu(a)&&ci(a)},Nc=async(a,s)=>{const n=await fetch(s).then(d=>d.arrayBuffer());return Pr(a,n)};var $c=Object.freeze({__proto__:null,createImage:vi,createImageFromBytes:Rc,readImagePixels:Lc,hasWebpSupport:jc,getSourceSize:Gc,uploadToTexture:Oc,isAndroidMiniprogram:Mc,releaseNativeImage:Bc,getBytesFromPath:Nc,createCanvas2D:br});const Vc=a=>{a.traceImage=function(s,n){const d=document.createElement("canvas");d.width=s.width,d.height=s.height;const m=d.getContext("2d"),p=new ImageData(new Uint8ClampedArray(n),d.width,d.height);m.putImageData(p,0,0),document.body.appendChild(d)},a.registerSoftwareDecoderFactory=function(s=null){a._registerSoftwareDecoderFactory(s)},a.SDKVersion=function(){return a._SDKVersion()},a.isIPhone=()=>rn};var Uc=Object.defineProperty,Yn=Object.getOwnPropertySymbols,Hc=Object.prototype.hasOwnProperty,zc=Object.prototype.propertyIsEnumerable,Qn=(a,s,n)=>s in a?Uc(a,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):a[s]=n,Wc=(a,s)=>{for(var n in s||(s={}))Hc.call(s,n)&&Qn(a,n,s[n]);if(Yn)for(var n of Yn(s))zc.call(s,n)&&Qn(a,n,s[n]);return a};const qc=a=>{wu(a),a.module=a,a.PAGFile=Ye,a.PAGPlayer=Et,a.PAGView=Bt,a.PAGFont=Ct,a.PAGImage=Je,a.PAGLayer=lt,a.PAGComposition=ut,a.PAGSurface=Qe,a.PAGTextLayer=Nt,a.PAGImageLayer=Er,a.PAGSolidLayer=Cr,a.VideoReader=nn,a.ScalerContext=be,a.WebMask=Ot,a.GlobalCanvas=Ec,a.BackendContext=Ge,a.Matrix=Se,a.RenderCanvas=Sr,Vc(a),a.tgfx=Wc({},$c)};var Kc=(()=>{var a=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return function(s){s=s||{};var n=typeof s<"u"?s:{},d,m;n.ready=new Promise(function(e,t){d=e,m=t});var p=Object.assign({},n),v=(e,t)=>{throw t},b=typeof window=="object",A=typeof importScripts=="function";typeof qr=="object"&&typeof qr.versions=="object"&&qr.versions.node;var D="";function O(e){return n.locateFile?n.locateFile(e,D):D+e}var K,$,Me;(b||A)&&(A?D=self.location.href:typeof document<"u"&&document.currentScript&&(D=document.currentScript.src),a&&(D=a),D.indexOf("blob:")!==0?D=D.substr(0,D.replace(/[?#].*/,"").lastIndexOf("/")+1):D="",K=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},A&&(Me=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),$=(e,t,r)=>{var i=new XMLHttpRequest;i.open("GET",e,!0),i.responseType="arraybuffer",i.onload=()=>{if(i.status==200||i.status==0&&i.response){t(i.response);return}r()},i.onerror=r,i.send(null)});var V=n.print||console.log.bind(console),fe=n.printErr||console.warn.bind(console);Object.assign(n,p),p=null,n.arguments&&n.arguments,n.thisProgram&&n.thisProgram,n.quit&&(v=n.quit);var pe=4,De;n.wasmBinary&&(De=n.wasmBinary),n.noExitRuntime,typeof WebAssembly!="object"&&xe("no native wasm support detected");var We,me=!1,ct;function re(e,t){e||xe(t)}var de=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function ve(e,t,r){for(var i=t+r,o=t;e[o]&&!(o>=i);)++o;if(o-t>16&&e.buffer&&de)return de.decode(e.subarray(t,o));for(var u="";t<o;){var c=e[t++];if(!(c&128)){u+=String.fromCharCode(c);continue}var f=e[t++]&63;if((c&224)==192){u+=String.fromCharCode((c&31)<<6|f);continue}var h=e[t++]&63;if((c&240)==224?c=(c&15)<<12|f<<6|h:c=(c&7)<<18|f<<12|h<<6|e[t++]&63,c<65536)u+=String.fromCharCode(c);else{var _=c-65536;u+=String.fromCharCode(55296|_>>10,56320|_&1023)}}return u}function he(e,t){return e?ve(ie,e,t):""}function ft(e,t,r,i){if(!(i>0))return 0;for(var o=r,u=r+i-1,c=0;c<e.length;++c){var f=e.charCodeAt(c);if(f>=55296&&f<=57343){var h=e.charCodeAt(++c);f=65536+((f&1023)<<10)|h&1023}if(f<=127){if(r>=u)break;t[r++]=f}else if(f<=2047){if(r+1>=u)break;t[r++]=192|f>>6,t[r++]=128|f&63}else if(f<=65535){if(r+2>=u)break;t[r++]=224|f>>12,t[r++]=128|f>>6&63,t[r++]=128|f&63}else{if(r+3>=u)break;t[r++]=240|f>>18,t[r++]=128|f>>12&63,t[r++]=128|f>>6&63,t[r++]=128|f&63}}return t[r]=0,r-o}function dt(e,t,r){return ft(e,ie,t,r)}function Ze(e){for(var t=0,r=0;r<e.length;++r){var i=e.charCodeAt(r);i<=127?t++:i<=2047?t+=2:i>=55296&&i<=57343?(t+=4,++r):t+=3}return t}var et,oe,ie,Ae,qe,w,M,R,Ir;function mt(e){et=e,n.HEAP8=oe=new Int8Array(e),n.HEAP16=Ae=new Int16Array(e),n.HEAP32=w=new Int32Array(e),n.HEAPU8=ie=new Uint8Array(e),n.HEAPU16=qe=new Uint16Array(e),n.HEAPU32=M=new Uint32Array(e),n.HEAPF32=R=new Float32Array(e),n.HEAPF64=Ir=new Float64Array(e)}n.INITIAL_MEMORY;var tt=[],zt=[],rt=[];function Ar(){if(n.preRun)for(typeof n.preRun=="function"&&(n.preRun=[n.preRun]);n.preRun.length;)Kt(n.preRun.shift());ae(tt)}function Wt(){!n.noFSInit&&!l.init.initialized&&l.init(),l.ignorePermissions=!1,ae(zt)}function qt(){if(n.postRun)for(typeof n.postRun=="function"&&(n.postRun=[n.postRun]);n.postRun.length;)kr(n.postRun.shift());ae(rt)}function Kt(e){tt.unshift(e)}function Tr(e){zt.unshift(e)}function kr(e){rt.unshift(e)}var Fe=0,nt=null;function an(e){return e}function Pt(e){Fe++,n.monitorRunDependencies&&n.monitorRunDependencies(Fe)}function ht(e){if(Fe--,n.monitorRunDependencies&&n.monitorRunDependencies(Fe),Fe==0&&nt){var t=nt;nt=null,t()}}function xe(e){n.onAbort&&n.onAbort(e),e="Aborted("+e+")",fe(e),me=!0,ct=1,e+=". Build with -sASSERTIONS for more info.";var t=new WebAssembly.RuntimeError(e);throw m(t),t}var Dr="data:application/octet-stream;base64,";function Xt(e){return e.startsWith(Dr)}var ge;ge="libpag.wasm",Xt(ge)||(ge=O(ge));function St(e){try{if(e==ge&&De)return new Uint8Array(De);if(Me)return Me(e);throw"both async and sync fetching of the wasm failed"}catch(t){xe(t)}}function Fr(){return!De&&(b||A)&&typeof fetch=="function"?fetch(ge,{credentials:"same-origin"}).then(function(e){if(!e.ok)throw"failed to load wasm binary file at '"+ge+"'";return e.arrayBuffer()}).catch(function(){return St(ge)}):Promise.resolve().then(function(){return St(ge)})}function L(){var e={a:Nl};function t(c,f){var h=c.exports;h=F.instrumentWasmExports(h),n.asm=h,We=n.asm.hc,mt(We.buffer),n.asm.jc,Tr(n.asm.ic),ht()}Pt();function r(c){t(c.instance)}function i(c){return Fr().then(function(f){return WebAssembly.instantiate(f,e)}).then(function(f){return f}).then(c,function(f){fe("failed to asynchronously prepare wasm: "+f),xe(f)})}function o(){return!De&&typeof WebAssembly.instantiateStreaming=="function"&&!Xt(ge)&&typeof fetch=="function"?fetch(ge,{credentials:"same-origin"}).then(function(c){var f=WebAssembly.instantiateStreaming(c,e);return f.then(r,function(h){return fe("wasm streaming compile failed: "+h),fe("falling back to ArrayBuffer instantiation"),i(r)})}):i(r)}if(n.instantiateWasm)try{var u=n.instantiateWasm(e,t);return u=F.instrumentWasmExports(u),u}catch(c){return fe("Module.instantiateWasm callback failed with error: "+c),!1}return o().catch(m),{}}var T,j;function U(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}function ae(e){for(;e.length>0;)e.shift()(n)}function Z(e){if(e instanceof U||e=="unwind")return ct;v(1,e)}function le(e,t,r,i){xe("Assertion failed: "+he(e)+", at: "+[t?he(t):"unknown filename",r,i?he(i):"unknown function"])}function _e(e){return _t(e+24)+24}function it(e){this.excPtr=e,this.ptr=e-24,this.set_type=function(t){M[this.ptr+4>>2]=t},this.get_type=function(){return M[this.ptr+4>>2]},this.set_destructor=function(t){M[this.ptr+8>>2]=t},this.get_destructor=function(){return M[this.ptr+8>>2]},this.set_refcount=function(t){w[this.ptr>>2]=t},this.set_caught=function(t){t=t?1:0,oe[this.ptr+12>>0]=t},this.get_caught=function(){return oe[this.ptr+12>>0]!=0},this.set_rethrown=function(t){t=t?1:0,oe[this.ptr+13>>0]=t},this.get_rethrown=function(){return oe[this.ptr+13>>0]!=0},this.init=function(t,r){this.set_adjusted_ptr(0),this.set_type(t),this.set_destructor(r),this.set_refcount(0),this.set_caught(!1),this.set_rethrown(!1)},this.add_ref=function(){var t=w[this.ptr>>2];w[this.ptr>>2]=t+1},this.release_ref=function(){var t=w[this.ptr>>2];return w[this.ptr>>2]=t-1,t===1},this.set_adjusted_ptr=function(t){M[this.ptr+16>>2]=t},this.get_adjusted_ptr=function(){return M[this.ptr+16>>2]},this.get_exception_ptr=function(){var t=Tn(this.get_type());if(t)return M[this.excPtr>>2];var r=this.get_adjusted_ptr();return r!==0?r:this.excPtr}}function sn(e,t,r){var i=new it(e);throw i.init(t,r),e}function Rr(e){return w[An()>>2]=e,e}var H={isAbs:e=>e.charAt(0)==="/",splitPath:e=>{var t=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/;return t.exec(e).slice(1)},normalizeArray:(e,t)=>{for(var r=0,i=e.length-1;i>=0;i--){var o=e[i];o==="."?e.splice(i,1):o===".."?(e.splice(i,1),r++):r&&(e.splice(i,1),r--)}if(t)for(;r;r--)e.unshift("..");return e},normalize:e=>{var t=H.isAbs(e),r=e.substr(-1)==="/";return e=H.normalizeArray(e.split("/").filter(i=>!!i),!t).join("/"),!e&&!t&&(e="."),e&&r&&(e+="/"),(t?"/":"")+e},dirname:e=>{var t=H.splitPath(e),r=t[0],i=t[1];return!r&&!i?".":(i&&(i=i.substr(0,i.length-1)),r+i)},basename:e=>{if(e==="/")return"/";e=H.normalize(e),e=e.replace(/\/$/,"");var t=e.lastIndexOf("/");return t===-1?e:e.substr(t+1)},join:function(){var e=Array.prototype.slice.call(arguments);return H.normalize(e.join("/"))},join2:(e,t)=>H.normalize(e+"/"+t)};function Jt(){if(typeof crypto=="object"&&typeof crypto.getRandomValues=="function"){var e=new Uint8Array(1);return()=>(crypto.getRandomValues(e),e[0])}else return()=>xe("randomDevice")}var Ee={resolve:function(){for(var e="",t=!1,r=arguments.length-1;r>=-1&&!t;r--){var i=r>=0?arguments[r]:l.cwd();if(typeof i!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!i)return"";e=i+"/"+e,t=H.isAbs(i)}return e=H.normalizeArray(e.split("/").filter(o=>!!o),!t).join("/"),(t?"/":"")+e||"."},relative:(e,t)=>{e=Ee.resolve(e).substr(1),t=Ee.resolve(t).substr(1);function r(_){for(var x=0;x<_.length&&_[x]==="";x++);for(var C=_.length-1;C>=0&&_[C]==="";C--);return x>C?[]:_.slice(x,C-x+1)}for(var i=r(e.split("/")),o=r(t.split("/")),u=Math.min(i.length,o.length),c=u,f=0;f<u;f++)if(i[f]!==o[f]){c=f;break}for(var h=[],f=c;f<i.length;f++)h.push("..");return h=h.concat(o.slice(c)),h.join("/")}};function It(e,t,r){var i=Ze(e)+1,o=new Array(i),u=ft(e,o,0,o.length);return o.length=u,o}var Be={ttys:[],init:function(){},shutdown:function(){},register:function(e,t){Be.ttys[e]={input:[],output:[],ops:t},l.registerDevice(e,Be.stream_ops)},stream_ops:{open:function(e){var t=Be.ttys[e.node.rdev];if(!t)throw new l.ErrnoError(43);e.tty=t,e.seekable=!1},close:function(e){e.tty.ops.fsync(e.tty)},fsync:function(e){e.tty.ops.fsync(e.tty)},read:function(e,t,r,i,o){if(!e.tty||!e.tty.ops.get_char)throw new l.ErrnoError(60);for(var u=0,c=0;c<i;c++){var f;try{f=e.tty.ops.get_char(e.tty)}catch{throw new l.ErrnoError(29)}if(f===void 0&&u===0)throw new l.ErrnoError(6);if(f==null)break;u++,t[r+c]=f}return u&&(e.node.timestamp=Date.now()),u},write:function(e,t,r,i,o){if(!e.tty||!e.tty.ops.put_char)throw new l.ErrnoError(60);try{for(var u=0;u<i;u++)e.tty.ops.put_char(e.tty,t[r+u])}catch{throw new l.ErrnoError(29)}return i&&(e.node.timestamp=Date.now()),u}},default_tty_ops:{get_char:function(e){if(!e.input.length){var t=null;if(typeof window<"u"&&typeof window.prompt=="function"?(t=window.prompt("Input: "),t!==null&&(t+=`
`)):typeof readline=="function"&&(t=readline(),t!==null&&(t+=`
`)),!t)return null;e.input=It(t)}return e.input.shift()},put_char:function(e,t){t===null||t===10?(V(ve(e.output,0)),e.output=[]):t!=0&&e.output.push(t)},fsync:function(e){e.output&&e.output.length>0&&(V(ve(e.output,0)),e.output=[])}},default_tty1_ops:{put_char:function(e,t){t===null||t===10?(fe(ve(e.output,0)),e.output=[]):t!=0&&e.output.push(t)},fsync:function(e){e.output&&e.output.length>0&&(fe(ve(e.output,0)),e.output=[])}}};function Yt(e){xe()}var G={ops_table:null,mount:function(e){return G.createNode(null,"/",16895,0)},createNode:function(e,t,r,i){if(l.isBlkdev(r)||l.isFIFO(r))throw new l.ErrnoError(63);G.ops_table||(G.ops_table={dir:{node:{getattr:G.node_ops.getattr,setattr:G.node_ops.setattr,lookup:G.node_ops.lookup,mknod:G.node_ops.mknod,rename:G.node_ops.rename,unlink:G.node_ops.unlink,rmdir:G.node_ops.rmdir,readdir:G.node_ops.readdir,symlink:G.node_ops.symlink},stream:{llseek:G.stream_ops.llseek}},file:{node:{getattr:G.node_ops.getattr,setattr:G.node_ops.setattr},stream:{llseek:G.stream_ops.llseek,read:G.stream_ops.read,write:G.stream_ops.write,allocate:G.stream_ops.allocate,mmap:G.stream_ops.mmap,msync:G.stream_ops.msync}},link:{node:{getattr:G.node_ops.getattr,setattr:G.node_ops.setattr,readlink:G.node_ops.readlink},stream:{}},chrdev:{node:{getattr:G.node_ops.getattr,setattr:G.node_ops.setattr},stream:l.chrdev_stream_ops}});var o=l.createNode(e,t,r,i);return l.isDir(o.mode)?(o.node_ops=G.ops_table.dir.node,o.stream_ops=G.ops_table.dir.stream,o.contents={}):l.isFile(o.mode)?(o.node_ops=G.ops_table.file.node,o.stream_ops=G.ops_table.file.stream,o.usedBytes=0,o.contents=null):l.isLink(o.mode)?(o.node_ops=G.ops_table.link.node,o.stream_ops=G.ops_table.link.stream):l.isChrdev(o.mode)&&(o.node_ops=G.ops_table.chrdev.node,o.stream_ops=G.ops_table.chrdev.stream),o.timestamp=Date.now(),e&&(e.contents[t]=o,e.timestamp=o.timestamp),o},getFileDataAsTypedArray:function(e){return e.contents?e.contents.subarray?e.contents.subarray(0,e.usedBytes):new Uint8Array(e.contents):new Uint8Array(0)},expandFileStorage:function(e,t){var r=e.contents?e.contents.length:0;if(!(r>=t)){var i=1024*1024;t=Math.max(t,r*(r<i?2:1.125)>>>0),r!=0&&(t=Math.max(t,256));var o=e.contents;e.contents=new Uint8Array(t),e.usedBytes>0&&e.contents.set(o.subarray(0,e.usedBytes),0)}},resizeFileStorage:function(e,t){if(e.usedBytes!=t)if(t==0)e.contents=null,e.usedBytes=0;else{var r=e.contents;e.contents=new Uint8Array(t),r&&e.contents.set(r.subarray(0,Math.min(t,e.usedBytes))),e.usedBytes=t}},node_ops:{getattr:function(e){var t={};return t.dev=l.isChrdev(e.mode)?e.id:1,t.ino=e.id,t.mode=e.mode,t.nlink=1,t.uid=0,t.gid=0,t.rdev=e.rdev,l.isDir(e.mode)?t.size=4096:l.isFile(e.mode)?t.size=e.usedBytes:l.isLink(e.mode)?t.size=e.link.length:t.size=0,t.atime=new Date(e.timestamp),t.mtime=new Date(e.timestamp),t.ctime=new Date(e.timestamp),t.blksize=4096,t.blocks=Math.ceil(t.size/t.blksize),t},setattr:function(e,t){t.mode!==void 0&&(e.mode=t.mode),t.timestamp!==void 0&&(e.timestamp=t.timestamp),t.size!==void 0&&G.resizeFileStorage(e,t.size)},lookup:function(e,t){throw l.genericErrors[44]},mknod:function(e,t,r,i){return G.createNode(e,t,r,i)},rename:function(e,t,r){if(l.isDir(e.mode)){var i;try{i=l.lookupNode(t,r)}catch{}if(i)for(var o in i.contents)throw new l.ErrnoError(55)}delete e.parent.contents[e.name],e.parent.timestamp=Date.now(),e.name=r,t.contents[r]=e,t.timestamp=e.parent.timestamp,e.parent=t},unlink:function(e,t){delete e.contents[t],e.timestamp=Date.now()},rmdir:function(e,t){var r=l.lookupNode(e,t);for(var i in r.contents)throw new l.ErrnoError(55);delete e.contents[t],e.timestamp=Date.now()},readdir:function(e){var t=[".",".."];for(var r in e.contents)e.contents.hasOwnProperty(r)&&t.push(r);return t},symlink:function(e,t,r){var i=G.createNode(e,t,41471,0);return i.link=r,i},readlink:function(e){if(!l.isLink(e.mode))throw new l.ErrnoError(28);return e.link}},stream_ops:{read:function(e,t,r,i,o){var u=e.node.contents;if(o>=e.node.usedBytes)return 0;var c=Math.min(e.node.usedBytes-o,i);if(c>8&&u.subarray)t.set(u.subarray(o,o+c),r);else for(var f=0;f<c;f++)t[r+f]=u[o+f];return c},write:function(e,t,r,i,o,u){if(t.buffer===oe.buffer&&(u=!1),!i)return 0;var c=e.node;if(c.timestamp=Date.now(),t.subarray&&(!c.contents||c.contents.subarray)){if(u)return c.contents=t.subarray(r,r+i),c.usedBytes=i,i;if(c.usedBytes===0&&o===0)return c.contents=t.slice(r,r+i),c.usedBytes=i,i;if(o+i<=c.usedBytes)return c.contents.set(t.subarray(r,r+i),o),i}if(G.expandFileStorage(c,o+i),c.contents.subarray&&t.subarray)c.contents.set(t.subarray(r,r+i),o);else for(var f=0;f<i;f++)c.contents[o+f]=t[r+f];return c.usedBytes=Math.max(c.usedBytes,o+i),i},llseek:function(e,t,r){var i=t;if(r===1?i+=e.position:r===2&&l.isFile(e.node.mode)&&(i+=e.node.usedBytes),i<0)throw new l.ErrnoError(28);return i},allocate:function(e,t,r){G.expandFileStorage(e.node,t+r),e.node.usedBytes=Math.max(e.node.usedBytes,t+r)},mmap:function(e,t,r,i,o){if(!l.isFile(e.node.mode))throw new l.ErrnoError(43);var u,c,f=e.node.contents;if(!(o&2)&&f.buffer===et)c=!1,u=f.byteOffset;else{if((r>0||r+t<f.length)&&(f.subarray?f=f.subarray(r,r+t):f=Array.prototype.slice.call(f,r,r+t)),c=!0,u=Yt(),!u)throw new l.ErrnoError(48);oe.set(f,u)}return{ptr:u,allocated:c}},msync:function(e,t,r,i,o){if(!l.isFile(e.node.mode))throw new l.ErrnoError(43);return o&2||G.stream_ops.write(e,t,0,i,r,!1),0}}};function Lr(e,t,r,i){var o="al "+e;$(e,u=>{re(u,'Loading data file "'+e+'" failed (no arrayBuffer).'),t(new Uint8Array(u)),o&&ht()},u=>{if(r)r();else throw'Loading data file "'+e+'" failed.'}),o&&Pt()}var l={root:null,mounts:[],devices:{},streams:[],nextInode:1,nameTable:null,currentPath:"/",initialized:!1,ignorePermissions:!0,ErrnoError:null,genericErrors:{},filesystems:null,syncFSRequests:0,lookupPath:(e,t={})=>{if(e=Ee.resolve(l.cwd(),e),!e)return{path:"",node:null};var r={follow_mount:!0,recurse_count:0};if(t=Object.assign(r,t),t.recurse_count>8)throw new l.ErrnoError(32);for(var i=H.normalizeArray(e.split("/").filter(C=>!!C),!1),o=l.root,u="/",c=0;c<i.length;c++){var f=c===i.length-1;if(f&&t.parent)break;if(o=l.lookupNode(o,i[c]),u=H.join2(u,i[c]),l.isMountpoint(o)&&(!f||f&&t.follow_mount)&&(o=o.mounted.root),!f||t.follow)for(var h=0;l.isLink(o.mode);){var _=l.readlink(u);u=Ee.resolve(H.dirname(u),_);var x=l.lookupPath(u,{recurse_count:t.recurse_count+1});if(o=x.node,h++>40)throw new l.ErrnoError(32)}}return{path:u,node:o}},getPath:e=>{for(var t;;){if(l.isRoot(e)){var r=e.mount.mountpoint;return t?r[r.length-1]!=="/"?r+"/"+t:r+t:r}t=t?e.name+"/"+t:e.name,e=e.parent}},hashName:(e,t)=>{for(var r=0,i=0;i<t.length;i++)r=(r<<5)-r+t.charCodeAt(i)|0;return(e+r>>>0)%l.nameTable.length},hashAddNode:e=>{var t=l.hashName(e.parent.id,e.name);e.name_next=l.nameTable[t],l.nameTable[t]=e},hashRemoveNode:e=>{var t=l.hashName(e.parent.id,e.name);if(l.nameTable[t]===e)l.nameTable[t]=e.name_next;else for(var r=l.nameTable[t];r;){if(r.name_next===e){r.name_next=e.name_next;break}r=r.name_next}},lookupNode:(e,t)=>{var r=l.mayLookup(e);if(r)throw new l.ErrnoError(r,e);for(var i=l.hashName(e.id,t),o=l.nameTable[i];o;o=o.name_next){var u=o.name;if(o.parent.id===e.id&&u===t)return o}return l.lookup(e,t)},createNode:(e,t,r,i)=>{var o=new l.FSNode(e,t,r,i);return l.hashAddNode(o),o},destroyNode:e=>{l.hashRemoveNode(e)},isRoot:e=>e===e.parent,isMountpoint:e=>!!e.mounted,isFile:e=>(e&61440)===32768,isDir:e=>(e&61440)===16384,isLink:e=>(e&61440)===40960,isChrdev:e=>(e&61440)===8192,isBlkdev:e=>(e&61440)===24576,isFIFO:e=>(e&61440)===4096,isSocket:e=>(e&49152)===49152,flagModes:{r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090},modeStringToFlags:e=>{var t=l.flagModes[e];if(typeof t>"u")throw new Error("Unknown file open mode: "+e);return t},flagsToPermissionString:e=>{var t=["r","w","rw"][e&3];return e&512&&(t+="w"),t},nodePermissions:(e,t)=>l.ignorePermissions?0:t.includes("r")&&!(e.mode&292)||t.includes("w")&&!(e.mode&146)||t.includes("x")&&!(e.mode&73)?2:0,mayLookup:e=>{var t=l.nodePermissions(e,"x");return t||(e.node_ops.lookup?0:2)},mayCreate:(e,t)=>{try{var r=l.lookupNode(e,t);return 20}catch{}return l.nodePermissions(e,"wx")},mayDelete:(e,t,r)=>{var i;try{i=l.lookupNode(e,t)}catch(u){return u.errno}var o=l.nodePermissions(e,"wx");if(o)return o;if(r){if(!l.isDir(i.mode))return 54;if(l.isRoot(i)||l.getPath(i)===l.cwd())return 10}else if(l.isDir(i.mode))return 31;return 0},mayOpen:(e,t)=>e?l.isLink(e.mode)?32:l.isDir(e.mode)&&(l.flagsToPermissionString(t)!=="r"||t&512)?31:l.nodePermissions(e,l.flagsToPermissionString(t)):44,MAX_OPEN_FDS:4096,nextfd:(e=0,t=l.MAX_OPEN_FDS)=>{for(var r=e;r<=t;r++)if(!l.streams[r])return r;throw new l.ErrnoError(33)},getStream:e=>l.streams[e],createStream:(e,t,r)=>{l.FSStream||(l.FSStream=function(){this.shared={}},l.FSStream.prototype={},Object.defineProperties(l.FSStream.prototype,{object:{get:function(){return this.node},set:function(o){this.node=o}},isRead:{get:function(){return(this.flags&2097155)!==1}},isWrite:{get:function(){return(this.flags&2097155)!==0}},isAppend:{get:function(){return this.flags&1024}},flags:{get:function(){return this.shared.flags},set:function(o){this.shared.flags=o}},position:{get:function(){return this.shared.position},set:function(o){this.shared.position=o}}})),e=Object.assign(new l.FSStream,e);var i=l.nextfd(t,r);return e.fd=i,l.streams[i]=e,e},closeStream:e=>{l.streams[e]=null},chrdev_stream_ops:{open:e=>{var t=l.getDevice(e.node.rdev);e.stream_ops=t.stream_ops,e.stream_ops.open&&e.stream_ops.open(e)},llseek:()=>{throw new l.ErrnoError(70)}},major:e=>e>>8,minor:e=>e&255,makedev:(e,t)=>e<<8|t,registerDevice:(e,t)=>{l.devices[e]={stream_ops:t}},getDevice:e=>l.devices[e],getMounts:e=>{for(var t=[],r=[e];r.length;){var i=r.pop();t.push(i),r.push.apply(r,i.mounts)}return t},syncfs:(e,t)=>{typeof e=="function"&&(t=e,e=!1),l.syncFSRequests++,l.syncFSRequests>1&&fe("warning: "+l.syncFSRequests+" FS.syncfs operations in flight at once, probably just doing extra work");var r=l.getMounts(l.root.mount),i=0;function o(c){return l.syncFSRequests--,t(c)}function u(c){if(c)return u.errored?void 0:(u.errored=!0,o(c));++i>=r.length&&o(null)}r.forEach(c=>{if(!c.type.syncfs)return u(null);c.type.syncfs(c,e,u)})},mount:(e,t,r)=>{var i=r==="/",o=!r,u;if(i&&l.root)throw new l.ErrnoError(10);if(!i&&!o){var c=l.lookupPath(r,{follow_mount:!1});if(r=c.path,u=c.node,l.isMountpoint(u))throw new l.ErrnoError(10);if(!l.isDir(u.mode))throw new l.ErrnoError(54)}var f={type:e,opts:t,mountpoint:r,mounts:[]},h=e.mount(f);return h.mount=f,f.root=h,i?l.root=h:u&&(u.mounted=f,u.mount&&u.mount.mounts.push(f)),h},unmount:e=>{var t=l.lookupPath(e,{follow_mount:!1});if(!l.isMountpoint(t.node))throw new l.ErrnoError(28);var r=t.node,i=r.mounted,o=l.getMounts(i);Object.keys(l.nameTable).forEach(c=>{for(var f=l.nameTable[c];f;){var h=f.name_next;o.includes(f.mount)&&l.destroyNode(f),f=h}}),r.mounted=null;var u=r.mount.mounts.indexOf(i);r.mount.mounts.splice(u,1)},lookup:(e,t)=>e.node_ops.lookup(e,t),mknod:(e,t,r)=>{var i=l.lookupPath(e,{parent:!0}),o=i.node,u=H.basename(e);if(!u||u==="."||u==="..")throw new l.ErrnoError(28);var c=l.mayCreate(o,u);if(c)throw new l.ErrnoError(c);if(!o.node_ops.mknod)throw new l.ErrnoError(63);return o.node_ops.mknod(o,u,t,r)},create:(e,t)=>(t=t!==void 0?t:438,t&=4095,t|=32768,l.mknod(e,t,0)),mkdir:(e,t)=>(t=t!==void 0?t:511,t&=1023,t|=16384,l.mknod(e,t,0)),mkdirTree:(e,t)=>{for(var r=e.split("/"),i="",o=0;o<r.length;++o)if(r[o]){i+="/"+r[o];try{l.mkdir(i,t)}catch(u){if(u.errno!=20)throw u}}},mkdev:(e,t,r)=>(typeof r>"u"&&(r=t,t=438),t|=8192,l.mknod(e,t,r)),symlink:(e,t)=>{if(!Ee.resolve(e))throw new l.ErrnoError(44);var r=l.lookupPath(t,{parent:!0}),i=r.node;if(!i)throw new l.ErrnoError(44);var o=H.basename(t),u=l.mayCreate(i,o);if(u)throw new l.ErrnoError(u);if(!i.node_ops.symlink)throw new l.ErrnoError(63);return i.node_ops.symlink(i,o,e)},rename:(e,t)=>{var r=H.dirname(e),i=H.dirname(t),o=H.basename(e),u=H.basename(t),c,f,h;if(c=l.lookupPath(e,{parent:!0}),f=c.node,c=l.lookupPath(t,{parent:!0}),h=c.node,!f||!h)throw new l.ErrnoError(44);if(f.mount!==h.mount)throw new l.ErrnoError(75);var _=l.lookupNode(f,o),x=Ee.relative(e,i);if(x.charAt(0)!==".")throw new l.ErrnoError(28);if(x=Ee.relative(t,r),x.charAt(0)!==".")throw new l.ErrnoError(55);var C;try{C=l.lookupNode(h,u)}catch{}if(_!==C){var E=l.isDir(_.mode),S=l.mayDelete(f,o,E);if(S)throw new l.ErrnoError(S);if(S=C?l.mayDelete(h,u,E):l.mayCreate(h,u),S)throw new l.ErrnoError(S);if(!f.node_ops.rename)throw new l.ErrnoError(63);if(l.isMountpoint(_)||C&&l.isMountpoint(C))throw new l.ErrnoError(10);if(h!==f&&(S=l.nodePermissions(f,"w"),S))throw new l.ErrnoError(S);l.hashRemoveNode(_);try{f.node_ops.rename(_,h,u)}catch(k){throw k}finally{l.hashAddNode(_)}}},rmdir:e=>{var t=l.lookupPath(e,{parent:!0}),r=t.node,i=H.basename(e),o=l.lookupNode(r,i),u=l.mayDelete(r,i,!0);if(u)throw new l.ErrnoError(u);if(!r.node_ops.rmdir)throw new l.ErrnoError(63);if(l.isMountpoint(o))throw new l.ErrnoError(10);r.node_ops.rmdir(r,i),l.destroyNode(o)},readdir:e=>{var t=l.lookupPath(e,{follow:!0}),r=t.node;if(!r.node_ops.readdir)throw new l.ErrnoError(54);return r.node_ops.readdir(r)},unlink:e=>{var t=l.lookupPath(e,{parent:!0}),r=t.node;if(!r)throw new l.ErrnoError(44);var i=H.basename(e),o=l.lookupNode(r,i),u=l.mayDelete(r,i,!1);if(u)throw new l.ErrnoError(u);if(!r.node_ops.unlink)throw new l.ErrnoError(63);if(l.isMountpoint(o))throw new l.ErrnoError(10);r.node_ops.unlink(r,i),l.destroyNode(o)},readlink:e=>{var t=l.lookupPath(e),r=t.node;if(!r)throw new l.ErrnoError(44);if(!r.node_ops.readlink)throw new l.ErrnoError(28);return Ee.resolve(l.getPath(r.parent),r.node_ops.readlink(r))},stat:(e,t)=>{var r=l.lookupPath(e,{follow:!t}),i=r.node;if(!i)throw new l.ErrnoError(44);if(!i.node_ops.getattr)throw new l.ErrnoError(63);return i.node_ops.getattr(i)},lstat:e=>l.stat(e,!0),chmod:(e,t,r)=>{var i;if(typeof e=="string"){var o=l.lookupPath(e,{follow:!r});i=o.node}else i=e;if(!i.node_ops.setattr)throw new l.ErrnoError(63);i.node_ops.setattr(i,{mode:t&4095|i.mode&-4096,timestamp:Date.now()})},lchmod:(e,t)=>{l.chmod(e,t,!0)},fchmod:(e,t)=>{var r=l.getStream(e);if(!r)throw new l.ErrnoError(8);l.chmod(r.node,t)},chown:(e,t,r,i)=>{var o;if(typeof e=="string"){var u=l.lookupPath(e,{follow:!i});o=u.node}else o=e;if(!o.node_ops.setattr)throw new l.ErrnoError(63);o.node_ops.setattr(o,{timestamp:Date.now()})},lchown:(e,t,r)=>{l.chown(e,t,r,!0)},fchown:(e,t,r)=>{var i=l.getStream(e);if(!i)throw new l.ErrnoError(8);l.chown(i.node,t,r)},truncate:(e,t)=>{if(t<0)throw new l.ErrnoError(28);var r;if(typeof e=="string"){var i=l.lookupPath(e,{follow:!0});r=i.node}else r=e;if(!r.node_ops.setattr)throw new l.ErrnoError(63);if(l.isDir(r.mode))throw new l.ErrnoError(31);if(!l.isFile(r.mode))throw new l.ErrnoError(28);var o=l.nodePermissions(r,"w");if(o)throw new l.ErrnoError(o);r.node_ops.setattr(r,{size:t,timestamp:Date.now()})},ftruncate:(e,t)=>{var r=l.getStream(e);if(!r)throw new l.ErrnoError(8);if(!(r.flags&2097155))throw new l.ErrnoError(28);l.truncate(r.node,t)},utime:(e,t,r)=>{var i=l.lookupPath(e,{follow:!0}),o=i.node;o.node_ops.setattr(o,{timestamp:Math.max(t,r)})},open:(e,t,r)=>{if(e==="")throw new l.ErrnoError(44);t=typeof t=="string"?l.modeStringToFlags(t):t,r=typeof r>"u"?438:r,t&64?r=r&4095|32768:r=0;var i;if(typeof e=="object")i=e;else{e=H.normalize(e);try{var o=l.lookupPath(e,{follow:!(t&131072)});i=o.node}catch{}}var u=!1;if(t&64)if(i){if(t&128)throw new l.ErrnoError(20)}else i=l.mknod(e,r,0),u=!0;if(!i)throw new l.ErrnoError(44);if(l.isChrdev(i.mode)&&(t&=-513),t&65536&&!l.isDir(i.mode))throw new l.ErrnoError(54);if(!u){var c=l.mayOpen(i,t);if(c)throw new l.ErrnoError(c)}t&512&&!u&&l.truncate(i,0),t&=-131713;var f=l.createStream({node:i,path:l.getPath(i),flags:t,seekable:!0,position:0,stream_ops:i.stream_ops,ungotten:[],error:!1});return f.stream_ops.open&&f.stream_ops.open(f),n.logReadFiles&&!(t&1)&&(l.readFiles||(l.readFiles={}),e in l.readFiles||(l.readFiles[e]=1)),f},close:e=>{if(l.isClosed(e))throw new l.ErrnoError(8);e.getdents&&(e.getdents=null);try{e.stream_ops.close&&e.stream_ops.close(e)}catch(t){throw t}finally{l.closeStream(e.fd)}e.fd=null},isClosed:e=>e.fd===null,llseek:(e,t,r)=>{if(l.isClosed(e))throw new l.ErrnoError(8);if(!e.seekable||!e.stream_ops.llseek)throw new l.ErrnoError(70);if(r!=0&&r!=1&&r!=2)throw new l.ErrnoError(28);return e.position=e.stream_ops.llseek(e,t,r),e.ungotten=[],e.position},read:(e,t,r,i,o)=>{if(i<0||o<0)throw new l.ErrnoError(28);if(l.isClosed(e))throw new l.ErrnoError(8);if((e.flags&2097155)===1)throw new l.ErrnoError(8);if(l.isDir(e.node.mode))throw new l.ErrnoError(31);if(!e.stream_ops.read)throw new l.ErrnoError(28);var u=typeof o<"u";if(!u)o=e.position;else if(!e.seekable)throw new l.ErrnoError(70);var c=e.stream_ops.read(e,t,r,i,o);return u||(e.position+=c),c},write:(e,t,r,i,o,u)=>{if(i<0||o<0)throw new l.ErrnoError(28);if(l.isClosed(e))throw new l.ErrnoError(8);if(!(e.flags&2097155))throw new l.ErrnoError(8);if(l.isDir(e.node.mode))throw new l.ErrnoError(31);if(!e.stream_ops.write)throw new l.ErrnoError(28);e.seekable&&e.flags&1024&&l.llseek(e,0,2);var c=typeof o<"u";if(!c)o=e.position;else if(!e.seekable)throw new l.ErrnoError(70);var f=e.stream_ops.write(e,t,r,i,o,u);return c||(e.position+=f),f},allocate:(e,t,r)=>{if(l.isClosed(e))throw new l.ErrnoError(8);if(t<0||r<=0)throw new l.ErrnoError(28);if(!(e.flags&2097155))throw new l.ErrnoError(8);if(!l.isFile(e.node.mode)&&!l.isDir(e.node.mode))throw new l.ErrnoError(43);if(!e.stream_ops.allocate)throw new l.ErrnoError(138);e.stream_ops.allocate(e,t,r)},mmap:(e,t,r,i,o)=>{if(i&2&&!(o&2)&&(e.flags&2097155)!==2)throw new l.ErrnoError(2);if((e.flags&2097155)===1)throw new l.ErrnoError(2);if(!e.stream_ops.mmap)throw new l.ErrnoError(43);return e.stream_ops.mmap(e,t,r,i,o)},msync:(e,t,r,i,o)=>!e||!e.stream_ops.msync?0:e.stream_ops.msync(e,t,r,i,o),munmap:e=>0,ioctl:(e,t,r)=>{if(!e.stream_ops.ioctl)throw new l.ErrnoError(59);return e.stream_ops.ioctl(e,t,r)},readFile:(e,t={})=>{if(t.flags=t.flags||0,t.encoding=t.encoding||"binary",t.encoding!=="utf8"&&t.encoding!=="binary")throw new Error('Invalid encoding type "'+t.encoding+'"');var r,i=l.open(e,t.flags),o=l.stat(e),u=o.size,c=new Uint8Array(u);return l.read(i,c,0,u,0),t.encoding==="utf8"?r=ve(c,0):t.encoding==="binary"&&(r=c),l.close(i),r},writeFile:(e,t,r={})=>{r.flags=r.flags||577;var i=l.open(e,r.flags,r.mode);if(typeof t=="string"){var o=new Uint8Array(Ze(t)+1),u=ft(t,o,0,o.length);l.write(i,o,0,u,void 0,r.canOwn)}else if(ArrayBuffer.isView(t))l.write(i,t,0,t.byteLength,void 0,r.canOwn);else throw new Error("Unsupported data type");l.close(i)},cwd:()=>l.currentPath,chdir:e=>{var t=l.lookupPath(e,{follow:!0});if(t.node===null)throw new l.ErrnoError(44);if(!l.isDir(t.node.mode))throw new l.ErrnoError(54);var r=l.nodePermissions(t.node,"x");if(r)throw new l.ErrnoError(r);l.currentPath=t.path},createDefaultDirectories:()=>{l.mkdir("/tmp"),l.mkdir("/home"),l.mkdir("/home/web_user")},createDefaultDevices:()=>{l.mkdir("/dev"),l.registerDevice(l.makedev(1,3),{read:()=>0,write:(t,r,i,o,u)=>o}),l.mkdev("/dev/null",l.makedev(1,3)),Be.register(l.makedev(5,0),Be.default_tty_ops),Be.register(l.makedev(6,0),Be.default_tty1_ops),l.mkdev("/dev/tty",l.makedev(5,0)),l.mkdev("/dev/tty1",l.makedev(6,0));var e=Jt();l.createDevice("/dev","random",e),l.createDevice("/dev","urandom",e),l.mkdir("/dev/shm"),l.mkdir("/dev/shm/tmp")},createSpecialDirectories:()=>{l.mkdir("/proc");var e=l.mkdir("/proc/self");l.mkdir("/proc/self/fd"),l.mount({mount:()=>{var t=l.createNode(e,"fd",16895,73);return t.node_ops={lookup:(r,i)=>{var o=+i,u=l.getStream(o);if(!u)throw new l.ErrnoError(8);var c={parent:null,mount:{mountpoint:"fake"},node_ops:{readlink:()=>u.path}};return c.parent=c,c}},t}},{},"/proc/self/fd")},createStandardStreams:()=>{n.stdin?l.createDevice("/dev","stdin",n.stdin):l.symlink("/dev/tty","/dev/stdin"),n.stdout?l.createDevice("/dev","stdout",null,n.stdout):l.symlink("/dev/tty","/dev/stdout"),n.stderr?l.createDevice("/dev","stderr",null,n.stderr):l.symlink("/dev/tty1","/dev/stderr"),l.open("/dev/stdin",0),l.open("/dev/stdout",1),l.open("/dev/stderr",1)},ensureErrnoError:()=>{l.ErrnoError||(l.ErrnoError=function(t,r){this.node=r,this.setErrno=function(i){this.errno=i},this.setErrno(t),this.message="FS error"},l.ErrnoError.prototype=new Error,l.ErrnoError.prototype.constructor=l.ErrnoError,[44].forEach(e=>{l.genericErrors[e]=new l.ErrnoError(e),l.genericErrors[e].stack="<generic error, no stack>"}))},staticInit:()=>{l.ensureErrnoError(),l.nameTable=new Array(4096),l.mount(G,{},"/"),l.createDefaultDirectories(),l.createDefaultDevices(),l.createSpecialDirectories(),l.filesystems={MEMFS:G}},init:(e,t,r)=>{l.init.initialized=!0,l.ensureErrnoError(),n.stdin=e||n.stdin,n.stdout=t||n.stdout,n.stderr=r||n.stderr,l.createStandardStreams()},quit:()=>{l.init.initialized=!1;for(var e=0;e<l.streams.length;e++){var t=l.streams[e];t&&l.close(t)}},getMode:(e,t)=>{var r=0;return e&&(r|=365),t&&(r|=146),r},findObject:(e,t)=>{var r=l.analyzePath(e,t);return r.exists?r.object:null},analyzePath:(e,t)=>{try{var r=l.lookupPath(e,{follow:!t});e=r.path}catch{}var i={isRoot:!1,exists:!1,error:0,name:null,path:null,object:null,parentExists:!1,parentPath:null,parentObject:null};try{var r=l.lookupPath(e,{parent:!0});i.parentExists=!0,i.parentPath=r.path,i.parentObject=r.node,i.name=H.basename(e),r=l.lookupPath(e,{follow:!t}),i.exists=!0,i.path=r.path,i.object=r.node,i.name=r.node.name,i.isRoot=r.path==="/"}catch(o){i.error=o.errno}return i},createPath:(e,t,r,i)=>{e=typeof e=="string"?e:l.getPath(e);for(var o=t.split("/").reverse();o.length;){var u=o.pop();if(u){var c=H.join2(e,u);try{l.mkdir(c)}catch{}e=c}}return c},createFile:(e,t,r,i,o)=>{var u=H.join2(typeof e=="string"?e:l.getPath(e),t),c=l.getMode(i,o);return l.create(u,c)},createDataFile:(e,t,r,i,o,u)=>{var c=t;e&&(e=typeof e=="string"?e:l.getPath(e),c=t?H.join2(e,t):e);var f=l.getMode(i,o),h=l.create(c,f);if(r){if(typeof r=="string"){for(var _=new Array(r.length),x=0,C=r.length;x<C;++x)_[x]=r.charCodeAt(x);r=_}l.chmod(h,f|146);var E=l.open(h,577);l.write(E,r,0,r.length,0,u),l.close(E),l.chmod(h,f)}return h},createDevice:(e,t,r,i)=>{var o=H.join2(typeof e=="string"?e:l.getPath(e),t),u=l.getMode(!!r,!!i);l.createDevice.major||(l.createDevice.major=64);var c=l.makedev(l.createDevice.major++,0);return l.registerDevice(c,{open:f=>{f.seekable=!1},close:f=>{i&&i.buffer&&i.buffer.length&&i(10)},read:(f,h,_,x,C)=>{for(var E=0,S=0;S<x;S++){var k;try{k=r()}catch{throw new l.ErrnoError(29)}if(k===void 0&&E===0)throw new l.ErrnoError(6);if(k==null)break;E++,h[_+S]=k}return E&&(f.node.timestamp=Date.now()),E},write:(f,h,_,x,C)=>{for(var E=0;E<x;E++)try{i(h[_+E])}catch{throw new l.ErrnoError(29)}return x&&(f.node.timestamp=Date.now()),E}}),l.mkdev(o,u,c)},forceLoadFile:e=>{if(e.isDevice||e.isFolder||e.link||e.contents)return!0;if(typeof XMLHttpRequest<"u")throw new Error("Lazy loading should have been performed (contents set) in createLazyFile, but it was not. Lazy loading only works in web workers. Use --embed-file or --preload-file in emcc on the main thread.");if(K)try{e.contents=It(K(e.url),!0),e.usedBytes=e.contents.length}catch{throw new l.ErrnoError(29)}else throw new Error("Cannot load without read() or XMLHttpRequest.")},createLazyFile:(e,t,r,i,o)=>{function u(){this.lengthKnown=!1,this.chunks=[]}if(u.prototype.get=function(S){if(!(S>this.length-1||S<0)){var k=S%this.chunkSize,W=S/this.chunkSize|0;return this.getter(W)[k]}},u.prototype.setDataGetter=function(S){this.getter=S},u.prototype.cacheLength=function(){var S=new XMLHttpRequest;if(S.open("HEAD",r,!1),S.send(null),!(S.status>=200&&S.status<300||S.status===304))throw new Error("Couldn't load "+r+". Status: "+S.status);var k=Number(S.getResponseHeader("Content-length")),W,Y=(W=S.getResponseHeader("Accept-Ranges"))&&W==="bytes",J=(W=S.getResponseHeader("Content-Encoding"))&&W==="gzip",se=1024*1024;Y||(se=k);var Q=(ye,$e)=>{if(ye>$e)throw new Error("invalid range ("+ye+", "+$e+") or no bytes requested!");if($e>k-1)throw new Error("only "+k+" bytes available! programmer error!");var ne=new XMLHttpRequest;if(ne.open("GET",r,!1),k!==se&&ne.setRequestHeader("Range","bytes="+ye+"-"+$e),ne.responseType="arraybuffer",ne.overrideMimeType&&ne.overrideMimeType("text/plain; charset=x-user-defined"),ne.send(null),!(ne.status>=200&&ne.status<300||ne.status===304))throw new Error("Couldn't load "+r+". Status: "+ne.status);return ne.response!==void 0?new Uint8Array(ne.response||[]):It(ne.responseText||"")},ot=this;ot.setDataGetter(ye=>{var $e=ye*se,ne=(ye+1)*se-1;if(ne=Math.min(ne,k-1),typeof ot.chunks[ye]>"u"&&(ot.chunks[ye]=Q($e,ne)),typeof ot.chunks[ye]>"u")throw new Error("doXHR failed!");return ot.chunks[ye]}),(J||!k)&&(se=k=1,k=this.getter(0).length,se=k,V("LazyFiles on gzip forces download of the whole file when length is accessed")),this._length=k,this._chunkSize=se,this.lengthKnown=!0},typeof XMLHttpRequest<"u"){if(!A)throw"Cannot do synchronous binary XHRs outside webworkers in modern browsers. Use --embed-file or --preload-file in emcc";var c=new u;Object.defineProperties(c,{length:{get:function(){return this.lengthKnown||this.cacheLength(),this._length}},chunkSize:{get:function(){return this.lengthKnown||this.cacheLength(),this._chunkSize}}});var f={isDevice:!1,contents:c}}else var f={isDevice:!1,url:r};var h=l.createFile(e,t,f,i,o);f.contents?h.contents=f.contents:f.url&&(h.contents=null,h.url=f.url),Object.defineProperties(h,{usedBytes:{get:function(){return this.contents.length}}});var _={},x=Object.keys(h.stream_ops);x.forEach(E=>{var S=h.stream_ops[E];_[E]=function(){return l.forceLoadFile(h),S.apply(null,arguments)}});function C(E,S,k,W,Y){var J=E.node.contents;if(Y>=J.length)return 0;var se=Math.min(J.length-Y,W);if(J.slice)for(var Q=0;Q<se;Q++)S[k+Q]=J[Y+Q];else for(var Q=0;Q<se;Q++)S[k+Q]=J.get(Y+Q);return se}return _.read=(E,S,k,W,Y)=>(l.forceLoadFile(h),C(E,S,k,W,Y)),_.mmap=(E,S,k,W,Y)=>{l.forceLoadFile(h);var J=Yt();if(!J)throw new l.ErrnoError(48);return C(E,oe,J,S,k),{ptr:J,allocated:!0}},h.stream_ops=_,h},createPreloadedFile:(e,t,r,i,o,u,c,f,h,_)=>{var x=t?Ee.resolve(H.join2(e,t)):e;function C(E){function S(k){_&&_(),f||l.createDataFile(e,t,k,i,o,h),u&&u(),ht()}Browser.handledByPreloadPlugin(E,x,S,()=>{c&&c(),ht()})||S(E)}Pt(),typeof r=="string"?Lr(r,E=>C(E),c):C(r)},indexedDB:()=>window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB,DB_NAME:()=>"EM_FS_"+window.location.pathname,DB_VERSION:20,DB_STORE_NAME:"FILE_DATA",saveFilesToDB:(e,t,r)=>{t=t||(()=>{}),r=r||(()=>{});var i=l.indexedDB();try{var o=i.open(l.DB_NAME(),l.DB_VERSION)}catch(u){return r(u)}o.onupgradeneeded=()=>{V("creating db");var u=o.result;u.createObjectStore(l.DB_STORE_NAME)},o.onsuccess=()=>{var u=o.result,c=u.transaction([l.DB_STORE_NAME],"readwrite"),f=c.objectStore(l.DB_STORE_NAME),h=0,_=0,x=e.length;function C(){_==0?t():r()}e.forEach(E=>{var S=f.put(l.analyzePath(E).object.contents,E);S.onsuccess=()=>{h++,h+_==x&&C()},S.onerror=()=>{_++,h+_==x&&C()}}),c.onerror=r},o.onerror=r},loadFilesFromDB:(e,t,r)=>{t=t||(()=>{}),r=r||(()=>{});var i=l.indexedDB();try{var o=i.open(l.DB_NAME(),l.DB_VERSION)}catch(u){return r(u)}o.onupgradeneeded=r,o.onsuccess=()=>{var u=o.result;try{var c=u.transaction([l.DB_STORE_NAME],"readonly")}catch(E){r(E);return}var f=c.objectStore(l.DB_STORE_NAME),h=0,_=0,x=e.length;function C(){_==0?t():r()}e.forEach(E=>{var S=f.get(E);S.onsuccess=()=>{l.analyzePath(E).exists&&l.unlink(E),l.createDataFile(H.dirname(E),H.basename(E),S.result,!0,!0,!0),h++,h+_==x&&C()},S.onerror=()=>{_++,h+_==x&&C()}}),c.onerror=r},o.onerror=r}},ee={DEFAULT_POLLMASK:5,calculateAt:function(e,t,r){if(H.isAbs(t))return t;var i;if(e===-100)i=l.cwd();else{var o=ee.getStreamFromFD(e);i=o.path}if(t.length==0){if(!r)throw new l.ErrnoError(44);return i}return H.join2(i,t)},doStat:function(e,t,r){try{var i=e(t)}catch(o){if(o&&o.node&&H.normalize(t)!==H.normalize(l.getPath(o.node)))return-54;throw o}return w[r>>2]=i.dev,w[r+8>>2]=i.ino,w[r+12>>2]=i.mode,M[r+16>>2]=i.nlink,w[r+20>>2]=i.uid,w[r+24>>2]=i.gid,w[r+28>>2]=i.rdev,j=[i.size>>>0,(T=i.size,+Math.abs(T)>=1?T>0?(Math.min(+Math.floor(T/4294967296),4294967295)|0)>>>0:~~+Math.ceil((T-+(~~T>>>0))/4294967296)>>>0:0)],w[r+40>>2]=j[0],w[r+44>>2]=j[1],w[r+48>>2]=4096,w[r+52>>2]=i.blocks,j=[Math.floor(i.atime.getTime()/1e3)>>>0,(T=Math.floor(i.atime.getTime()/1e3),+Math.abs(T)>=1?T>0?(Math.min(+Math.floor(T/4294967296),4294967295)|0)>>>0:~~+Math.ceil((T-+(~~T>>>0))/4294967296)>>>0:0)],w[r+56>>2]=j[0],w[r+60>>2]=j[1],M[r+64>>2]=0,j=[Math.floor(i.mtime.getTime()/1e3)>>>0,(T=Math.floor(i.mtime.getTime()/1e3),+Math.abs(T)>=1?T>0?(Math.min(+Math.floor(T/4294967296),4294967295)|0)>>>0:~~+Math.ceil((T-+(~~T>>>0))/4294967296)>>>0:0)],w[r+72>>2]=j[0],w[r+76>>2]=j[1],M[r+80>>2]=0,j=[Math.floor(i.ctime.getTime()/1e3)>>>0,(T=Math.floor(i.ctime.getTime()/1e3),+Math.abs(T)>=1?T>0?(Math.min(+Math.floor(T/4294967296),4294967295)|0)>>>0:~~+Math.ceil((T-+(~~T>>>0))/4294967296)>>>0:0)],w[r+88>>2]=j[0],w[r+92>>2]=j[1],M[r+96>>2]=0,j=[i.ino>>>0,(T=i.ino,+Math.abs(T)>=1?T>0?(Math.min(+Math.floor(T/4294967296),4294967295)|0)>>>0:~~+Math.ceil((T-+(~~T>>>0))/4294967296)>>>0:0)],w[r+104>>2]=j[0],w[r+108>>2]=j[1],0},doMsync:function(e,t,r,i,o){var u=ie.slice(e,e+r);l.msync(t,u,o,r,i)},varargs:void 0,get:function(){ee.varargs+=4;var e=w[ee.varargs-4>>2];return e},getStr:function(e){var t=he(e);return t},getStreamFromFD:function(e){var t=l.getStream(e);if(!t)throw new l.ErrnoError(8);return t}};function _i(e,t,r){ee.varargs=r;try{var i=ee.getStreamFromFD(e);switch(t){case 0:{var o=ee.get();if(o<0)return-28;var u;return u=l.createStream(i,o),u.fd}case 1:case 2:return 0;case 3:return i.flags;case 4:{var o=ee.get();return i.flags|=o,0}case 5:{var o=ee.get(),c=0;return Ae[o+c>>1]=2,0}case 6:case 7:return 0;case 16:case 8:return-28;case 9:return Rr(28),-1;default:return-28}}catch(f){if(typeof l>"u"||!(f instanceof l.ErrnoError))throw f;return-f.errno}}function yi(e,t,r){ee.varargs=r;try{var i=ee.getStreamFromFD(e);switch(t){case 21509:case 21505:return i.tty?0:-59;case 21510:case 21511:case 21512:case 21506:case 21507:case 21508:return i.tty?0:-59;case 21519:{if(!i.tty)return-59;var o=ee.get();return w[o>>2]=0,0}case 21520:return i.tty?-28:-59;case 21531:{var o=ee.get();return l.ioctl(i,t,o)}case 21523:return i.tty?0:-59;case 21524:return i.tty?0:-59;default:return-28}}catch(u){if(typeof l>"u"||!(u instanceof l.ErrnoError))throw u;return-u.errno}}function wi(e,t,r,i){ee.varargs=i;try{t=ee.getStr(t),t=ee.calculateAt(e,t);var o=i?ee.get():0;return l.open(t,r,o).fd}catch(u){if(typeof l>"u"||!(u instanceof l.ErrnoError))throw u;return-u.errno}}var Qt={};function Zt(e){for(;e.length;){var t=e.pop(),r=e.pop();r(t)}}function At(e){return this.fromWireType(w[e>>2])}var pt={},at={},er={},bi=48,xi=57;function tr(e){if(e===void 0)return"_unknown";e=e.replace(/[^a-zA-Z0-9_]/g,"$");var t=e.charCodeAt(0);return t>=bi&&t<=xi?"_"+e:e}function rr(e,t){return e=tr(e),new Function("body","return function "+e+`() {
    "use strict";    return body.apply(this, arguments);
};
`)(t)}function jr(e,t){var r=rr(t,function(i){this.name=t,this.message=i;var o=new Error(i).stack;o!==void 0&&(this.stack=this.toString()+`
`+o.replace(/^Error(:[^\n]*)?\n/,""))});return r.prototype=Object.create(e.prototype),r.prototype.constructor=r,r.prototype.toString=function(){return this.message===void 0?this.name:this.name+": "+this.message},r}var on=void 0;function nr(e){throw new on(e)}function Ce(e,t,r){e.forEach(function(f){er[f]=t});function i(f){var h=r(f);h.length!==e.length&&nr("Mismatched type converter count");for(var _=0;_<e.length;++_)Re(e[_],h[_])}var o=new Array(t.length),u=[],c=0;t.forEach((f,h)=>{at.hasOwnProperty(f)?o[h]=at[f]:(u.push(f),pt.hasOwnProperty(f)||(pt[f]=[]),pt[f].push(()=>{o[h]=at[f],++c,c===u.length&&i(o)}))}),u.length===0&&i(o)}function Ei(e){var t=Qt[e];delete Qt[e];var r=t.rawConstructor,i=t.rawDestructor,o=t.fields,u=o.map(c=>c.getterReturnType).concat(o.map(c=>c.setterArgumentType));Ce([e],u,c=>{var f={};return o.forEach((h,_)=>{var x=h.fieldName,C=c[_],E=h.getter,S=h.getterContext,k=c[_+o.length],W=h.setter,Y=h.setterContext;f[x]={read:J=>C.fromWireType(E(S,J)),write:(J,se)=>{var Q=[];W(Y,J,k.toWireType(Q,se)),Zt(Q)}}}),[{name:t.name,fromWireType:function(h){var _={};for(var x in f)_[x]=f[x].read(h);return i(h),_},toWireType:function(h,_){for(var x in f)if(!(x in _))throw new TypeError('Missing field:  "'+x+'"');var C=r();for(x in f)f[x].write(C,_[x]);return h!==null&&h.push(i,C),C},argPackAdvance:8,readValueFromPointer:At,destructorFunction:i}]})}function Ci(e,t,r,i,o){}function ir(e){switch(e){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+e)}}function Pi(){for(var e=new Array(256),t=0;t<256;++t)e[t]=String.fromCharCode(t);ln=e}var ln=void 0;function te(e){for(var t="",r=e;ie[r];)t+=ln[ie[r++]];return t}var vt=void 0;function N(e){throw new vt(e)}function Re(e,t,r={}){if(!("argPackAdvance"in t))throw new TypeError("registerType registeredInstance requires argPackAdvance");var i=t.name;if(e||N('type "'+i+'" must have a positive integer typeid pointer'),at.hasOwnProperty(e)){if(r.ignoreDuplicateRegistrations)return;N("Cannot register type '"+i+"' twice")}if(at[e]=t,delete er[e],pt.hasOwnProperty(e)){var o=pt[e];delete pt[e],o.forEach(u=>u())}}function Si(e,t,r,i,o){var u=ir(r);t=te(t),Re(e,{name:t,fromWireType:function(c){return!!c},toWireType:function(c,f){return f?i:o},argPackAdvance:8,readValueFromPointer:function(c){var f;if(r===1)f=oe;else if(r===2)f=Ae;else if(r===4)f=w;else throw new TypeError("Unknown boolean type size: "+t);return this.fromWireType(f[c>>u])},destructorFunction:null})}function Ii(e){if(!(this instanceof Ke)||!(e instanceof Ke))return!1;for(var t=this.$$.ptrType.registeredClass,r=this.$$.ptr,i=e.$$.ptrType.registeredClass,o=e.$$.ptr;t.baseClass;)r=t.upcast(r),t=t.baseClass;for(;i.baseClass;)o=i.upcast(o),i=i.baseClass;return t===i&&r===o}function Ai(e){return{count:e.count,deleteScheduled:e.deleteScheduled,preservePointerOnDelete:e.preservePointerOnDelete,ptr:e.ptr,ptrType:e.ptrType,smartPtr:e.smartPtr,smartPtrType:e.smartPtrType}}function Gr(e){function t(r){return r.$$.ptrType.registeredClass.name}N(t(e)+" instance already deleted")}var Or=!1;function un(e){}function Ti(e){e.smartPtr?e.smartPtrType.rawDestructor(e.smartPtr):e.ptrType.registeredClass.rawDestructor(e.ptr)}function cn(e){e.count.value-=1;var t=e.count.value===0;t&&Ti(e)}function fn(e,t,r){if(t===r)return e;if(r.baseClass===void 0)return null;var i=fn(e,t,r.baseClass);return i===null?null:r.downcast(i)}var dn={};function ki(){return Object.keys(Dt).length}function Di(){var e=[];for(var t in Dt)Dt.hasOwnProperty(t)&&e.push(Dt[t]);return e}var Tt=[];function Mr(){for(;Tt.length;){var e=Tt.pop();e.$$.deleteScheduled=!1,e.delete()}}var kt=void 0;function Fi(e){kt=e,Tt.length&&kt&&kt(Mr)}function Ri(){n.getInheritedInstanceCount=ki,n.getLiveInheritedInstances=Di,n.flushPendingDeletes=Mr,n.setDelayFunction=Fi}var Dt={};function Li(e,t){for(t===void 0&&N("ptr should not be undefined");e.baseClass;)t=e.upcast(t),e=e.baseClass;return t}function ji(e,t){return t=Li(e,t),Dt[t]}function ar(e,t){(!t.ptrType||!t.ptr)&&nr("makeClassHandle requires ptr and ptrType");var r=!!t.smartPtrType,i=!!t.smartPtr;return r!==i&&nr("Both smartPtrType and smartPtr must be specified"),t.count={value:1},Ft(Object.create(e,{$$:{value:t}}))}function Gi(e){var t=this.getPointee(e);if(!t)return this.destructor(e),null;var r=ji(this.registeredClass,t);if(r!==void 0){if(r.$$.count.value===0)return r.$$.ptr=t,r.$$.smartPtr=e,r.clone();var i=r.clone();return this.destructor(e),i}function o(){return this.isSmartPointer?ar(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:t,smartPtrType:this,smartPtr:e}):ar(this.registeredClass.instancePrototype,{ptrType:this,ptr:e})}var u=this.registeredClass.getActualType(t),c=dn[u];if(!c)return o.call(this);var f;this.isConst?f=c.constPointerType:f=c.pointerType;var h=fn(t,this.registeredClass,f.registeredClass);return h===null?o.call(this):this.isSmartPointer?ar(f.registeredClass.instancePrototype,{ptrType:f,ptr:h,smartPtrType:this,smartPtr:e}):ar(f.registeredClass.instancePrototype,{ptrType:f,ptr:h})}function Ft(e){return typeof FinalizationRegistry>"u"?(Ft=t=>t,e):(Or=new FinalizationRegistry(t=>{cn(t.$$)}),Ft=t=>{var r=t.$$,i=!!r.smartPtr;if(i){var o={$$:r};Or.register(t,o,t)}return t},un=t=>Or.unregister(t),Ft(e))}function Oi(){if(this.$$.ptr||Gr(this),this.$$.preservePointerOnDelete)return this.$$.count.value+=1,this;var e=Ft(Object.create(Object.getPrototypeOf(this),{$$:{value:Ai(this.$$)}}));return e.$$.count.value+=1,e.$$.deleteScheduled=!1,e}function Mi(){this.$$.ptr||Gr(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&N("Object already scheduled for deletion"),un(this),cn(this.$$),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)}function Bi(){return!this.$$.ptr}function Ni(){return this.$$.ptr||Gr(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&N("Object already scheduled for deletion"),Tt.push(this),Tt.length===1&&kt&&kt(Mr),this.$$.deleteScheduled=!0,this}function $i(){Ke.prototype.isAliasOf=Ii,Ke.prototype.clone=Oi,Ke.prototype.delete=Mi,Ke.prototype.isDeleted=Bi,Ke.prototype.deleteLater=Ni}function Ke(){}function Br(e,t,r){if(e[t].overloadTable===void 0){var i=e[t];e[t]=function(){return e[t].overloadTable.hasOwnProperty(arguments.length)||N("Function '"+r+"' called with an invalid number of arguments ("+arguments.length+") - expects one of ("+e[t].overloadTable+")!"),e[t].overloadTable[arguments.length].apply(this,arguments)},e[t].overloadTable=[],e[t].overloadTable[i.argCount]=i}}function Nr(e,t,r){n.hasOwnProperty(e)?((r===void 0||n[e].overloadTable!==void 0&&n[e].overloadTable[r]!==void 0)&&N("Cannot register public name '"+e+"' twice"),Br(n,e,e),n.hasOwnProperty(r)&&N("Cannot register multiple overloads of a function with the same number of arguments ("+r+")!"),n[e].overloadTable[r]=t):(n[e]=t,r!==void 0&&(n[e].numArguments=r))}function Vi(e,t,r,i,o,u,c,f){this.name=e,this.constructor=t,this.instancePrototype=r,this.rawDestructor=i,this.baseClass=o,this.getActualType=u,this.upcast=c,this.downcast=f,this.pureVirtualFunctions=[]}function sr(e,t,r){for(;t!==r;)t.upcast||N("Expected null or instance of "+r.name+", got an instance of "+t.name),e=t.upcast(e),t=t.baseClass;return e}function Ui(e,t){if(t===null)return this.isReference&&N("null is not a valid "+this.name),0;t.$$||N('Cannot pass "'+Ur(t)+'" as a '+this.name),t.$$.ptr||N("Cannot pass deleted object as a pointer of type "+this.name);var r=t.$$.ptrType.registeredClass,i=sr(t.$$.ptr,r,this.registeredClass);return i}function Hi(e,t){var r;if(t===null)return this.isReference&&N("null is not a valid "+this.name),this.isSmartPointer?(r=this.rawConstructor(),e!==null&&e.push(this.rawDestructor,r),r):0;t.$$||N('Cannot pass "'+Ur(t)+'" as a '+this.name),t.$$.ptr||N("Cannot pass deleted object as a pointer of type "+this.name),!this.isConst&&t.$$.ptrType.isConst&&N("Cannot convert argument of type "+(t.$$.smartPtrType?t.$$.smartPtrType.name:t.$$.ptrType.name)+" to parameter type "+this.name);var i=t.$$.ptrType.registeredClass;if(r=sr(t.$$.ptr,i,this.registeredClass),this.isSmartPointer)switch(t.$$.smartPtr===void 0&&N("Passing raw pointer to smart pointer is illegal"),this.sharingPolicy){case 0:t.$$.smartPtrType===this?r=t.$$.smartPtr:N("Cannot convert argument of type "+(t.$$.smartPtrType?t.$$.smartPtrType.name:t.$$.ptrType.name)+" to parameter type "+this.name);break;case 1:r=t.$$.smartPtr;break;case 2:if(t.$$.smartPtrType===this)r=t.$$.smartPtr;else{var o=t.clone();r=this.rawShare(r,z.toHandle(function(){o.delete()})),e!==null&&e.push(this.rawDestructor,r)}break;default:N("Unsupporting sharing policy")}return r}function zi(e,t){if(t===null)return this.isReference&&N("null is not a valid "+this.name),0;t.$$||N('Cannot pass "'+Ur(t)+'" as a '+this.name),t.$$.ptr||N("Cannot pass deleted object as a pointer of type "+this.name),t.$$.ptrType.isConst&&N("Cannot convert argument of type "+t.$$.ptrType.name+" to parameter type "+this.name);var r=t.$$.ptrType.registeredClass,i=sr(t.$$.ptr,r,this.registeredClass);return i}function Wi(e){return this.rawGetPointee&&(e=this.rawGetPointee(e)),e}function qi(e){this.rawDestructor&&this.rawDestructor(e)}function Ki(e){e!==null&&e.delete()}function Xi(){Le.prototype.getPointee=Wi,Le.prototype.destructor=qi,Le.prototype.argPackAdvance=8,Le.prototype.readValueFromPointer=At,Le.prototype.deleteObject=Ki,Le.prototype.fromWireType=Gi}function Le(e,t,r,i,o,u,c,f,h,_,x){this.name=e,this.registeredClass=t,this.isReference=r,this.isConst=i,this.isSmartPointer=o,this.pointeeType=u,this.sharingPolicy=c,this.rawGetPointee=f,this.rawConstructor=h,this.rawShare=_,this.rawDestructor=x,!o&&t.baseClass===void 0?i?(this.toWireType=Ui,this.destructorFunction=null):(this.toWireType=zi,this.destructorFunction=null):this.toWireType=Hi}function mn(e,t,r){n.hasOwnProperty(e)||nr("Replacing nonexistant public symbol"),n[e].overloadTable!==void 0&&r!==void 0?n[e].overloadTable[r]=t:(n[e]=t,n[e].argCount=r)}function Ji(e,t,r){var i=n["dynCall_"+e];return r&&r.length?i.apply(null,[t].concat(r)):i.call(null,t)}function Yi(e,t,r){return Ji(e,t,r)}function Qi(e,t){var r=[];return function(){return r.length=0,Object.assign(r,arguments),Yi(e,t,r)}}function ue(e,t){e=te(e);function r(){return Qi(e,t)}var i=r();return typeof i!="function"&&N("unknown function pointer with signature "+e+": "+t),i}var hn=void 0;function pn(e){var t=In(e),r=te(t);return je(t),r}function st(e,t){var r=[],i={};function o(u){if(!i[u]&&!at[u]){if(er[u]){er[u].forEach(o);return}r.push(u),i[u]=!0}}throw t.forEach(o),new hn(e+": "+r.map(pn).join([", "]))}function Zi(e,t,r,i,o,u,c,f,h,_,x,C,E){x=te(x),u=ue(o,u),f&&(f=ue(c,f)),_&&(_=ue(h,_)),E=ue(C,E);var S=tr(x);Nr(S,function(){st("Cannot construct "+x+" due to unbound types",[i])}),Ce([e,t,r],i?[i]:[],function(k){k=k[0];var W,Y;i?(W=k.registeredClass,Y=W.instancePrototype):Y=Ke.prototype;var J=rr(S,function(){if(Object.getPrototypeOf(this)!==se)throw new vt("Use 'new' to construct "+x);if(Q.constructor_body===void 0)throw new vt(x+" has no accessible constructor");var ne=Q.constructor_body[arguments.length];if(ne===void 0)throw new vt("Tried to invoke ctor of "+x+" with invalid number of parameters ("+arguments.length+") - expected ("+Object.keys(Q.constructor_body).toString()+") parameters instead!");return ne.apply(this,arguments)}),se=Object.create(Y,{constructor:{value:J}});J.prototype=se;var Q=new Vi(x,J,se,E,W,u,f,_),ot=new Le(x,Q,!0,!1,!1),ye=new Le(x+"*",Q,!1,!1,!1),$e=new Le(x+" const*",Q,!1,!0,!1);return dn[e]={pointerType:ye,constPointerType:$e},mn(S,J),[ot,ye,$e]})}function vn(e,t){if(!(e instanceof Function))throw new TypeError("new_ called with constructor type "+typeof e+" which is not a function");var r=rr(e.name||"unknownFunctionName",function(){});r.prototype=e.prototype;var i=new r,o=e.apply(i,t);return o instanceof Object?o:i}function or(e){try{return e()}catch(t){xe(t)}}function ea(e){if(!me)try{e()}catch(t){Z(t)}}var F={State:{Normal:0,Unwinding:1,Rewinding:2,Disabled:3},state:0,StackSize:4096,currData:null,handleSleepReturnValue:0,exportCallStack:[],callStackNameToId:{},callStackIdToName:{},callStackId:0,asyncPromiseHandlers:null,sleepCallbacks:[],getCallStackId:function(e){var t=F.callStackNameToId[e];return t===void 0&&(t=F.callStackId++,F.callStackNameToId[e]=t,F.callStackIdToName[t]=e),t},instrumentWasmImports:function(e){var t=["env.invoke_*","env.emscripten_sleep","env.emscripten_wget","env.emscripten_wget_data","env.emscripten_idb_load","env.emscripten_idb_store","env.emscripten_idb_delete","env.emscripten_idb_exists","env.emscripten_idb_load_blob","env.emscripten_idb_store_blob","env.SDL_Delay","env.emscripten_scan_registers","env.emscripten_lazy_load_code","env.emscripten_fiber_swap","wasi_snapshot_preview1.fd_sync","env.__wasi_fd_sync","env._emval_await","env._dlopen_js","env.__asyncjs__*"].map(i=>i.split(".")[1]);for(var r in e)(function(i){var o=e[i];o.sig,typeof o=="function"&&(t.indexOf(i)>=0||i.startsWith("__asyncjs__"))})(r)},instrumentWasmExports:function(e){var t={};for(var r in e)(function(i){var o=e[i];typeof o=="function"?t[i]=function(){F.exportCallStack.push(i);try{return o.apply(null,arguments)}finally{if(!me){var u=F.exportCallStack.pop();re(u===i),F.maybeStopUnwind()}}}:t[i]=o})(r);return t},maybeStopUnwind:function(){F.currData&&F.state===F.State.Unwinding&&F.exportCallStack.length===0&&(F.state=F.State.Normal,or(Dn),typeof Fibers<"u"&&Fibers.trampoline())},whenDone:function(){return new Promise((e,t)=>{F.asyncPromiseHandlers={resolve:e,reject:t}})},allocateData:function(){var e=_t(12+F.StackSize);return F.setDataHeader(e,e+12,F.StackSize),F.setDataRewindFunc(e),e},setDataHeader:function(e,t,r){w[e>>2]=t,w[e+4>>2]=t+r},setDataRewindFunc:function(e){var t=F.exportCallStack[0],r=F.getCallStackId(t);w[e+8>>2]=r},getDataRewindFunc:function(e){var t=w[e+8>>2],r=F.callStackIdToName[t],i=n.asm[r];return i},doRewind:function(e){var t=F.getDataRewindFunc(e);return t()},handleSleep:function(e){if(!me){if(F.state===F.State.Normal){var t=!1,r=!1;e(i=>{if(!me&&(F.handleSleepReturnValue=i||0,t=!0,!!r)){F.state=F.State.Rewinding,or(()=>Fn(F.currData)),typeof Browser<"u"&&Browser.mainLoop.func&&Browser.mainLoop.resume();var o,u=!1;try{o=F.doRewind(F.currData)}catch(h){o=h,u=!0}var c=!1;if(!F.currData){var f=F.asyncPromiseHandlers;f&&(F.asyncPromiseHandlers=null,(u?f.reject:f.resolve)(o),c=!0)}if(u&&!c)throw o}}),r=!0,t||(F.state=F.State.Unwinding,F.currData=F.allocateData(),typeof Browser<"u"&&Browser.mainLoop.func&&Browser.mainLoop.pause(),or(()=>kn(F.currData)))}else F.state===F.State.Rewinding?(F.state=F.State.Normal,or(Rn),je(F.currData),F.currData=null,F.sleepCallbacks.forEach(i=>ea(i))):xe("invalid state: "+F.state);return F.handleSleepReturnValue}},handleAsync:function(e){return F.handleSleep(t=>{e().then(t)})}};function lr(e,t,r,i,o){var u=t.length;u<2&&N("argTypes array size mismatch! Must at least get return value and 'this' types!");for(var c=t[1]!==null&&r!==null,f=!1,h=1;h<t.length;++h)if(t[h]!==null&&t[h].destructorFunction===void 0){f=!0;break}for(var _=t[0].name!=="void",x="",C="",h=0;h<u-2;++h)x+=(h!==0?", ":"")+"arg"+h,C+=(h!==0?", ":"")+"arg"+h+"Wired";var E="return function "+tr(e)+"("+x+`) {
if (arguments.length !== `+(u-2)+`) {
throwBindingError('function `+e+" called with ' + arguments.length + ' arguments, expected "+(u-2)+` args!');
}
`;f&&(E+=`var destructors = [];
`);var S=f?"destructors":"null",k=["throwBindingError","invoker","fn","runDestructors","retType","classParam"],W=[N,i,o,Zt,t[0],t[1]];c&&(E+="var thisWired = classParam.toWireType("+S+`, this);
`);for(var h=0;h<u-2;++h)E+="var arg"+h+"Wired = argType"+h+".toWireType("+S+", arg"+h+"); // "+t[h+2].name+`
`,k.push("argType"+h),W.push(t[h+2]);if(c&&(C="thisWired"+(C.length>0?", ":"")+C),E+=(_?"var rv = ":"")+"invoker(fn"+(C.length>0?", ":"")+C+`);
`,k.push("Asyncify"),W.push(F),E+="function onDone("+(_?"rv":"")+`) {
`,f)E+=`runDestructors(destructors);
`;else for(var h=c?1:2;h<t.length;++h){var Y=h===1?"thisWired":"arg"+(h-2)+"Wired";t[h].destructorFunction!==null&&(E+=Y+"_dtor("+Y+"); // "+t[h].name+`
`,k.push(Y+"_dtor"),W.push(t[h].destructorFunction))}_&&(E+=`var ret = retType.fromWireType(rv);
return ret;
`),E+=`}
`,E+="return Asyncify.currData ? Asyncify.whenDone().then(onDone) : onDone("+(_?"rv":"")+`);
`,E+=`}
`,k.push(E);var J=vn(Function,k).apply(null,W);return J}function ur(e,t){for(var r=[],i=0;i<e;i++)r.push(M[t+i*4>>2]);return r}function ta(e,t,r,i,o,u,c){var f=ur(r,i);t=te(t),u=ue(o,u),Ce([],[e],function(h){h=h[0];var _=h.name+"."+t;function x(){st("Cannot call "+_+" due to unbound types",f)}t.startsWith("@@")&&(t=Symbol[t.substring(2)]);var C=h.registeredClass.constructor;return C[t]===void 0?(x.argCount=r-1,C[t]=x):(Br(C,t,_),C[t].overloadTable[r-1]=x),Ce([],f,function(E){var S=[E[0],null].concat(E.slice(1)),k=lr(_,S,null,u,c);return C[t].overloadTable===void 0?(k.argCount=r-1,C[t]=k):C[t].overloadTable[r-1]=k,[]}),[]})}function ra(e,t,r,i,o,u){re(t>0);var c=ur(t,r);o=ue(i,o),Ce([],[e],function(f){f=f[0];var h="constructor "+f.name;if(f.registeredClass.constructor_body===void 0&&(f.registeredClass.constructor_body=[]),f.registeredClass.constructor_body[t-1]!==void 0)throw new vt("Cannot register multiple constructors with identical number of parameters ("+(t-1)+") for class '"+f.name+"'! Overload resolution is currently only performed using the parameter count, not actual type info!");return f.registeredClass.constructor_body[t-1]=()=>{st("Cannot construct "+f.name+" due to unbound types",c)},Ce([],c,function(_){return _.splice(1,0,null),f.registeredClass.constructor_body[t-1]=lr(h,_,null,o,u),[]}),[]})}function na(e,t,r,i,o,u,c,f){var h=ur(r,i);t=te(t),u=ue(o,u),Ce([],[e],function(_){_=_[0];var x=_.name+"."+t;t.startsWith("@@")&&(t=Symbol[t.substring(2)]),f&&_.registeredClass.pureVirtualFunctions.push(t);function C(){st("Cannot call "+x+" due to unbound types",h)}var E=_.registeredClass.instancePrototype,S=E[t];return S===void 0||S.overloadTable===void 0&&S.className!==_.name&&S.argCount===r-2?(C.argCount=r-2,C.className=_.name,E[t]=C):(Br(E,t,x),E[t].overloadTable[r-2]=C),Ce([],h,function(k){var W=lr(x,k,_,u,c);return E[t].overloadTable===void 0?(W.argCount=r-2,E[t]=W):E[t].overloadTable[r-2]=W,[]}),[]})}function gn(e,t,r){return e instanceof Object||N(r+' with invalid "this": '+e),e instanceof t.registeredClass.constructor||N(r+' incompatible with "this" of type '+e.constructor.name),e.$$.ptr||N("cannot call emscripten binding method "+r+" on deleted object"),sr(e.$$.ptr,e.$$.ptrType.registeredClass,t.registeredClass)}function ia(e,t,r,i,o,u,c,f,h,_){t=te(t),o=ue(i,o),Ce([],[e],function(x){x=x[0];var C=x.name+"."+t,E={get:function(){st("Cannot access "+C+" due to unbound types",[r,c])},enumerable:!0,configurable:!0};return h?E.set=()=>{st("Cannot access "+C+" due to unbound types",[r,c])}:E.set=S=>{N(C+" is a read-only property")},Object.defineProperty(x.registeredClass.instancePrototype,t,E),Ce([],h?[r,c]:[r],function(S){var k=S[0],W={get:function(){var J=gn(this,x,C+" getter");return k.fromWireType(o(u,J))},enumerable:!0};if(h){h=ue(f,h);var Y=S[1];W.set=function(J){var se=gn(this,x,C+" setter"),Q=[];h(_,se,Y.toWireType(Q,J)),Zt(Q)}}return Object.defineProperty(x.registeredClass.instancePrototype,t,W),[]}),[]})}var $r=[],Te=[{},{value:void 0},{value:null},{value:!0},{value:!1}];function Vr(e){e>4&&--Te[e].refcount===0&&(Te[e]=void 0,$r.push(e))}function aa(){for(var e=0,t=5;t<Te.length;++t)Te[t]!==void 0&&++e;return e}function sa(){for(var e=5;e<Te.length;++e)if(Te[e]!==void 0)return Te[e];return null}function oa(){n.count_emval_handles=aa,n.get_first_emval=sa}var z={toValue:e=>(e||N("Cannot use deleted val. handle = "+e),Te[e].value),toHandle:e=>{switch(e){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:{var t=$r.length?$r.pop():Te.length;return Te[t]={refcount:1,value:e},t}}}};function la(e,t){t=te(t),Re(e,{name:t,fromWireType:function(r){var i=z.toValue(r);return Vr(r),i},toWireType:function(r,i){return z.toHandle(i)},argPackAdvance:8,readValueFromPointer:At,destructorFunction:null})}function ua(e,t,r){switch(t){case 0:return function(i){var o=r?oe:ie;return this.fromWireType(o[i])};case 1:return function(i){var o=r?Ae:qe;return this.fromWireType(o[i>>1])};case 2:return function(i){var o=r?w:M;return this.fromWireType(o[i>>2])};default:throw new TypeError("Unknown integer type: "+e)}}function ca(e,t,r,i){var o=ir(r);t=te(t);function u(){}u.values={},Re(e,{name:t,constructor:u,fromWireType:function(c){return this.constructor.values[c]},toWireType:function(c,f){return f.value},argPackAdvance:8,readValueFromPointer:ua(t,o,i),destructorFunction:null}),Nr(t,u)}function Rt(e,t){var r=at[e];return r===void 0&&N(t+" has unknown type "+pn(e)),r}function fa(e,t,r){var i=Rt(e,"enum");t=te(t);var o=i.constructor,u=Object.create(i.constructor.prototype,{value:{value:r},constructor:{value:rr(i.name+"_"+t,function(){})}});o.values[r]=u,o[t]=u}function Ur(e){if(e===null)return"null";var t=typeof e;return t==="object"||t==="array"||t==="function"?e.toString():""+e}function da(e,t){switch(t){case 2:return function(r){return this.fromWireType(R[r>>2])};case 3:return function(r){return this.fromWireType(Ir[r>>3])};default:throw new TypeError("Unknown float type: "+e)}}function ma(e,t,r){var i=ir(r);t=te(t),Re(e,{name:t,fromWireType:function(o){return o},toWireType:function(o,u){return u},argPackAdvance:8,readValueFromPointer:da(t,i),destructorFunction:null})}function ha(e,t,r,i,o,u){var c=ur(t,r);e=te(e),o=ue(i,o),Nr(e,function(){st("Cannot call "+e+" due to unbound types",c)},t-1),Ce([],c,function(f){var h=[f[0],null].concat(f.slice(1));return mn(e,lr(e,h,null,o,u),t-1),[]})}function pa(e,t,r){switch(t){case 0:return r?function(o){return oe[o]}:function(o){return ie[o]};case 1:return r?function(o){return Ae[o>>1]}:function(o){return qe[o>>1]};case 2:return r?function(o){return w[o>>2]}:function(o){return M[o>>2]};default:throw new TypeError("Unknown integer type: "+e)}}function va(e,t,r,i,o){t=te(t);var u=ir(r),c=C=>C;if(i===0){var f=32-8*r;c=C=>C<<f>>>f}var h=t.includes("unsigned"),_=(C,E)=>{},x;h?x=function(C,E){return _(E,this.name),E>>>0}:x=function(C,E){return _(E,this.name),E},Re(e,{name:t,fromWireType:c,toWireType:x,argPackAdvance:8,readValueFromPointer:pa(t,u,i!==0),destructorFunction:null})}function ga(e,t,r){var i=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],o=i[t];function u(c){c=c>>2;var f=M,h=f[c],_=f[c+1];return new o(et,_,h)}r=te(r),Re(e,{name:r,fromWireType:u,argPackAdvance:8,readValueFromPointer:u},{ignoreDuplicateRegistrations:!0})}function _a(e,t,r,i,o,u,c,f,h,_,x,C){r=te(r),u=ue(o,u),f=ue(c,f),_=ue(h,_),C=ue(x,C),Ce([e],[t],function(E){E=E[0];var S=new Le(r,E.registeredClass,!1,!1,!0,E,i,u,f,_,C);return[S]})}function ya(e,t){t=te(t);var r=t==="std::string";Re(e,{name:t,fromWireType:function(i){var o=M[i>>2],u=i+4,c;if(r)for(var f=u,h=0;h<=o;++h){var _=u+h;if(h==o||ie[_]==0){var x=_-f,C=he(f,x);c===void 0?c=C:(c+="\0",c+=C),f=_+1}}else{for(var E=new Array(o),h=0;h<o;++h)E[h]=String.fromCharCode(ie[u+h]);c=E.join("")}return je(i),c},toWireType:function(i,o){o instanceof ArrayBuffer&&(o=new Uint8Array(o));var u,c=typeof o=="string";c||o instanceof Uint8Array||o instanceof Uint8ClampedArray||o instanceof Int8Array||N("Cannot pass non-string to std::string"),r&&c?u=Ze(o):u=o.length;var f=_t(4+u+1),h=f+4;if(M[f>>2]=u,r&&c)dt(o,h,u+1);else if(c)for(var _=0;_<u;++_){var x=o.charCodeAt(_);x>255&&(je(h),N("String has UTF-16 code units that do not fit in 8 bits")),ie[h+_]=x}else for(var _=0;_<u;++_)ie[h+_]=o[_];return i!==null&&i.push(je,f),f},argPackAdvance:8,readValueFromPointer:At,destructorFunction:function(i){je(i)}})}var _n=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0;function wa(e,t){for(var r=e,i=r>>1,o=i+t/2;!(i>=o)&&qe[i];)++i;if(r=i<<1,r-e>32&&_n)return _n.decode(ie.subarray(e,r));for(var u="",c=0;!(c>=t/2);++c){var f=Ae[e+c*2>>1];if(f==0)break;u+=String.fromCharCode(f)}return u}function ba(e,t,r){if(r===void 0&&(r=2147483647),r<2)return 0;r-=2;for(var i=t,o=r<e.length*2?r/2:e.length,u=0;u<o;++u){var c=e.charCodeAt(u);Ae[t>>1]=c,t+=2}return Ae[t>>1]=0,t-i}function xa(e){return e.length*2}function Ea(e,t){for(var r=0,i="";!(r>=t/4);){var o=w[e+r*4>>2];if(o==0)break;if(++r,o>=65536){var u=o-65536;i+=String.fromCharCode(55296|u>>10,56320|u&1023)}else i+=String.fromCharCode(o)}return i}function Ca(e,t,r){if(r===void 0&&(r=2147483647),r<4)return 0;for(var i=t,o=i+r-4,u=0;u<e.length;++u){var c=e.charCodeAt(u);if(c>=55296&&c<=57343){var f=e.charCodeAt(++u);c=65536+((c&1023)<<10)|f&1023}if(w[t>>2]=c,t+=4,t+4>o)break}return w[t>>2]=0,t-i}function Pa(e){for(var t=0,r=0;r<e.length;++r){var i=e.charCodeAt(r);i>=55296&&i<=57343&&++r,t+=4}return t}function Sa(e,t,r){r=te(r);var i,o,u,c,f;t===2?(i=wa,o=ba,c=xa,u=()=>qe,f=1):t===4&&(i=Ea,o=Ca,c=Pa,u=()=>M,f=2),Re(e,{name:r,fromWireType:function(h){for(var _=M[h>>2],x=u(),C,E=h+4,S=0;S<=_;++S){var k=h+4+S*t;if(S==_||x[k>>f]==0){var W=k-E,Y=i(E,W);C===void 0?C=Y:(C+="\0",C+=Y),E=k+t}}return je(h),C},toWireType:function(h,_){typeof _!="string"&&N("Cannot pass non-string to C++ string type "+r);var x=c(_),C=_t(4+x+t);return M[C>>2]=x>>f,o(_,C+4,x+t),h!==null&&h.push(je,C),C},argPackAdvance:8,readValueFromPointer:At,destructorFunction:function(h){je(h)}})}function Ia(e,t,r,i,o,u){Qt[e]={name:te(t),rawConstructor:ue(r,i),rawDestructor:ue(o,u),fields:[]}}function Aa(e,t,r,i,o,u,c,f,h,_){Qt[e].fields.push({fieldName:te(t),getterReturnType:r,getter:ue(i,o),getterContext:u,setterArgumentType:c,setter:ue(f,h),setterContext:_})}function Ta(e,t){t=te(t),Re(e,{isVoid:!0,name:t,argPackAdvance:0,fromWireType:function(){},toWireType:function(r,i){}})}var ka=!0;function Da(){return ka}function Fa(e,t,r){e=z.toValue(e),t=Rt(t,"emval::as");var i=[],o=z.toHandle(i);return M[r>>2]=o,t.toWireType(i,e)}function Ra(e){return F.handleAsync(()=>(e=z.toValue(e),e.then(z.toHandle)))}function yn(e,t){for(var r=new Array(e),i=0;i<e;++i)r[i]=Rt(M[t+i*pe>>2],"parameter "+i);return r}function La(e,t,r,i){e=z.toValue(e);for(var o=yn(t,r),u=new Array(t),c=0;c<t;++c){var f=o[c];u[c]=f.readValueFromPointer(i),i+=f.argPackAdvance}var h=e.apply(void 0,u);return z.toHandle(h)}function ja(e){var t=[];return M[e>>2]=z.toHandle(t),t}var Ga={};function Lt(e){var t=Ga[e];return t===void 0?te(e):t}var cr=[];function Oa(e,t,r,i,o){return e=cr[e],t=z.toValue(t),r=Lt(r),e(t,r,ja(i),o)}function Ma(e,t,r,i){e=cr[e],t=z.toValue(t),r=Lt(r),e(t,r,null,i)}function Ba(e,t){return e=z.toValue(e),t=z.toValue(t),e==t}function wn(){return typeof globalThis=="object"?globalThis:function(){return Function}()("return this")()}function Na(e){return e===0?z.toHandle(wn()):(e=Lt(e),z.toHandle(wn()[e]))}function $a(e){var t=cr.length;return cr.push(e),t}var bn=[];function Va(e,t){var r=yn(e,t),i=r[0],o=i.name+"_$"+r.slice(1).map(function(k){return k.name}).join("_")+"$",u=bn[o];if(u!==void 0)return u;for(var c=["retType"],f=[i],h="",_=0;_<e-1;++_)h+=(_!==0?", ":"")+"arg"+_,c.push("argType"+_),f.push(r[1+_]);for(var x=tr("methodCaller_"+o),C="return function "+x+`(handle, name, destructors, args) {
`,E=0,_=0;_<e-1;++_)C+="    var arg"+_+" = argType"+_+".readValueFromPointer(args"+(E?"+"+E:"")+`);
`,E+=r[_+1].argPackAdvance;C+="    var rv = handle[name]("+h+`);
`;for(var _=0;_<e-1;++_)r[_+1].deleteObject&&(C+="    argType"+_+".deleteObject(arg"+_+`);
`);i.isVoid||(C+=`    return retType.toWireType(destructors, rv);
`),C+=`};
`,c.push(C);var S=vn(Function,c).apply(null,f);return u=$a(S),bn[o]=u,u}function Ua(e){return e=Lt(e),z.toHandle(n[e])}function Ha(e,t){return e=z.toValue(e),t=z.toValue(t),z.toHandle(e[t])}function za(e){e>4&&(Te[e].refcount+=1)}function Wa(e,t){return e=z.toValue(e),t=z.toValue(t),e instanceof t}function qa(e){for(var t="",r=0;r<e;++r)t+=(r!==0?", ":"")+"arg"+r;for(var i=()=>M,o="return function emval_allocator_"+e+`(constructor, argTypes, args) {
  var HEAPU32 = getMemory();
`,r=0;r<e;++r)o+="var argType"+r+" = requireRegisteredType(HEAPU32[((argTypes)>>2)], 'parameter "+r+`');
var arg`+r+" = argType"+r+`.readValueFromPointer(args);
args += argType`+r+`['argPackAdvance'];
argTypes += 4;
`;return o+="var obj = new constructor("+t+`);
return valueToHandle(obj);
}
`,new Function("requireRegisteredType","Module","valueToHandle","getMemory",o)(Rt,n,z.toHandle,i)}var xn={};function Ka(e,t,r,i){e=z.toValue(e);var o=xn[t];return o||(o=qa(t),xn[t]=o),o(e,r,i)}function Xa(){return z.toHandle([])}function Ja(e){return z.toHandle(Lt(e))}function Ya(){return z.toHandle({})}function Qa(e){var t=z.toValue(e);Zt(t),Vr(e)}function Za(e,t,r){e=z.toValue(e),t=z.toValue(t),r=z.toValue(r),e[t]=r}function es(e,t){e=Rt(e,"_emval_take_value");var r=e.readValueFromPointer(t);return z.toHandle(r)}function ts(){xe("")}var B={inEventHandler:0,removeAllEventListeners:function(){for(var e=B.eventHandlers.length-1;e>=0;--e)B._removeHandler(e);B.eventHandlers=[],B.deferredCalls=[]},registerRemoveEventListeners:function(){B.removeEventListenersRegistered||(B.removeEventListenersRegistered=!0)},deferredCalls:[],deferCall:function(e,t,r){function i(c,f){if(c.length!=f.length)return!1;for(var h in c)if(c[h]!=f[h])return!1;return!0}for(var o in B.deferredCalls){var u=B.deferredCalls[o];if(u.targetFunction==e&&i(u.argsList,r))return}B.deferredCalls.push({targetFunction:e,precedence:t,argsList:r}),B.deferredCalls.sort(function(c,f){return c.precedence<f.precedence})},removeDeferredCalls:function(e){for(var t=0;t<B.deferredCalls.length;++t)B.deferredCalls[t].targetFunction==e&&(B.deferredCalls.splice(t,1),--t)},canPerformEventHandlerRequests:function(){return B.inEventHandler&&B.currentEventHandler.allowsDeferredCalls},runDeferredCalls:function(){if(B.canPerformEventHandlerRequests())for(var e=0;e<B.deferredCalls.length;++e){var t=B.deferredCalls[e];B.deferredCalls.splice(e,1),--e,t.targetFunction.apply(null,t.argsList)}},eventHandlers:[],removeAllHandlersOnTarget:function(e,t){for(var r=0;r<B.eventHandlers.length;++r)B.eventHandlers[r].target==e&&(!t||t==B.eventHandlers[r].eventTypeString)&&B._removeHandler(r--)},_removeHandler:function(e){var t=B.eventHandlers[e];t.target.removeEventListener(t.eventTypeString,t.eventListenerFunc,t.useCapture),B.eventHandlers.splice(e,1)},registerOrRemoveHandler:function(e){var t=function(o){++B.inEventHandler,B.currentEventHandler=e,B.runDeferredCalls(),e.handlerFunc(o),B.runDeferredCalls(),--B.inEventHandler};if(e.callbackfunc)e.eventListenerFunc=t,e.target.addEventListener(e.eventTypeString,t,e.useCapture),B.eventHandlers.push(e),B.registerRemoveEventListeners();else for(var r=0;r<B.eventHandlers.length;++r)B.eventHandlers[r].target==e.target&&B.eventHandlers[r].eventTypeString==e.eventTypeString&&B._removeHandler(r--)},getNodeNameForTarget:function(e){return e?e==window?"#window":e==screen?"#screen":e&&e.nodeName?e.nodeName:"":""},fullscreenEnabled:function(){return document.fullscreenEnabled||document.webkitFullscreenEnabled}};function rs(e){return e>2?he(e):e}var ns=[0,typeof document<"u"?document:0,typeof window<"u"?window:0];function is(e){e=rs(e);var t=ns[e]||(typeof document<"u"?document.querySelector(e):void 0);return t}function En(e){return is(e)}function as(e,t,r){var i=En(e);if(!i)return-4;w[t>>2]=i.width,w[r>>2]=i.height}var Cn;Cn=()=>performance.now();function ss(e){var t=e.getExtension("ANGLE_instanced_arrays");if(t)return e.vertexAttribDivisor=function(r,i){t.vertexAttribDivisorANGLE(r,i)},e.drawArraysInstanced=function(r,i,o,u){t.drawArraysInstancedANGLE(r,i,o,u)},e.drawElementsInstanced=function(r,i,o,u,c){t.drawElementsInstancedANGLE(r,i,o,u,c)},1}function os(e){var t=e.getExtension("OES_vertex_array_object");if(t)return e.createVertexArray=function(){return t.createVertexArrayOES()},e.deleteVertexArray=function(r){t.deleteVertexArrayOES(r)},e.bindVertexArray=function(r){t.bindVertexArrayOES(r)},e.isVertexArray=function(r){return t.isVertexArrayOES(r)},1}function ls(e){var t=e.getExtension("WEBGL_draw_buffers");if(t)return e.drawBuffers=function(r,i){t.drawBuffersWEBGL(r,i)},1}function us(e){return!!(e.dibvbi=e.getExtension("WEBGL_draw_instanced_base_vertex_base_instance"))}function cs(e){return!!(e.mdibvbi=e.getExtension("WEBGL_multi_draw_instanced_base_vertex_base_instance"))}function fs(e){return!!(e.multiDrawWebgl=e.getExtension("WEBGL_multi_draw"))}var y={counter:1,buffers:[],programs:[],framebuffers:[],renderbuffers:[],textures:[],shaders:[],vaos:[],contexts:[],offscreenCanvases:{},queries:[],samplers:[],transformFeedbacks:[],syncs:[],stringCache:{},stringiCache:{},unpackAlignment:4,recordError:function(t){y.lastError||(y.lastError=t)},getNewId:function(e){for(var t=y.counter++,r=e.length;r<t;r++)e[r]=null;return t},getSource:function(e,t,r,i){for(var o="",u=0;u<t;++u){var c=i?w[i+u*4>>2]:-1;o+=he(w[r+u*4>>2],c<0?void 0:c)}return o},createContext:function(e,t){if(!e.getContextSafariWebGL2Fixed){let o=function(u,c){var f=e.getContextSafariWebGL2Fixed(u,c);return u=="webgl"==f instanceof WebGLRenderingContext?f:null};e.getContextSafariWebGL2Fixed=e.getContext,e.getContext=o}var r=t.majorVersion>1?e.getContext("webgl2",t):e.getContext("webgl",t);if(!r)return 0;var i=y.registerContext(r,t);return i},registerContext:function(e,t){var r=y.getNewId(y.contexts),i={handle:r,attributes:t,version:t.majorVersion,GLctx:e};return e.canvas&&(e.canvas.GLctxObject=i),y.contexts[r]=i,(typeof t.enableExtensionsByDefault>"u"||t.enableExtensionsByDefault)&&y.initExtensions(i),r},makeContextCurrent:function(e){return y.currentContext=y.contexts[e],n.ctx=g=y.currentContext&&y.currentContext.GLctx,!(e&&!g)},getContext:function(e){return y.contexts[e]},deleteContext:function(e){y.currentContext===y.contexts[e]&&(y.currentContext=null),typeof B=="object"&&B.removeAllHandlersOnTarget(y.contexts[e].GLctx.canvas),y.contexts[e]&&y.contexts[e].GLctx.canvas&&(y.contexts[e].GLctx.canvas.GLctxObject=void 0),y.contexts[e]=null},initExtensions:function(e){if(e||(e=y.currentContext),!e.initExtensionsDone){e.initExtensionsDone=!0;var t=e.GLctx;ss(t),os(t),ls(t),us(t),cs(t),e.version>=2&&(t.disjointTimerQueryExt=t.getExtension("EXT_disjoint_timer_query_webgl2")),(e.version<2||!t.disjointTimerQueryExt)&&(t.disjointTimerQueryExt=t.getExtension("EXT_disjoint_timer_query")),fs(t);var r=t.getSupportedExtensions()||[];r.forEach(function(i){!i.includes("lose_context")&&!i.includes("debug")&&t.getExtension(i)})}}};function ds(e){g.activeTexture(e)}function ms(e,t){g.attachShader(y.programs[e],y.shaders[t])}function hs(e,t,r){g.bindAttribLocation(y.programs[e],t,he(r))}function ps(e,t){e==35051?g.currentPixelPackBufferBinding=t:e==35052&&(g.currentPixelUnpackBufferBinding=t),g.bindBuffer(e,y.buffers[t])}function vs(e,t){g.bindFramebuffer(e,y.framebuffers[t])}function gs(e,t){g.bindRenderbuffer(e,y.renderbuffers[t])}function _s(e,t){g.bindTexture(e,y.textures[t])}function ys(e){g.bindVertexArray(y.vaos[e])}function ws(e){g.bindVertexArray(y.vaos[e])}function bs(e,t,r,i){g.blendColor(e,t,r,i)}function xs(e){g.blendEquation(e)}function Es(e,t){g.blendEquationSeparate(e,t)}function Cs(e,t){g.blendFunc(e,t)}function Ps(e,t,r,i,o,u,c,f,h,_){g.blitFramebuffer(e,t,r,i,o,u,c,f,h,_)}function Ss(e,t,r,i){y.currentContext.version>=2?r&&t?g.bufferData(e,ie,i,r,t):g.bufferData(e,t,i):g.bufferData(e,r?ie.subarray(r,r+t):t,i)}function Is(e){return g.checkFramebufferStatus(e)}function As(e){g.clear(e)}function Ts(e,t,r,i){g.clearColor(e,t,r,i)}function ks(e){g.clearStencil(e)}function Ds(e,t,r,i){g.colorMask(!!e,!!t,!!r,!!i)}function Fs(e){g.compileShader(y.shaders[e])}function Rs(e,t,r,i,o,u,c,f){g.copyTexSubImage2D(e,t,r,i,o,u,c,f)}function Ls(){var e=y.getNewId(y.programs),t=g.createProgram();return t.name=e,t.maxUniformLength=t.maxAttributeLength=t.maxUniformBlockNameLength=0,t.uniformIdCounter=1,y.programs[e]=t,e}function js(e){var t=y.getNewId(y.shaders);return y.shaders[t]=g.createShader(e),t}function Gs(e,t){for(var r=0;r<e;r++){var i=w[t+r*4>>2],o=y.buffers[i];o&&(g.deleteBuffer(o),o.name=0,y.buffers[i]=null,i==g.currentPixelPackBufferBinding&&(g.currentPixelPackBufferBinding=0),i==g.currentPixelUnpackBufferBinding&&(g.currentPixelUnpackBufferBinding=0))}}function Os(e,t){for(var r=0;r<e;++r){var i=w[t+r*4>>2],o=y.framebuffers[i];o&&(g.deleteFramebuffer(o),o.name=0,y.framebuffers[i]=null)}}function Ms(e){if(e){var t=y.programs[e];if(!t){y.recordError(1281);return}g.deleteProgram(t),t.name=0,y.programs[e]=null}}function Bs(e,t){for(var r=0;r<e;r++){var i=w[t+r*4>>2],o=y.renderbuffers[i];o&&(g.deleteRenderbuffer(o),o.name=0,y.renderbuffers[i]=null)}}function Ns(e){if(e){var t=y.shaders[e];if(!t){y.recordError(1281);return}g.deleteShader(t),y.shaders[e]=null}}function $s(e){if(e){var t=y.syncs[e];if(!t){y.recordError(1281);return}g.deleteSync(t),t.name=0,y.syncs[e]=null}}function Vs(e,t){for(var r=0;r<e;r++){var i=w[t+r*4>>2],o=y.textures[i];o&&(g.deleteTexture(o),o.name=0,y.textures[i]=null)}}function Us(e,t){for(var r=0;r<e;r++){var i=w[t+r*4>>2];g.deleteVertexArray(y.vaos[i]),y.vaos[i]=null}}function Hs(e,t){for(var r=0;r<e;r++){var i=w[t+r*4>>2];g.deleteVertexArray(y.vaos[i]),y.vaos[i]=null}}function zs(e){g.depthMask(!!e)}function Ws(e){g.disable(e)}function qs(e){g.disableVertexAttribArray(e)}function Ks(e,t,r){g.drawArrays(e,t,r)}function Xs(e,t,r,i){g.drawElements(e,t,r,i)}function Js(e){g.enable(e)}function Ys(e){g.enableVertexAttribArray(e)}function Qs(e,t){var r=g.fenceSync(e,t);if(r){var i=y.getNewId(y.syncs);return r.name=i,y.syncs[i]=r,i}return 0}function Zs(){g.finish()}function eo(){g.flush()}function to(e,t,r,i){g.framebufferRenderbuffer(e,t,r,y.renderbuffers[i])}function ro(e,t,r,i,o){g.framebufferTexture2D(e,t,r,y.textures[i],o)}function gt(e,t,r,i){for(var o=0;o<e;o++){var u=g[r](),c=u&&y.getNewId(i);u?(u.name=c,i[c]=u):y.recordError(1282),w[t+o*4>>2]=c}}function no(e,t){gt(e,t,"createBuffer",y.buffers)}function io(e,t){gt(e,t,"createFramebuffer",y.framebuffers)}function ao(e,t){gt(e,t,"createRenderbuffer",y.renderbuffers)}function so(e,t){gt(e,t,"createTexture",y.textures)}function oo(e,t){gt(e,t,"createVertexArray",y.vaos)}function lo(e,t){gt(e,t,"createVertexArray",y.vaos)}function uo(e,t){return g.getAttribLocation(y.programs[e],he(t))}function co(e,t,r){if(!r){y.recordError(1281);return}w[r>>2]=g.getBufferParameter(e,t)}function fo(){var e=g.getError()||y.lastError;return y.lastError=0,e}function mo(e,t,r,i){var o=g.getFramebufferAttachmentParameter(e,t,r);(o instanceof WebGLRenderbuffer||o instanceof WebGLTexture)&&(o=o.name|0),w[i>>2]=o}function ho(e,t){M[e>>2]=t,M[e+4>>2]=(t-M[e>>2])/4294967296}function po(e,t,r){if(!t){y.recordError(1281);return}var i=void 0;switch(e){case 36346:i=1;break;case 36344:return;case 34814:case 36345:i=0;break;case 34466:var o=g.getParameter(34467);i=o?o.length:0;break;case 33309:if(y.currentContext.version<2){y.recordError(1282);return}var u=g.getSupportedExtensions()||[];i=2*u.length;break;case 33307:case 33308:if(y.currentContext.version<2){y.recordError(1280);return}i=e==33307?3:0;break}if(i===void 0){var c=g.getParameter(e);switch(typeof c){case"number":i=c;break;case"boolean":i=c?1:0;break;case"string":y.recordError(1280);return;case"object":if(c===null)switch(e){case 34964:case 35725:case 34965:case 36006:case 36007:case 32873:case 34229:case 36662:case 36663:case 35053:case 35055:case 36010:case 35097:case 35869:case 32874:case 36389:case 35983:case 35368:case 34068:{i=0;break}default:{y.recordError(1280);return}}else if(c instanceof Float32Array||c instanceof Uint32Array||c instanceof Int32Array||c instanceof Array){for(var f=0;f<c.length;++f)switch(r){case 0:w[t+f*4>>2]=c[f];break;case 2:R[t+f*4>>2]=c[f];break;case 4:oe[t+f>>0]=c[f]?1:0;break}return}else try{i=c.name|0}catch(h){y.recordError(1280),fe("GL_INVALID_ENUM in glGet"+r+"v: Unknown object returned from WebGL getParameter("+e+")! (error: "+h+")");return}break;default:y.recordError(1280),fe("GL_INVALID_ENUM in glGet"+r+"v: Native code calling glGet"+r+"v("+e+") and it returns "+c+" of type "+typeof c+"!");return}}switch(r){case 1:ho(t,i);break;case 0:w[t>>2]=i;break;case 2:R[t>>2]=i;break;case 4:oe[t>>0]=i?1:0;break}}function vo(e,t){po(e,t,0)}function go(e,t,r,i){var o=g.getProgramInfoLog(y.programs[e]);o===null&&(o="(unknown error)");var u=t>0&&i?dt(o,i,t):0;r&&(w[r>>2]=u)}function _o(e,t,r){if(!r){y.recordError(1281);return}if(e>=y.counter){y.recordError(1281);return}if(e=y.programs[e],t==35716){var i=g.getProgramInfoLog(e);i===null&&(i="(unknown error)"),w[r>>2]=i.length+1}else if(t==35719){if(!e.maxUniformLength)for(var o=0;o<g.getProgramParameter(e,35718);++o)e.maxUniformLength=Math.max(e.maxUniformLength,g.getActiveUniform(e,o).name.length+1);w[r>>2]=e.maxUniformLength}else if(t==35722){if(!e.maxAttributeLength)for(var o=0;o<g.getProgramParameter(e,35721);++o)e.maxAttributeLength=Math.max(e.maxAttributeLength,g.getActiveAttrib(e,o).name.length+1);w[r>>2]=e.maxAttributeLength}else if(t==35381){if(!e.maxUniformBlockNameLength)for(var o=0;o<g.getProgramParameter(e,35382);++o)e.maxUniformBlockNameLength=Math.max(e.maxUniformBlockNameLength,g.getActiveUniformBlockName(e,o).length+1);w[r>>2]=e.maxUniformBlockNameLength}else w[r>>2]=g.getProgramParameter(e,t)}function yo(e,t,r){if(!r){y.recordError(1281);return}w[r>>2]=g.getRenderbufferParameter(e,t)}function wo(e,t,r,i){var o=g.getShaderInfoLog(y.shaders[e]);o===null&&(o="(unknown error)");var u=t>0&&i?dt(o,i,t):0;r&&(w[r>>2]=u)}function bo(e,t,r,i){var o=g.getShaderPrecisionFormat(e,t);w[r>>2]=o.rangeMin,w[r+4>>2]=o.rangeMax,w[i>>2]=o.precision}function xo(e,t,r){if(!r){y.recordError(1281);return}if(t==35716){var i=g.getShaderInfoLog(y.shaders[e]);i===null&&(i="(unknown error)");var o=i?i.length+1:0;w[r>>2]=o}else if(t==35720){var u=g.getShaderSource(y.shaders[e]),c=u?u.length+1:0;w[r>>2]=c}else w[r>>2]=g.getShaderParameter(y.shaders[e],t)}function jt(e){var t=Ze(e)+1,r=_t(t);return dt(e,r,t),r}function Eo(e){var t=y.stringCache[e];if(!t){switch(e){case 7939:var r=g.getSupportedExtensions()||[];r=r.concat(r.map(function(h){return"GL_"+h})),t=jt(r.join(" "));break;case 7936:case 7937:case 37445:case 37446:var i=g.getParameter(e);i||y.recordError(1280),t=i&&jt(i);break;case 7938:var o=g.getParameter(7938);y.currentContext.version>=2?o="OpenGL ES 3.0 ("+o+")":o="OpenGL ES 2.0 ("+o+")",t=jt(o);break;case 35724:var u=g.getParameter(35724),c=/^WebGL GLSL ES ([0-9]\.[0-9][0-9]?)(?:$| .*)/,f=u.match(c);f!==null&&(f[1].length==3&&(f[1]=f[1]+"0"),u="OpenGL ES GLSL ES "+f[1]+" ("+u+")"),t=jt(u);break;default:y.recordError(1280)}y.stringCache[e]=t}return t}function Co(e,t){if(y.currentContext.version<2)return y.recordError(1282),0;var r=y.stringiCache[e];if(r)return t<0||t>=r.length?(y.recordError(1281),0):r[t];switch(e){case 7939:var i=g.getSupportedExtensions()||[];return i=i.concat(i.map(function(o){return"GL_"+o})),i=i.map(function(o){return jt(o)}),r=y.stringiCache[e]=i,t<0||t>=r.length?(y.recordError(1281),0):r[t];default:return y.recordError(1280),0}}function Po(e){return parseInt(e)}function Pn(e){return e.slice(-1)=="]"&&e.lastIndexOf("[")}function So(e){var t=e.uniformLocsById,r=e.uniformSizeAndIdsByName,i,o;if(!t)for(e.uniformLocsById=t={},e.uniformArrayNamesById={},i=0;i<g.getProgramParameter(e,35718);++i){var u=g.getActiveUniform(e,i),c=u.name,f=u.size,h=Pn(c),_=h>0?c.slice(0,h):c,x=e.uniformIdCounter;for(e.uniformIdCounter+=f,r[_]=[f,x],o=0;o<f;++o)t[x]=o,e.uniformArrayNamesById[x++]=_}}function Io(e,t){if(t=he(t),e=y.programs[e]){So(e);var r=e.uniformLocsById,i=0,o=t,u=Pn(t);u>0&&(i=Po(t.slice(u+1))>>>0,o=t.slice(0,u));var c=e.uniformSizeAndIdsByName[o];if(c&&i<c[0]&&(i+=c[1],r[i]=r[i]||g.getUniformLocation(e,t)))return i}else y.recordError(1281);return-1}function Ao(e){return g.isEnabled(e)}function To(e){var t=y.textures[e];return t?g.isTexture(t):0}function ko(e){g.lineWidth(e)}function Do(e){e=y.programs[e],g.linkProgram(e),e.uniformLocsById=0,e.uniformSizeAndIdsByName={}}function Fo(e,t){e==3317&&(y.unpackAlignment=t),g.pixelStorei(e,t)}function Ro(e,t,r,i){function o(f,h){return f+h-1&-h}var u=e*r,c=o(u,i);return t*c}function Lo(e){var t={5:3,6:4,8:2,29502:3,29504:4,26917:2,26918:2,29846:3,29847:4};return t[e-6402]||1}function fr(e){return e-=5120,e==0?oe:e==1?ie:e==2?Ae:e==4?w:e==6?R:e==5||e==28922||e==28520||e==30779||e==30782?M:qe}function dr(e){return 31-Math.clz32(e.BYTES_PER_ELEMENT)}function Hr(e,t,r,i,o,u){var c=fr(e),f=dr(c),h=1<<f,_=Lo(t)*h,x=Ro(r,i,_,y.unpackAlignment);return c.subarray(o>>f,o+x>>f)}function jo(e,t,r,i,o,u,c){if(y.currentContext.version>=2){if(g.currentPixelPackBufferBinding)g.readPixels(e,t,r,i,o,u,c);else{var f=fr(u);g.readPixels(e,t,r,i,o,u,f,c>>dr(f))}return}var h=Hr(u,o,r,i,c);if(!h){y.recordError(1280);return}g.readPixels(e,t,r,i,o,u,h)}function Go(e,t,r,i){g.renderbufferStorage(e,t,r,i)}function Oo(e,t,r,i,o){g.renderbufferStorageMultisample(e,t,r,i,o)}function Mo(e,t,r,i){g.scissor(e,t,r,i)}function Bo(e,t,r,i){var o=y.getSource(e,t,r,i);g.shaderSource(y.shaders[e],o)}function No(e,t,r,i,o,u,c,f,h){if(y.currentContext.version>=2){if(g.currentPixelUnpackBufferBinding)g.texImage2D(e,t,r,i,o,u,c,f,h);else if(h){var _=fr(f);g.texImage2D(e,t,r,i,o,u,c,f,_,h>>dr(_))}else g.texImage2D(e,t,r,i,o,u,c,f,null);return}g.texImage2D(e,t,r,i,o,u,c,f,h?Hr(f,c,i,o,h):null)}function $o(e,t,r){g.texParameterf(e,t,r)}function Vo(e,t,r){var i=R[r>>2];g.texParameterf(e,t,i)}function Uo(e,t,r){g.texParameteri(e,t,r)}function Ho(e,t,r){var i=w[r>>2];g.texParameteri(e,t,i)}function zo(e,t,r,i,o,u,c,f,h){if(y.currentContext.version>=2){if(g.currentPixelUnpackBufferBinding)g.texSubImage2D(e,t,r,i,o,u,c,f,h);else if(h){var _=fr(f);g.texSubImage2D(e,t,r,i,o,u,c,f,_,h>>dr(_))}else g.texSubImage2D(e,t,r,i,o,u,c,f,null);return}var x=null;h&&(x=Hr(f,c,o,u,h)),g.texSubImage2D(e,t,r,i,o,u,c,f,x)}function q(e){var t=g.currentProgram;if(t){var r=t.uniformLocsById[e];return typeof r=="number"&&(t.uniformLocsById[e]=r=g.getUniformLocation(t,t.uniformArrayNamesById[e]+(r>0?"["+r+"]":""))),r}else y.recordError(1282)}function Wo(e,t){g.uniform1f(q(e),t)}var Xe=[];function qo(e,t,r){if(y.currentContext.version>=2){t&&g.uniform1fv(q(e),R,r>>2,t);return}if(t<=288)for(var i=Xe[t-1],o=0;o<t;++o)i[o]=R[r+4*o>>2];else var i=R.subarray(r>>2,r+t*4>>2);g.uniform1fv(q(e),i)}function Ko(e,t){g.uniform1i(q(e),t)}var Gt=[];function Xo(e,t,r){if(y.currentContext.version>=2){t&&g.uniform1iv(q(e),w,r>>2,t);return}if(t<=288)for(var i=Gt[t-1],o=0;o<t;++o)i[o]=w[r+4*o>>2];else var i=w.subarray(r>>2,r+t*4>>2);g.uniform1iv(q(e),i)}function Jo(e,t,r){g.uniform2f(q(e),t,r)}function Yo(e,t,r){if(y.currentContext.version>=2){t&&g.uniform2fv(q(e),R,r>>2,t*2);return}if(t<=144)for(var i=Xe[2*t-1],o=0;o<2*t;o+=2)i[o]=R[r+4*o>>2],i[o+1]=R[r+(4*o+4)>>2];else var i=R.subarray(r>>2,r+t*8>>2);g.uniform2fv(q(e),i)}function Qo(e,t,r){g.uniform2i(q(e),t,r)}function Zo(e,t,r){if(y.currentContext.version>=2){t&&g.uniform2iv(q(e),w,r>>2,t*2);return}if(t<=144)for(var i=Gt[2*t-1],o=0;o<2*t;o+=2)i[o]=w[r+4*o>>2],i[o+1]=w[r+(4*o+4)>>2];else var i=w.subarray(r>>2,r+t*8>>2);g.uniform2iv(q(e),i)}function el(e,t,r,i){g.uniform3f(q(e),t,r,i)}function tl(e,t,r){if(y.currentContext.version>=2){t&&g.uniform3fv(q(e),R,r>>2,t*3);return}if(t<=96)for(var i=Xe[3*t-1],o=0;o<3*t;o+=3)i[o]=R[r+4*o>>2],i[o+1]=R[r+(4*o+4)>>2],i[o+2]=R[r+(4*o+8)>>2];else var i=R.subarray(r>>2,r+t*12>>2);g.uniform3fv(q(e),i)}function rl(e,t,r,i){g.uniform3i(q(e),t,r,i)}function nl(e,t,r){if(y.currentContext.version>=2){t&&g.uniform3iv(q(e),w,r>>2,t*3);return}if(t<=96)for(var i=Gt[3*t-1],o=0;o<3*t;o+=3)i[o]=w[r+4*o>>2],i[o+1]=w[r+(4*o+4)>>2],i[o+2]=w[r+(4*o+8)>>2];else var i=w.subarray(r>>2,r+t*12>>2);g.uniform3iv(q(e),i)}function il(e,t,r,i,o){g.uniform4f(q(e),t,r,i,o)}function al(e,t,r){if(y.currentContext.version>=2){t&&g.uniform4fv(q(e),R,r>>2,t*4);return}if(t<=72){var i=Xe[4*t-1],o=R;r>>=2;for(var u=0;u<4*t;u+=4){var c=r+u;i[u]=o[c],i[u+1]=o[c+1],i[u+2]=o[c+2],i[u+3]=o[c+3]}}else var i=R.subarray(r>>2,r+t*16>>2);g.uniform4fv(q(e),i)}function sl(e,t,r,i,o){g.uniform4i(q(e),t,r,i,o)}function ol(e,t,r){if(y.currentContext.version>=2){t&&g.uniform4iv(q(e),w,r>>2,t*4);return}if(t<=72)for(var i=Gt[4*t-1],o=0;o<4*t;o+=4)i[o]=w[r+4*o>>2],i[o+1]=w[r+(4*o+4)>>2],i[o+2]=w[r+(4*o+8)>>2],i[o+3]=w[r+(4*o+12)>>2];else var i=w.subarray(r>>2,r+t*16>>2);g.uniform4iv(q(e),i)}function ll(e,t,r,i){if(y.currentContext.version>=2){t&&g.uniformMatrix2fv(q(e),!!r,R,i>>2,t*4);return}if(t<=72)for(var o=Xe[4*t-1],u=0;u<4*t;u+=4)o[u]=R[i+4*u>>2],o[u+1]=R[i+(4*u+4)>>2],o[u+2]=R[i+(4*u+8)>>2],o[u+3]=R[i+(4*u+12)>>2];else var o=R.subarray(i>>2,i+t*16>>2);g.uniformMatrix2fv(q(e),!!r,o)}function ul(e,t,r,i){if(y.currentContext.version>=2){t&&g.uniformMatrix3fv(q(e),!!r,R,i>>2,t*9);return}if(t<=32)for(var o=Xe[9*t-1],u=0;u<9*t;u+=9)o[u]=R[i+4*u>>2],o[u+1]=R[i+(4*u+4)>>2],o[u+2]=R[i+(4*u+8)>>2],o[u+3]=R[i+(4*u+12)>>2],o[u+4]=R[i+(4*u+16)>>2],o[u+5]=R[i+(4*u+20)>>2],o[u+6]=R[i+(4*u+24)>>2],o[u+7]=R[i+(4*u+28)>>2],o[u+8]=R[i+(4*u+32)>>2];else var o=R.subarray(i>>2,i+t*36>>2);g.uniformMatrix3fv(q(e),!!r,o)}function cl(e,t,r,i){if(y.currentContext.version>=2){t&&g.uniformMatrix4fv(q(e),!!r,R,i>>2,t*16);return}if(t<=18){var o=Xe[16*t-1],u=R;i>>=2;for(var c=0;c<16*t;c+=16){var f=i+c;o[c]=u[f],o[c+1]=u[f+1],o[c+2]=u[f+2],o[c+3]=u[f+3],o[c+4]=u[f+4],o[c+5]=u[f+5],o[c+6]=u[f+6],o[c+7]=u[f+7],o[c+8]=u[f+8],o[c+9]=u[f+9],o[c+10]=u[f+10],o[c+11]=u[f+11],o[c+12]=u[f+12],o[c+13]=u[f+13],o[c+14]=u[f+14],o[c+15]=u[f+15]}}else var o=R.subarray(i>>2,i+t*64>>2);g.uniformMatrix4fv(q(e),!!r,o)}function fl(e){e=y.programs[e],g.useProgram(e),g.currentProgram=e}function dl(e,t){g.vertexAttrib1f(e,t)}function ml(e,t){g.vertexAttrib2f(e,R[t>>2],R[t+4>>2])}function hl(e,t){g.vertexAttrib3f(e,R[t>>2],R[t+4>>2],R[t+8>>2])}function pl(e,t){g.vertexAttrib4f(e,R[t>>2],R[t+4>>2],R[t+8>>2],R[t+12>>2])}function vl(e,t,r,i,o,u){g.vertexAttribPointer(e,t,r,!!i,o,u)}function gl(e,t,r,i){g.viewport(e,t,r,i)}function _l(e,t){return(e>>>0)+t*4294967296}function yl(e,t,r,i){g.waitSync(y.syncs[e],t,_l(r,i))}function wl(){return 2147483648}function bl(e){try{return We.grow(e-et.byteLength+65535>>>16),mt(We.buffer),1}catch{}}function xl(e){var t=ie.length;e=e>>>0;var r=wl();if(e>r)return!1;let i=(h,_)=>h+(_-h%_)%_;for(var o=1;o<=4;o*=2){var u=t*(1+.2/o);u=Math.min(u,e+100663296);var c=Math.min(r,i(Math.max(e,u),65536)),f=bl(c);if(f)return!0}return!1}var El=["default","low-power","high-performance"];function Cl(e,t){var r=t>>2,i=w[r+6],o={alpha:!!w[r+0],depth:!!w[r+1],stencil:!!w[r+2],antialias:!!w[r+3],premultipliedAlpha:!!w[r+4],preserveDrawingBuffer:!!w[r+5],powerPreference:El[i],failIfMajorPerformanceCaveat:!!w[r+7],majorVersion:w[r+8],minorVersion:w[r+9],enableExtensionsByDefault:w[r+10],explicitSwapControl:w[r+11],proxyContextToMainThread:w[r+12],renderViaOffscreenBackBuffer:w[r+13]},u=En(e);if(!u||o.explicitSwapControl)return 0;var c=y.createContext(u,o);return c}var Pl=Cl;function Sl(e){y.currentContext==e&&(y.currentContext=0),y.deleteContext(e)}function Il(){return y.currentContext?y.currentContext.handle:0}var Al=Il;function Tl(e){for(var t=e>>2,r=0;r<14;++r)w[t+r]=0;w[t+0]=w[t+1]=w[t+3]=w[t+4]=w[t+8]=w[t+10]=1}function kl(e){var t=y.makeContextCurrent(e);return t?0:-5}function Dl(e){try{var t=ee.getStreamFromFD(e);return l.close(t),0}catch(r){if(typeof l>"u"||!(r instanceof l.ErrnoError))throw r;return r.errno}}function Fl(e,t,r,i){for(var o=0,u=0;u<r;u++){var c=M[t>>2],f=M[t+4>>2];t+=8;var h=l.read(e,oe,c,f,i);if(h<0)return-1;if(o+=h,h<f)break}return o}function Rl(e,t,r,i){try{var o=ee.getStreamFromFD(e),u=Fl(o,t,r);return M[i>>2]=u,0}catch(c){if(typeof l>"u"||!(c instanceof l.ErrnoError))throw c;return c.errno}}function Ll(e,t){return t+2097152>>>0<4194305-!!e?(e>>>0)+t*4294967296:NaN}function jl(e,t,r,i,o){try{var u=Ll(t,r);if(isNaN(u))return 61;var c=ee.getStreamFromFD(e);return l.llseek(c,u,i),j=[c.position>>>0,(T=c.position,+Math.abs(T)>=1?T>0?(Math.min(+Math.floor(T/4294967296),4294967295)|0)>>>0:~~+Math.ceil((T-+(~~T>>>0))/4294967296)>>>0:0)],w[o>>2]=j[0],w[o+4>>2]=j[1],c.getdents&&u===0&&i===0&&(c.getdents=null),0}catch(f){if(typeof l>"u"||!(f instanceof l.ErrnoError))throw f;return f.errno}}function Gl(e,t,r,i){for(var o=0,u=0;u<r;u++){var c=M[t>>2],f=M[t+4>>2];t+=8;var h=l.write(e,oe,c,f,i);if(h<0)return-1;o+=h}return o}function Ol(e,t,r,i){try{var o=ee.getStreamFromFD(e),u=Gl(o,t,r);return M[i>>2]=u,0}catch(c){if(typeof l>"u"||!(c instanceof l.ErrnoError))throw c;return c.errno}}var Sn=function(e,t,r,i){e||(e=this),this.parent=e,this.mount=e.mount,this.mounted=null,this.id=l.nextInode++,this.name=t,this.mode=r,this.node_ops={},this.stream_ops={},this.rdev=i},mr=365,hr=146;Object.defineProperties(Sn.prototype,{read:{get:function(){return(this.mode&mr)===mr},set:function(e){e?this.mode|=mr:this.mode&=~mr}},write:{get:function(){return(this.mode&hr)===hr},set:function(e){e?this.mode|=hr:this.mode&=~hr}},isFolder:{get:function(){return l.isDir(this.mode)}},isDevice:{get:function(){return l.isChrdev(this.mode)}}}),l.FSNode=Sn,l.staticInit(),on=n.InternalError=jr(Error,"InternalError"),Pi(),vt=n.BindingError=jr(Error,"BindingError"),$i(),Ri(),Xi(),hn=n.UnboundTypeError=jr(Error,"UnboundTypeError"),oa();for(var g,Ml=new Float32Array(288),Ne=0;Ne<288;++Ne)Xe[Ne]=Ml.subarray(0,Ne+1);for(var Bl=new Int32Array(288),Ne=0;Ne<288;++Ne)Gt[Ne]=Bl.subarray(0,Ne+1);var Nl={d:le,A:_e,z:sn,G:_i,fb:yi,hb:wi,o:Ei,ab:Ci,jb:Si,f:Zi,e:ta,r:ra,a:na,b:ia,ib:la,u:ca,Za:fa,I:ma,D:ha,m:va,h:ga,j:_a,H:ya,w:Sa,p:Ia,v:Aa,kb:Ta,bb:Da,x:Fa,U:Ra,gb:La,g:Oa,k:Ma,t:Vr,Wa:Ba,ob:Na,c:Va,_a:Ua,J:Ha,y:za,mb:Wa,nb:Ka,Ya:Xa,lb:Ja,Xa:Ya,xa:Qa,s:Za,l:es,q:ts,B:as,db:Cn,Ta:ds,Sa:ms,Qa:hs,Pa:ps,Oa:vs,Na:gs,Ma:_s,zb:ys,wb:ws,La:bs,Ka:xs,Ab:Es,Ja:Cs,rb:Ps,Ia:Ss,Ha:Is,Ga:As,Fa:Ts,Ea:ks,Da:Ds,Ca:Fs,Ba:Rs,Aa:Ls,za:js,ya:Gs,wa:Os,va:Ms,ua:Bs,ta:Ns,sb:$s,sa:Vs,yb:Us,vb:Hs,ra:zs,qa:Ws,pa:qs,oa:Ks,na:Xs,ma:Js,la:Ys,tb:Qs,ka:Zs,ja:eo,ia:to,ha:ro,ga:no,fa:io,ea:ao,da:so,xb:oo,ub:lo,Bb:uo,ca:co,ba:fo,aa:mo,$:vo,_:go,Z:_o,Y:yo,X:wo,W:bo,V:xo,T:Eo,S:Co,R:Io,Ra:Ao,Q:To,P:ko,O:Do,N:Fo,M:jo,L:Go,qb:Oo,K:Mo,gc:Bo,fc:No,ec:$o,dc:Vo,cc:Uo,bc:Ho,ac:zo,$b:Wo,_b:qo,Zb:Ko,Yb:Xo,Xb:Jo,Wb:Yo,Vb:Qo,Ub:Zo,Tb:el,Sb:tl,Rb:rl,Qb:nl,Pb:il,Ob:al,Nb:sl,Mb:ol,Lb:ll,Kb:ul,Jb:cl,Ib:fl,Hb:dl,Gb:ml,Fb:hl,Eb:pl,Db:vl,Cb:gl,pb:yl,cb:xl,Ua:Pl,C:Sl,n:Al,Va:Tl,i:kl,E:Dl,eb:Rl,$a:jl,F:Ol};L(),n.___wasm_call_ctors=function(){return(n.___wasm_call_ctors=n.asm.ic).apply(null,arguments)};var je=n._free=function(){return(je=n._free=n.asm.kc).apply(null,arguments)},_t=n._malloc=function(){return(_t=n._malloc=n.asm.lc).apply(null,arguments)},In=n.___getTypeName=function(){return(In=n.___getTypeName=n.asm.mc).apply(null,arguments)};n.__embind_initialize_bindings=function(){return(n.__embind_initialize_bindings=n.asm.nc).apply(null,arguments)};var An=n.___errno_location=function(){return(An=n.___errno_location=n.asm.oc).apply(null,arguments)},Tn=n.___cxa_is_pointer_type=function(){return(Tn=n.___cxa_is_pointer_type=n.asm.pc).apply(null,arguments)};n.dynCall_ii=function(){return(n.dynCall_ii=n.asm.qc).apply(null,arguments)},n.dynCall_vi=function(){return(n.dynCall_vi=n.asm.rc).apply(null,arguments)},n.dynCall_ji=function(){return(n.dynCall_ji=n.asm.sc).apply(null,arguments)},n.dynCall_iii=function(){return(n.dynCall_iii=n.asm.tc).apply(null,arguments)},n.dynCall_iij=function(){return(n.dynCall_iij=n.asm.uc).apply(null,arguments)},n.dynCall_viiij=function(){return(n.dynCall_viiij=n.asm.vc).apply(null,arguments)},n.dynCall_viii=function(){return(n.dynCall_viii=n.asm.wc).apply(null,arguments)},n.dynCall_vii=function(){return(n.dynCall_vii=n.asm.xc).apply(null,arguments)},n.dynCall_v=function(){return(n.dynCall_v=n.asm.yc).apply(null,arguments)},n.dynCall_viij=function(){return(n.dynCall_viij=n.asm.zc).apply(null,arguments)},n.dynCall_fij=function(){return(n.dynCall_fij=n.asm.Ac).apply(null,arguments)},n.dynCall_viiii=function(){return(n.dynCall_viiii=n.asm.Bc).apply(null,arguments)},n.dynCall_fii=function(){return(n.dynCall_fii=n.asm.Cc).apply(null,arguments)},n.dynCall_fif=function(){return(n.dynCall_fif=n.asm.Dc).apply(null,arguments)},n.dynCall_iiiff=function(){return(n.dynCall_iiiff=n.asm.Ec).apply(null,arguments)},n.dynCall_vijiii=function(){return(n.dynCall_vijiii=n.asm.Fc).apply(null,arguments)},n.dynCall_viiiii=function(){return(n.dynCall_viiiii=n.asm.Gc).apply(null,arguments)},n.dynCall_iiiiii=function(){return(n.dynCall_iiiiii=n.asm.Hc).apply(null,arguments)},n.dynCall_iiii=function(){return(n.dynCall_iiii=n.asm.Ic).apply(null,arguments)},n.dynCall_vij=function(){return(n.dynCall_vij=n.asm.Jc).apply(null,arguments)},n.dynCall_iiiiiii=function(){return(n.dynCall_iiiiiii=n.asm.Kc).apply(null,arguments)},n.dynCall_viiff=function(){return(n.dynCall_viiff=n.asm.Lc).apply(null,arguments)},n.dynCall_iiij=function(){return(n.dynCall_iiij=n.asm.Mc).apply(null,arguments)},n.dynCall_iiiii=function(){return(n.dynCall_iiiii=n.asm.Nc).apply(null,arguments)},n.dynCall_viif=function(){return(n.dynCall_viif=n.asm.Oc).apply(null,arguments)},n.dynCall_viiffff=function(){return(n.dynCall_viiffff=n.asm.Pc).apply(null,arguments)},n.dynCall_iiifii=function(){return(n.dynCall_iiifii=n.asm.Qc).apply(null,arguments)},n.dynCall_iiiffii=function(){return(n.dynCall_iiiffii=n.asm.Rc).apply(null,arguments)},n.dynCall_iiiij=function(){return(n.dynCall_iiiij=n.asm.Sc).apply(null,arguments)},n.dynCall_viiiiii=function(){return(n.dynCall_viiiiii=n.asm.Tc).apply(null,arguments)},n.dynCall_iiiiiiii=function(){return(n.dynCall_iiiiiiii=n.asm.Uc).apply(null,arguments)},n.dynCall_jii=function(){return(n.dynCall_jii=n.asm.Vc).apply(null,arguments)},n.dynCall_jij=function(){return(n.dynCall_jij=n.asm.Wc).apply(null,arguments)},n.dynCall_fi=function(){return(n.dynCall_fi=n.asm.Xc).apply(null,arguments)},n.dynCall_jijf=function(){return(n.dynCall_jijf=n.asm.Yc).apply(null,arguments)},n.dynCall_i=function(){return(n.dynCall_i=n.asm.Zc).apply(null,arguments)},n.dynCall_vif=function(){return(n.dynCall_vif=n.asm._c).apply(null,arguments)},n.dynCall_di=function(){return(n.dynCall_di=n.asm.$c).apply(null,arguments)},n.dynCall_vid=function(){return(n.dynCall_vid=n.asm.ad).apply(null,arguments)},n.dynCall_iiiifii=function(){return(n.dynCall_iiiifii=n.asm.bd).apply(null,arguments)},n.dynCall_iiiffi=function(){return(n.dynCall_iiiffi=n.asm.cd).apply(null,arguments)},n.dynCall_vifffffffff=function(){return(n.dynCall_vifffffffff=n.asm.dd).apply(null,arguments)},n.dynCall_iifffffffff=function(){return(n.dynCall_iifffffffff=n.asm.ed).apply(null,arguments)},n.dynCall_iiff=function(){return(n.dynCall_iiff=n.asm.fd).apply(null,arguments)},n.dynCall_iif=function(){return(n.dynCall_iif=n.asm.gd).apply(null,arguments)},n.dynCall_viff=function(){return(n.dynCall_viff=n.asm.hd).apply(null,arguments)},n.dynCall_viffffff=function(){return(n.dynCall_viffffff=n.asm.id).apply(null,arguments)},n.dynCall_dii=function(){return(n.dynCall_dii=n.asm.jd).apply(null,arguments)},n.dynCall_viid=function(){return(n.dynCall_viid=n.asm.kd).apply(null,arguments)},n.dynCall_iiiiffi=function(){return(n.dynCall_iiiiffi=n.asm.ld).apply(null,arguments)},n.dynCall_fiii=function(){return(n.dynCall_fiii=n.asm.md).apply(null,arguments)},n.dynCall_viiif=function(){return(n.dynCall_viiif=n.asm.nd).apply(null,arguments)},n.dynCall_viifffffffff=function(){return(n.dynCall_viifffffffff=n.asm.od).apply(null,arguments)},n.dynCall_viiffffff=function(){return(n.dynCall_viiffffff=n.asm.pd).apply(null,arguments)},n.dynCall_viifff=function(){return(n.dynCall_viifff=n.asm.qd).apply(null,arguments)},n.dynCall_viiifii=function(){return(n.dynCall_viiifii=n.asm.rd).apply(null,arguments)},n.dynCall_viiiiiii=function(){return(n.dynCall_viiiiiii=n.asm.sd).apply(null,arguments)},n.dynCall_viffff=function(){return(n.dynCall_viffff=n.asm.td).apply(null,arguments)},n.dynCall_vifff=function(){return(n.dynCall_vifff=n.asm.ud).apply(null,arguments)},n.dynCall_iiffi=function(){return(n.dynCall_iiffi=n.asm.vd).apply(null,arguments)},n.dynCall_iifii=function(){return(n.dynCall_iifii=n.asm.wd).apply(null,arguments)},n.dynCall_iiifi=function(){return(n.dynCall_iiifi=n.asm.xd).apply(null,arguments)},n.dynCall_iiiiij=function(){return(n.dynCall_iiiiij=n.asm.yd).apply(null,arguments)},n.dynCall_iijj=function(){return(n.dynCall_iijj=n.asm.zd).apply(null,arguments)},n.dynCall_vffff=function(){return(n.dynCall_vffff=n.asm.Ad).apply(null,arguments)},n.dynCall_viiiiiiii=function(){return(n.dynCall_viiiiiiii=n.asm.Bd).apply(null,arguments)},n.dynCall_vf=function(){return(n.dynCall_vf=n.asm.Cd).apply(null,arguments)},n.dynCall_viiiiiiiii=function(){return(n.dynCall_viiiiiiiii=n.asm.Dd).apply(null,arguments)},n.dynCall_viiiiiiiiii=function(){return(n.dynCall_viiiiiiiiii=n.asm.Ed).apply(null,arguments)},n.dynCall_fiifiii=function(){return(n.dynCall_fiifiii=n.asm.Fd).apply(null,arguments)},n.dynCall_iiifiii=function(){return(n.dynCall_iiifiii=n.asm.Gd).apply(null,arguments)},n.dynCall_viiifiii=function(){return(n.dynCall_viiifiii=n.asm.Hd).apply(null,arguments)},n.dynCall_vifii=function(){return(n.dynCall_vifii=n.asm.Id).apply(null,arguments)},n.dynCall_viifd=function(){return(n.dynCall_viifd=n.asm.Jd).apply(null,arguments)},n.dynCall_viddi=function(){return(n.dynCall_viddi=n.asm.Kd).apply(null,arguments)},n.dynCall_viiiiiffii=function(){return(n.dynCall_viiiiiffii=n.asm.Ld).apply(null,arguments)},n.dynCall_jiiii=function(){return(n.dynCall_jiiii=n.asm.Md).apply(null,arguments)},n.dynCall_jiji=function(){return(n.dynCall_jiji=n.asm.Nd).apply(null,arguments)},n.dynCall_iidiiii=function(){return(n.dynCall_iidiiii=n.asm.Od).apply(null,arguments)};var kn=n._asyncify_start_unwind=function(){return(kn=n._asyncify_start_unwind=n.asm.Pd).apply(null,arguments)},Dn=n._asyncify_stop_unwind=function(){return(Dn=n._asyncify_stop_unwind=n.asm.Qd).apply(null,arguments)},Fn=n._asyncify_start_rewind=function(){return(Fn=n._asyncify_start_rewind=n.asm.Rd).apply(null,arguments)},Rn=n._asyncify_stop_rewind=function(){return(Rn=n._asyncify_stop_rewind=n.asm.Sd).apply(null,arguments)};n.GL=y,n.Asyncify=F;var pr;nt=function e(){pr||Ln(),pr||(nt=e)};function Ln(e){if(Fe>0||(Ar(),Fe>0))return;function t(){pr||(pr=!0,n.calledRun=!0,!me&&(Wt(),d(n),n.onRuntimeInitialized&&n.onRuntimeInitialized(),qt()))}n.setStatus?(n.setStatus("Running..."),setTimeout(function(){setTimeout(function(){n.setStatus("")},1),t()},1)):t()}if(n.preInit)for(typeof n.preInit=="function"&&(n.preInit=[n.preInit]);n.preInit.length>0;)n.preInit.pop()();return Ln(),s.ready}})();class Xc{constructor(){this.executing=!1,this.queue=[]}exec(s,n,...d){return new Promise((m,p)=>{const v=async()=>{if(!s){p(new Error("Function is null!"));return}try{const b=await s.call(n,...d);m(b)}catch(b){p(b)}};this.queue.push({fn:v}),!this.executing&&this.execNextTask()})}execNextTask(){if(this.queue.length<1){this.executing=!1;return}this.executing=!0,this.queue.shift().fn().then(()=>{this.execNextTask()})}}const Ve=[],Jc=a=>(Ve.push(a),Ve.length-1),Yc=a=>{Ve[a]=null},$t=[],Qc=a=>($t.push(a),$t.length-1),Zc=a=>{$t[a]=null},Vt=[],ef=a=>(Vt.push(a),Vt.length-1),tf=a=>{Vt[a]=null},Ut=[],rf=a=>(Ut.push(a),Ut.length-1),nf=a=>{Ut[a]=null},af=a=>{onmessage=async s=>{const n={[ce.PAGInit]:b=>{const A={};b.data.args[0]&&(A.locateFile=()=>b.data.args[0].fileUrl),a(A).then(D=>{self.PAG=D,self.postMessage({name:b.data.name,args:[]})})},[ce.PAGFile_load]:async b=>{const A=Jc(await self.PAG.PAGFile.load(b.data.args[0]));self.postMessage({name:b.data.name,args:[A]})},[ce.PAGView_init]:async b=>{const[A,D,O]=b.data.args,K=Qc(await self.PAG.PAGView.init(Ve[A],D,O));self.postMessage({name:b.data.name,args:[K]})},[ce.PAGView_destroy]:async b=>{const[A]=b.data.args;$t[A].destroy(),Zc(A),self.postMessage({name:b.data.name,args:[]})},[ce.PAGFile_getTextData]:async b=>{const[A,D]=b.data.args,O=Ve[A].getTextData(D);let K={};for(const $ in O)typeof O[$]!="function"&&(K[$]=O[$]);K.key=rf(O),self.postMessage({name:b.data.name,args:[K]})},[ce.PAGFile_replaceText]:async b=>{const[A,D,O]=b.data.args,K=Ut[O.key];for(const $ in O)$!=="key"&&(K[$]=O[$]);Ve[A].replaceText(D,K),self.postMessage({name:b.data.name,args:[]})},[ce.PAGFile_replaceImage]:async b=>{const[A,D,O]=b.data.args,K=Vt[O];Ve[A].replaceImage(D,K),self.postMessage({name:b.data.name,args:[]})},[ce.PAGFile_destroy]:async b=>{const[A]=b.data.args;Ve[A].destroy(),Yc(A),self.postMessage({name:b.data.name,args:[]})},[ce.PAGImage_fromSource]:async b=>{const[A]=b.data.args,D=ef(self.PAG.PAGImage.fromSource(A));self.postMessage({name:b.data.name,args:[D]})},[ce.PAGImage_destroy]:async b=>{const[A]=b.data.args;Vt[A].destroy(),tf(A),self.postMessage({name:b.data.name,args:[]})},[ce.TextDocument_delete]:async b=>{const[A]=b.data.args;Ut[A].delete(),nf(A),self.postMessage({name:b.data.name,args:[]})}},d=s.data.name.split("_")[0];if(n[d]){n[d](s);return}const[m,p]=d.split("."),v=s.data.args[0];if(m==="PAGFile"){const b=Ve[v];if(!b)throw new Error("pagFile doesn't exist");const A=b[p];if(!A)throw new Error(`PAGFile.${p} doesn't exist`);const D=await A.call(b,...s.data.args.slice(1));self.postMessage({name:s.data.name,args:[D]});return}if(m==="PAGView"){const b=$t[v];if(!b)throw new Error("pagView doesn't exist");const A=b[p];if(!A)throw new Error(`PAGView.${p} doesn't exist`);const D=await A.call(b,...s.data.args.slice(1));self.postMessage({name:s.data.name,args:[D]});return}}},gi=(a={})=>Kc(a).then(s=>(qc(s),s.webAssemblyQueue=new Xc,s.globalCanvas=new s.GlobalCanvas,s.PAGFont.registerFallbackFontNames(),s)).catch(s=>{throw console.error(s),new Error("PAGInit fail! Please check .wasm file path valid.")});Mt&&af(gi);const sf=({open:a,signature:s,onClose:n})=>{const[d,m]=X.useState(!1);return X.useEffect(()=>{a&&gi().then(async p=>{const v=s!==""?"./pass.pag":"./fail.pag",b=await fetch(v).then(K=>K.blob()),A=new File([b],v.replace(/(.*\/)*([^.]+)/i,"$2")),D=await p.PAGFile.load(A),O=await p.PAGView.init(D,"#pag");if(O){await O.play();const K=setTimeout(()=>{O.destroy(),m(!0),clearTimeout(K)},Math.floor(D.duration()/1e3))}})},[a,s]),P.jsx(Xl,{visible:a,children:P.jsxs("div",{className:"flex w-full flex-col items-center",children:[P.jsx("canvas",{id:"pag",className:"min-h-[500px] w-full"}),P.jsx(Pe,{type:"secondary",text:"Ok",className:wt("-translate-y-[150px] max-sm:-translate-y-[60px] transition-all",!d&&"scale-50 opacity-0"),onClick:n})]})})},of=sf;function bf(){const a=Zn(),s=Jl(),{t:n}=ni(),{pathname:d}=Yl(),{address:m}=Ql(),{removeLocalNft:p}=X.useContext(ei),[v,b]=X.useState(!1),[A,D]=X.useState(!1),[O,K]=X.useState(!0),[$,Me]=X.useState(0),[V,fe]=X.useState(),[pe,De]=X.useState(),[We,me]=X.useState(!1),[ct,re]=X.useState(),[de,ve]=X.useState([]),[he,ft]=X.useState(""),[dt,Ze]=X.useState(!1),[et,oe]=X.useState(!0);X.useEffect(()=>{et&&(window.scrollTo({top:0,behavior:"smooth"}),oe(!1))},[et,d]),X.useEffect(()=>{(async()=>{if(s){const T=JSON.parse(String(localStorage.getItem("recordTime")));if(T!==null&&T.length>0){const ae=T.find(Z=>Z.nftId===s.tokenId);if(ae!==void 0){K(!0),ft(ae.bytes),setTimeout(()=>{Ze(!0)},1e3);return}}K(!1);const j=JSON.parse(String(localStorage.getItem("paperData"))),U=JSON.parse(String(localStorage.getItem("paperDataSelect")));if(j!==null&&j&&j.length>0&&(tt(0),U!==null&&U.length>0)){const ae=U.filter(Z=>Number(Z.nftId)===Number(s.tokenId));ae.length>0&&ve(ae[0].topics)}}})()},[]),X.useEffect(()=>{if(de.length>0){const L={nftId:s.tokenId,topics:de};let T=[];const j=JSON.parse(String(localStorage.getItem("paperDataSelect")));j!==null&&(T=j.filter(Z=>Z.nftId!==s.tokenId));const U=[L,...T];localStorage.setItem("paperDataSelect",JSON.stringify(U))}},[de]);const ie=async()=>{D(!0),Ae(),D(!1)},Ae=async()=>{if(s){const L=Gn.map(Z=>{const{answer:le,..._e}=Z;return _e}),T=qe(Number(s.quizStartPosition),Number(s.quantity),Number(s.totalNumber),L).map((Z,le)=>({...Z,index:le}));fe({...T[0],options:T[0].options}),De(T.length),b(!0);const j={nftId:String(s.tokenId),topics:T};let U=JSON.parse(String(localStorage.getItem("paperData")));U!==null?U=U.filter(Z=>Z.nftId!==s.tokenId):U=[];const ae=[j,...U];localStorage.setItem("paperData",JSON.stringify(ae))}},qe=(L,T,j,U)=>{const ae=[];let Z=L;for(let le=0;le<T;le++)ae.push(U[Z]),Z++,Z>=j&&(Z=0);return ae},w=()=>{$>0&&(Me($-1),tt($-1),jn($-1))},M=()=>{pe!==void 0&&$+1<pe&&(Me($+1),tt($+1),jn($+1))},R=L=>{Me(L),tt(L)},mt=(()=>{if(pe)return Array.from({length:pe},(L,T)=>T+1)})(),tt=L=>{const T=JSON.parse(String(localStorage.getItem("paperData")));if(T!==null){const j=T.filter(U=>Number(U.nftId)===Number(s.tokenId));j.length>0&&(fe({...j[0].topics[L],options:j[0].topics[L].options}),De(j[0].topics.length),b(!0))}},zt=L=>{(V==null?void 0:V.isMultiple)===1||ve(T=>T.find(U=>U.index===((V==null?void 0:V.index)??0))?T.map(U=>U.index===((V==null?void 0:V.index)??0)?{index:U.index,id:U.id,options:[L.id]}:U):[...T,{index:(V==null?void 0:V.index)??0,id:(V==null?void 0:V.id)??0,options:[L.id]}])},rt=L=>{const T=de.find(j=>j.index===(V==null?void 0:V.index));return(T==null?void 0:T.options.includes(L.id))||!1},Ar=L=>{const T=JSON.parse(String(localStorage.getItem("paperData")));if(T!==null){const j=T.filter(U=>Number(U.nftId)===Number(s.tokenId));if(j.length>0){const U=j[0].topics[L].index;if(de.length>0){const ae=de.filter(Z=>Z.index===U);if(ae.length>0&&ae[0].options.length>0)return!0}}return!1}return!1},Wt=async()=>{const L=Pt();re(L),me(!0)},[qt,Kt]=X.useState(!1),Tr=async()=>{const L=JSON.parse(String(localStorage.getItem("paperData")));if(L!==null&&L.length>0&&m){const j=L.filter(le=>Number(le.nftId)===Number(s.tokenId))[0].topics.map(le=>{const _e=de.find(it=>it.index===le.index);return{index:le.index,id:le.id,options:_e==null?void 0:_e.options}}),U=an(j),Z=j.map(le=>{const _e=Gn.find(it=>it.id===le.id);return _e==null?void 0:_e.answer}).join(",");if(U===Z){const le=Number(s.quizStartPosition),_e=Number(s.quantity),it=U.split(",").map(Number),Rr=(()=>{const Yt=le%4,G=(4-(le+_e)%4)%4,Lr=Array(Yt).fill(0),l=Array(G).fill(0);return[...Lr,...it,...l]})(),Jt=`${Zl(Rr).toString("hex")}`,Ee=JSON.parse(String(localStorage.getItem("recordTime")))||[],It=await lu(eu,{...ri,functionName:"firstMintTime"}),Be=Number(s.tokenId)*60*4+Number(It);Ee.push({nftId:s.tokenId,recordTime:Be,bytes:Jt}),localStorage.setItem("recordTime",JSON.stringify(Ee)),ft(Jt),Kt(!0)}else Kt(!0)}},[kr,Fe]=X.useState(!1);X.useEffect(()=>{qt&&(me(!1),Fe(!0))},[qt]);const nt=()=>{he!==""&&he!==void 0?Ze(!0):Xt(!0),Fe(!1)},an=L=>{const T=[];for(const j of L){const U=j.options.map(String).join("|");T.push(U)}return T.join(",")},Pt=()=>P.jsxs("div",{children:[P.jsx("div",{className:"mb-[8px] font-semibold text-[20px] lg:text-[24px]",children:n("Awesome! All the questions are answered")}),P.jsx("div",{className:"text-[14px] lg:text-[16px]",children:n("Are you sure you want to submit the test?")}),P.jsxs("div",{className:"flex justify-between mt-6",children:[P.jsx(Pe,{type:"tertiary",text:"Cancel",onClick:()=>me(!1),className:"mr-[10px] w-[149px] lg:w-[223px]"}),P.jsx(Pe,{type:"secondary",text:"Submit",onClick:Tr,className:"w-[149px] lg:w-[223px]"})]})]}),ht=()=>P.jsxs("div",{children:[P.jsx("div",{className:"mb-[8px] font-semibold text-[20px] text-5 lg:text-[24px]",children:n("You still have questions that are not answered yet")}),P.jsx("div",{className:"text-[14px] lg:text-[16px]",children:n("Are you sure you want to leave now?")}),P.jsxs("div",{className:"flex justify-between mt-6",children:[P.jsx(Pe,{type:"tertiary",text:"Cancel",onClick:()=>me(!1),className:"mr-[10px] w-[149px] lg:w-[223px]"}),P.jsx(Pe,{type:"secondary",text:"Leave",onClick:()=>a(-1),className:"w-[149px] lg:w-[223px]"})]})]}),xe=()=>{const L=ht();re(L),me(!0)},[Dr,Xt]=X.useState(!1),ge=()=>P.jsxs("div",{children:[P.jsxs("div",{className:"text-center",children:[P.jsx("img",{src:ru,alt:"CongratulationsImg",className:"m-auto w-20"}),P.jsx("div",{className:"mt-6 mb-2 font-semibold text-[24px]",children:n("Never mind.")}),P.jsx("div",{children:n("You will do better next time.")})]}),P.jsx(Pe,{type:"secondary",text:"Error book",onClick:()=>St("errorbook"),className:"mt-8 mb-4 w-full"}),P.jsx(Pe,{type:"tertiary",onClick:()=>St("goMyNft"),text:"Go to My NFTs",className:"mt-8 w-full"})]}),St=L=>{L==="errorbook"?a(`/nft/papers/errorbook/${s.tokenId}`):(p(String(s.tokenId)),a("/nft"))},Fr=X.useCallback(()=>me(!1),[]);return P.jsxs("div",{className:"overflow-auto bg-[#11183D] text-[#fff] ",children:[P.jsx(Wr,{title:"",context:ct,open:We,onClose:Fr}),P.jsx(Wr,{title:"",open:dt,context:P.jsx(_u,{nftId:String(s.tokenId),signature:he}),isDisableClickOfOverlay:!0}),P.jsx(Wr,{title:"",open:Dr,context:P.jsx(ge,{}),isDisableClickOfOverlay:!0}),P.jsx(of,{open:kr,signature:he,onClose:nt}),P.jsxs("div",{className:"z-[3] fixed flex justify-between items-center bg-[#070B27] px-5 lg:px-10 border-b border-b-[#FFFFFF] w-full h-[64px]",children:[P.jsxs("div",{className:"flex cursor-pointer",onClick:xe,children:[P.jsx("img",{src:ti,alt:""}),P.jsx("div",{className:"ml-[10px]",children:n("Back")})]}),v&&P.jsx(P.Fragment,{children:de.length===pe?P.jsx("div",{onClick:Wt,className:"text-[#22D249] cursor-pointer",children:P.jsx("span",{className:"sm:hidden",children:n("Submit")})}):P.jsx("div",{})})]}),P.jsx("div",{className:"bg-[#11183D] mt-[96px] px-5",children:P.jsx("div",{className:"m-auto mb-[100px] lg:w-[800px] min-h-[100vh]",children:v?P.jsxs("div",{className:"mt-8 lg:mt-10",children:[P.jsxs("div",{className:"mb-[12px] text-center",children:[n("Test progress")," ",$+1,"/",pe]}),P.jsxs("div",{className:"flex justify-between",children:[P.jsx("img",{onClick:w,className:"mr-[13px] cursor-pointer",src:nu,alt:""}),P.jsx("div",{className:wt("flex border-[#fff] [&::-webkit-scrollbar]:hidden rounded-[4px] overflow-x-auto [scrollbar-width:none]",vr()?"w-[680px]":"w-[236px]",Number(pe)===1?"justify-center":"border"),children:P.jsx("div",{className:"flex select-none boxRef",style:{transition:"transform 0.3s ease"},children:mt==null?void 0:mt.map(L=>P.jsx("div",{id:`ref${L}`,className:`relative flex h-10 w-10 cursor-pointer items-center justify-center ${L-1===$?"bg-[#fff] ":Ar(L-1)?"bg-[#9737A6]":""}`,style:{borderLeft:"1px solid #fff",borderRight:"1px solid #fff",marginLeft:"-1px",position:"relative",zIndex:L-1===$?1:"auto"},onClick:()=>R(L-1),children:P.jsx("span",{className:L-1===$?"bg-gradient-to-r from-[#141AAD] to-[#9737A6] bg-clip-text text-transparent":"",children:L})},L))})}),P.jsx("img",{onClick:M,className:"ml-[13px] cursor-pointer",src:iu,alt:""})]}),P.jsxs("div",{className:"content",children:[P.jsxs("div",{className:"my-[32px]",children:[P.jsxs("div",{className:"mb-4 text-[#8E8E8E]",children:[n("Question")," ",$+1," "]}),P.jsx("div",{className:"text-[18px] lg:text-[24px] break-all",children:V==null?void 0:V.details})]}),V==null?void 0:V.options.map(L=>P.jsxs("div",{className:wt("flex justify-between items-center mb-4 p-5 lg:p-[32px] border rounded-2xl w-full h-[88px] transition-all duration-200 cursor-pointer",rt(L)?"border-white bg-gradient-to-r from-[#141AAD]/40 to-[#9737A6]/40":"border-white/20"),onClick:()=>zt(L),children:[P.jsx("div",{className:`${!vr()&&"w-[90%] overflow-auto"}`,children:L.details}),V.isMultiple===1?P.jsx("div",{className:wt("flex justify-center items-center border-white mr-3 border rounded-[2px] w-6 h-6",rt(L)&&"bg-white"),children:rt(L)&&P.jsx("img",{src:Xr,alt:""})}):P.jsx("img",{src:`${rt(L)?Xr:si}`,alt:""})]},L.id)),P.jsxs("div",{className:`mt-[40px] flex justify-center lg:justify-end ${!vr()&&"fixed right-0 bottom-0 left-0 border-[white] border-t bg-[#11183D] p-4 px-5 pt-5 pb-10"}`,children:[P.jsx(Pe,{type:"tertiary",text:"Previous",className:"w-[143px!important]",onClick:w}),P.jsx(Pe,{type:"tertiary",text:"Next",className:wt("ml-4 w-[143px!important]",$+1===pe&&"hidden"),onClick:M}),de.length===pe&&vr()&&P.jsx(Pe,{text:"Submit",className:"ml-4 w-[143px!important]",onClick:Wt})]})]})]}):P.jsxs("div",{className:"argree",children:[P.jsxs("div",{className:"mb-10 pt-[60px] text-center",children:[P.jsx("div",{className:"mb-3 font-semibold text-[32px] lg:text-[40px]",children:n("Do not worry")}),P.jsx("div",{className:"text-4 lg:text-[24px]",children:n("If you're ready, click the button to get started")})]}),P.jsx("div",{className:"border-[#FFFFFF99] p-5 lg:p-8 border rounded-[16px] w-full h-[424px]",children:P.jsx("div",{className:"h-full overflow-auto",children:n("Abstract. A purely peer-to-peer version of electronic cash would allow online payments to be sent directly from one party to another without going through a financial institution. Digital signatures provide part of the solution, but the main benefits are lost if a trusted third party is still required to prevent double-spending. We propose a solution to the double-spending problem using a peer-to-peer network. The network timestamps transactions by hashing them into an ongoing chain of hash-based proof-of-work, forming a record that cannot be changed without redoing the proof-of-work. The longest chain not only serves as proof of the sequence of events witnessed, but proof that it came from the largest pool of CPU power. As long as a majority of CPU power is controlled by nodes that are not cooperating to attack the network, they'll generate the longest chain and outpace attackers. The network itself requires minimal structure. Messages are broadcast on a best effort basis, and nodes can leave and rejoin the network at will, accepting the longest proof-of-work chain as proof of what happened while they were gone.")})}),P.jsxs("div",{className:"mt-10 text-center",children:[P.jsx(Pe,{isLoading:A,disabled:O,text:"Start the quiz",className:"m-auto",onClick:ie}),P.jsx("div",{className:"mt-4 text-[12px]",children:n("By clicking, you agree to the above terms & conditions")})]})]})})})]})}export{bf as default};
